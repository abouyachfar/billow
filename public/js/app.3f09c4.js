(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{417:function(e){e.exports=JSON.parse('{"freeEvaluationPopup":{"title":"Planning to sell your home?","text":"Find out how much itâ€™s worth!","button":"Book a Free Home Evaluation"}}')},418:function(e){e.exports=JSON.parse('{"packages":{"subTitle":{"residential":"Tarifs pour propriÃ©tÃ©s rÃ©sidentielles<sup>1</sup>","multiplex":"Tarifs pour propriÃ©tÃ©s commerciales et multiplex<sup>1</sup>","newHomes":"Tarifs pour propriÃ©tÃ©s neuves","land":"Tarifs pour terrains"},"types":{"residential":"RÃ©sidentiel","multiplex":"Commercial et Multiplex","newHomes":"PropriÃ©tÃ© neuve","land":"Terrain"},"subTypes":{"comm":"Commercial","mult":"Multiplex"},"error":{"incompatiblePackage":"Ce forfait ne peut Ãªtre achetÃ© Ã  partir du compte dans lequel vous Ãªtes actuellement connectÃ©. Choisissez un autre type de forfait ou connectez-vous Ã  un autre compte avec un courriel diffÃ©rent. En cas de besoin, communiquez avec nous au 1 866 387-7677.","incompatiblePackageBuilder":"Ce forfait ne peut Ãªtre achetÃ© Ã  partir du compte entreprise dans lequel vous Ãªtes actuellement connectÃ©. Choisissez un autre type de forfait ou connectez-vous Ã  un autre compte avec un courriel diffÃ©rent. En cas de besoin, communiquez avec nous au 1 855 832-2202."}}}')},419:function(e){e.exports=JSON.parse('{"showingAgentsSearch":{"title":"Please enter the listing number or address below for the property you are booking a showing for:","placeholder":"Search by MLSÂ® #, Purplebricks #, or Address","emptyResults":{"title":"Sorry, we couldnâ€™t find \\"{{query}}\\".","text":"Please check the spelling or enter a valid address or MLSÂ®/Purplebricks number."},"maintenance":{"title":"Book a showing online","text":"Sorry, our system is currently offline. Please contact us by phone to book your showing with a Purplebricks representative.","phone":"1-877-774-2005"},"warningMessage":"This is not a Purplebricks listing. Please contact the listing brokerage directly."}}')},420:function(e){e.exports=JSON.parse('{"freeEvaluationPopup":{"title":"Planning to sell your home?","text":"Find out how much itâ€™s worth!","button":"Book a Free Home Evaluation"}}')},421:function(e){e.exports=JSON.parse('{"packages":{"subTitle":{"residential":"Pricing for residential properties<sup>1</sup>","multiplex":"Pricing commercial and multiplex properties<sup>1</sup>","newHomes":"Pricing for newly built properties","land":"Pricing for lot and land"},"types":{"residential":"Residential","multiplex":"Commercial and Multiplex","newHomes":"Newly built","land":"Lot and land"},"subTypes":{"comm":"Commercial","mult":"Multiplex"},"error":{"incompatiblePackage":"This package can not be purchased from the account in which you are currently connected. Please choose another type of package or sign into an account with another email. If needed, contact us at 1 866 387-7677.","incompatiblePackageBuilder":"This package can not be purchased from the business account in which you are currently connected. Please choose another type of package or sign into an account with another email. If needed, contact us at 1 855 832-2202."}}}')},422:function(e){e.exports=JSON.parse('{"showingAgentsSearch":{"title":"Please enter the listing number or address below for the property you are booking a showing for:","placeholder":"Search by MLSÂ® #, Purplebricks #, or Address","emptyResults":{"title":"Sorry, we couldnâ€™t find \\"{{query}}\\".","text":"Please check the spelling or enter a valid address or MLSÂ®/Purplebricks number."},"maintenance":{"title":"Book a showing online","text":"Sorry, our system is currently offline. Please contact us by phone to book your showing with a Purplebricks representative.","phone":"1-877-774-2005"},"warningMessage":"This is not a Purplebricks listing. Please contact the listing brokerage directly."}}')},481:function(e,t,s){e.exports=s(652)},504:function(e,t){if(!Object.setPrototypeOf&&!{}.__proto__){var s=Object.getPrototypeOf;Object.getPrototypeOf=e=>e.__proto__?e.__proto__:s.call(Object,e)}},524:function(e,t,s){var i,a,r;!function(n,o){"use strict";a=[s(3)],void 0===(r="function"==typeof(i=function(e){var t=["-webkit-","-moz-","-o-",""],s=["webkit","moz","MS","o",""];function i(t,s){this._element=e(t),this._options=e.extend({speed:30,direction:"left",cycles:1,space:40,delayBetweenCycles:2e3,handleHover:!0,handleResize:!0},s),this._resizeDelay=parseInt(this._options.handleResize,10)||300,this._horizontal="left"===this._options.direction||"right"===this._options.direction,this._animationName="simplemarquee-"+Math.round(1e13*Math.random()).toString(18),this._onResize=this._onResize.bind(this),this._onCycle=this._onCycle.bind(this),this._options.handleResize&&e(window).on("resize",this._onResize),this._options.handleHover&&this._element.on({"mouseenter.simplemarquee":this._onMouseEnter.bind(this),"mouseleave.simplemarquee":this._onMouseLeave.bind(this)}),this._element.on("destroy.simplemarquee",this.destroy.bind(this)),this.update(!0)}return i.prototype.update=function(e){return this._reset(),this._setup(),this._needsAnimation?e?(this._paused=!1,this._cycles=-1,this._onCycle()):this._paused&&this._pause():(this._paused=!1,this._cycles=0),this},i.prototype.pause=function(){return this._needsAnimation&&(this._resetCycle(),this._paused||(this._pause(),this._element.triggerHandler("pause"),this._paused=!0)),this},i.prototype.resume=function(){return this._needsAnimation&&(this._resetCycle(),this._paused&&(this._resume(),this._element.triggerHandler("resume"),this._paused=!1)),this},i.prototype.toggle=function(){return this._paused?this.resume():this.pause(),this},i.prototype.destroy=function(){this._reset(),this._resizeTimeout&&clearTimeout(this._resizeTimeout),e(window).off("resize",this._onResize),this._element.off(".simplemarquee"),this._element.removeData("_simplemarquee"),this._element=null},i.prototype._reset=function(){this._element.removeClass("has-enough-space").css({"word-wrap":"","overflow-wrap":"","white-space":"",overflow:""}),this._wrappers&&(this._contents.closest(this._element).length&&this._element.append(this._contents),this._wrappers.remove(),this._element.children("style").remove()),this._contents=this._wrappers=this._size=null,this._needsAnimation=!1,this._resetCycle()},i.prototype._setup=function(){var t;this._horizontal?(this._element.css({"word-wrap":"normal","overflow-wrap":"normal","white-space":"nowrap",overflow:"hidden"}),this._needsAnimation=this._element[0].scrollWidth>Math.ceil(this._element.outerWidth())):(this._element.css({"word-wrap":"break-word","overflow-wrap":"break-word","white-space":"normal",overflow:"hidden"}),this._needsAnimation=this._element[0].scrollHeight>Math.ceil(this._element.outerHeight())),this._element.toggleClass("has-enough-space",!this._needsAnimation),this._needsAnimation&&(this._contents=this._element.contents(),(t=e('<div class="simplemarquee-wrapper"></div>')).append(this._contents),this._element.append(t),(t=e('<div class="simplemarquee-wrapper"></div>')).append(this._contents.clone()),this._element.append(t),this._wrappers=this._element.children(),this._horizontal?(this._wrappers.css("display","inline-block"),this._wrappers.eq(1).css("margin-left",this._options.space),this._size=this._wrappers.eq(0).outerWidth()+this._options.space):(this._wrappers.eq(1).css("margin-top",this._options.space),this._size=this._wrappers.eq(0).outerHeight()+this._options.space),this._setupAnimation())},i.prototype._setupAnimation=function(){var e,i,a,r;e="<style>\n",t.forEach((function(t){switch(e+="@"+t+"keyframes "+this._animationName+" {\n",this._options.direction){case"left":e+="    0%   { "+t+"transform: translate(0, 0); } \n",e+="    100% { "+t+"transform: translate(-"+this._size+"px, 0); }\n";break;case"right":e+="    0%   { "+t+"transform: translate(-"+this._size+"px, 0); }\n",e+="    100% { "+t+"transform: translate(0, 0); } \n";break;case"top":e+="    0%   { "+t+"transform: translate(0, 0); } \n",e+="    100% { "+t+"transform: translate(0, -"+this._size+"px); }\n";break;case"bottom":e+="    0%   { "+t+"transform: translate(0, -"+this._size+"px); }\n",e+="    100% { "+t+"transform: translate(0, 0); } \n";break;default:throw new Error("Invalid direction: "+this._options.direction)}e+="}\n"}),this),e+="</style>\n",this._element.append(e),this._wrappers.css("animation",this._animationName+" "+this._size/this._options.speed+"s linear infinite"),i=this._wrappers.eq(0),a="AnimationIteration",r=this._onCycle,s.forEach((function(e){e||(a=a.toLowerCase()),i.on(e+a,r)}))},i.prototype._pause=function(){this._wrappers.css("animation-play-state","paused")},i.prototype._resume=function(){this._wrappers.css("animation-play-state","")},i.prototype._resetCycle=function(){this._cycleTimeout&&(clearTimeout(this._cycleTimeout),this._cycleTimeout=null)},i.prototype._onCycle=function(){this._resetCycle(),this._cycles+=1,this._cycles>=this._options.cycles?(this.pause(),this._element.triggerHandler("finish")):(this._pause(),this._element.triggerHandler("cycle"),this._cycleTimeout=setTimeout(function(){this._cycleTimeout=null,this._resume()}.bind(this),this._options.delayBetweenCycles))},i.prototype._onMouseEnter=function(){this._paused?(this._cycles=0,this.resume()):this.pause()},i.prototype._onMouseLeave=function(){this.resume()},i.prototype._onResize=function(){this._resizeTimeout&&clearTimeout(this._resizeTimeout),this._resizeTimeout=setTimeout(function(){this._resizeTimeout=null,this.update()}.bind(this),this._resizeDelay)},e.fn.simplemarquee=function(t){return this.each((function(s,a){var r;if(r=(a=e(a)).data("_simplemarquee"),"string"==typeof t){if(!r)return;r[t](arguments[1])}else r?r.update(!0):(r=new i(a,t),a.data("_simplemarquee",r))})),this},e.fn.simplemarquee.Constructor=i,e})?i.apply(t,a):i)||(e.exports=r)}()},561:function(e,t){L.Rrose=L.Popup.extend({_initLayout:function(){var e,t,s="leaflet-rrose",i=this._container=L.DomUtil.create("div",s+" "+this.options.className+" leaflet-zoom-animated");this.options.closeButton&&((e=this._closeButton=L.DomUtil.create("a",s+"-close-button",i)).href="#close",e.innerHTML="&#215;",L.DomEvent.on(e,"click",this._onCloseButtonClick,this));this.options.position="n",140-this._map.latLngToContainerPoint(this._latlng).y>0&&(this.options.position="s");var a=this._map.latLngToContainerPoint(this._latlng).x-(this._map.getSize().x-0);a>0?this.options.position+="w":(a=0-this._map.latLngToContainerPoint(this._latlng).x)>0&&(this.options.position+="e"),/s/.test(this.options.position)?("s"===this.options.position?(this._tipContainer=L.DomUtil.create("div",s+"-tip-container",i),t=this._wrapper=L.DomUtil.create("div",s+"-content-wrapper",i)):(this._tipContainer=L.DomUtil.create("div",s+"-tip-container "+s+"-tip-container-"+this.options.position,i),t=this._wrapper=L.DomUtil.create("div",s+"-content-wrapper "+s+"-content-wrapper-"+this.options.position,i)),this._tip=L.DomUtil.create("div",s+"-tip "+s+"-tip-"+this.options.position,this._tipContainer),L.DomEvent.disableClickPropagation(t),this._contentNode=L.DomUtil.create("div",s+"-content",t),L.DomEvent.on(this._contentNode,"mousewheel",L.DomEvent.stopPropagation)):("n"===this.options.position?(t=this._wrapper=L.DomUtil.create("div",s+"-content-wrapper",i),this._tipContainer=L.DomUtil.create("div",s+"-tip-container",i)):(t=this._wrapper=L.DomUtil.create("div",s+"-content-wrapper "+s+"-content-wrapper-"+this.options.position,i),this._tipContainer=L.DomUtil.create("div",s+"-tip-container "+s+"-tip-container-"+this.options.position,i)),L.DomEvent.disableClickPropagation(t),this._contentNode=L.DomUtil.create("div",s+"-content",t),L.DomEvent.on(this._contentNode,"mousewheel",L.DomEvent.stopPropagation),this._tip=L.DomUtil.create("div",s+"-tip "+s+"-tip-"+this.options.position,this._tipContainer))},_updatePosition:function(){var e=this._map.latLngToLayerPoint(this._latlng),t=L.Browser.any3d,s=this.options.offset;t&&L.DomUtil.setPosition(this._container,e),/s/.test(this.options.position)?this._containerBottom=-this._container.offsetHeight+s.y-(t?0:e.y):this._containerBottom=-s.y-(t?0:e.y),/e/.test(this.options.position)?this._containerLeft=s.x+(t?0:e.x):/w/.test(this.options.position)?this._containerLeft=-Math.round(this._containerWidth)+s.x+(t?0:e.x):this._containerLeft=-Math.round(this._containerWidth/2)+s.x+(t?0:e.x),this._container.style.bottom=this._containerBottom+"px",this._container.style.left=this._containerLeft+"px"}})},652:function(e,t,s){"use strict";s.r(t);s(124),s(129),s(131),s(134),s(135),s(137),s(138),s(139),s(141),s(142),s(143),s(144),s(145),s(146),s(147),s(149),s(150),s(152),s(153),s(155),s(156),s(157),s(158),s(159),s(160),s(161),s(162),s(163),s(164),s(165),s(166),s(167),s(168),s(169),s(170),s(171),s(172),s(173),s(174),s(175),s(176),s(177),s(119),s(504);var i=s(0),a=s.n(i),r=s(34),n=s.n(r),o=s(11),l=s.n(o),c=s(3),p=s.n(c);var d=s(14),h=s(50),u=s(4),m={createProviderWrappedComponent:e=>t=>a.a.createElement(u.a,{store:window.DP.store},e(t)),statelessReducer:(e={})=>e},g=(e={},t)=>{switch(t.type){case"SUBMIT_SEARCH_BAR":return Object.assign({},e,{submitting:!0});case"DISABLE_SEARCH":return Object.assign({},e,{enabled:!1});case"ENABLE_SEARCH":return Object.assign({},e,{enabled:!0});case"COLLAPSE_TAGS":return Object.assign({},e,{tagsCollapsed:!0});case"EXPAND_TAGS":return Object.assign({},e,{tagsCollapsed:!1});default:return e}},_=(e,t="id")=>e.reduce(({ids:e,items:s},i)=>e.includes(i[t])?{ids:e,items:s}:{ids:e.concat(i[t]),items:s.concat(i)},{ids:[],items:[]}).items,b=e=>[...new Set(e)],v=e=>[...new Map(e.map(e=>[e.id,e])).values()],y=e=>({id:"position",typeOfResource:"position",name:e.text,position:e.position}),T=(e=[],t)=>{switch(t.type){case"RESET_SEARCH_BAR":case"CLEAR_SEARCH_TERMS":case"CLEAR_SEARCH_GEO":return[];case"ADD_POSITION_SEARCH_TERM":return[y(t)];case"ADD_SEARCH_TERM":return _(e.concat([t.term]),"uniqueId").filter(e=>"position"!==e.typeOfResource);case"REMOVE_SEARCH_TERM":var s=e.slice();"region"===t.term.type&&(s=s.filter(e=>e.regionId!==t.term.uniqueId));var i=s.map(e=>e.uniqueId).indexOf(t.term.uniqueId);return-1===i||s.splice(i,1),s;default:return e}},f=(e={},t)=>{switch(t.type){case"RESET_SEARCH_BAR":case"CLEAR_SEARCH_TERMS":return Object.assign({},e,{selected:e.defaultValue});case"SET_SEARCH_SELECTED_ROOMS_COUNT":return Object.assign({},e,{selected:t.value});default:return e}},P=(e={},t)=>{switch(t.type){case"RESET_SEARCH_BAR":case"CLEAR_SEARCH_TERMS":return Object.assign({},e,{selected:e.defaultValue});case"SET_SEARCH_SELECTED_BATHROOMS_COUNT":return Object.assign({},e,{selected:t.value});default:return e}},E=(e={},t)=>{switch(t.type){case"RESET_SEARCH_BAR":case"CLEAR_SEARCH_TERMS":return Object.assign({},e,{selected:e.defaultValue});case"SET_SEARCH_SELECTED_ONLINE_SINCE":return Object.assign({},e,{selected:t.count});default:return e}},w=(e={},t)=>{var s;switch(t.type){case"RESET_SEARCH_BAR":case"CLEAR_SEARCH_TERMS":return Object.assign({},e,{selected:[]});case"SET_SEARCH_SELECTED_PRICE_RANGE_MINIMUM":return(s=e.selected.slice())[0]=t.value,Object.assign({},e,{selected:s});case"SET_SEARCH_SELECTED_PRICE_RANGE_MAXIMUM":return(s=e.selected.slice())[1]=t.value,Object.assign({},e,{selected:s});case"SET_SEARCH_SELECTED_PRICE_RANGE_PROVIDER":return Object.assign({},e,{sliderProvider:t.value});default:return e}},C=(e={},t)=>{switch(t.type){case"RESET_SEARCH_BAR":case"CLEAR_SEARCH_TERMS":return Object.assign({},e,{selected:e.defaultValue});case"ADD_SEARCH_SELECTED_TYPE":return Object.assign({},e,{selected:b(e.selected.concat([t.searchType]))});case"ADD_SEARCH_SELECTED_TYPES":return Object.assign({},e,{selected:b(e.selected.concat(t.searchTypes))});case"REMOVE_SEARCH_SELECTED_TYPE":var s=e.selected.slice(),i=s.indexOf(t.searchType);return s.splice(i,1),Object.assign({},e,{selected:s});case"REMOVE_SEARCH_SELECTED_TYPES":var a=e.selected.filter(e=>!t.searchTypes.includes(e));return Object.assign({},e,{selected:a});default:return e}},S=(e={},t)=>{switch(t.type){case"RESET_SEARCH_BAR":case"CLEAR_SEARCH_TERMS":return Object.assign({},e,{selected:[]});case"ADD_SEARCH_SELECTED_SUBTYPE":return Object.assign({},e,{selected:b(e.selected.concat([t.subType]))});case"ADD_SEARCH_SELECTED_SUBTYPES":return Object.assign({},e,{selected:v(e.selected.concat(t.subTypes))});case"REMOVE_SEARCH_SELECTED_SUBTYPE":var s=e.selected.slice(),i=s.map(({id:e})=>e).indexOf(t.subType.id);return s.splice(i,1),Object.assign({},e,{selected:s});case"REMOVE_SEARCH_SELECTED_SUBTYPES":var a=t.subTypes.map(({id:e})=>e),r=e.selected.filter(({id:e})=>!a.includes(e));return Object.assign({},e,{selected:r});case"CLEAR_SEARCH_SELECTED_SUBTYPES":var n=e.selected.filter(({typeId:e})=>!t.searchTypes.includes(e));return Object.assign({},e,{selected:n});default:return e}},R=(e={},t)=>{switch(t.type){case"RESET_SEARCH_BAR":case"CLEAR_SEARCH_TERMS":return Object.assign({},e,{selected:e.defaultValue});case"ADD_SEARCH_SELECTED_OPTION":return Object.assign({},e,{selected:b(e.selected.concat([t.option]))});case"ADD_SEARCH_SELECTED_OPTIONS":var s=t.options,i=s.indexOf("0");return s.splice(i,1),Object.assign({},e,{selected:b(e.selected.concat(s))});case"REMOVE_SEARCH_SELECTED_OPTION":var a=e.selected.slice(),r=a.map(e=>e).indexOf(t.option);return a.splice(r,1),Object.assign({},e,{selected:a});case"REMOVE_SEARCH_SELECTED_OPTIONS":var n=t.options.map(e=>e.id),o=e.selected.filter(e=>!n.includes(e.id));return Object.assign({},e,{selected:o});default:return e}},N=(e={},t)=>{switch(t.type){case"RESET_SEARCH_BAR":case"CLEAR_SEARCH_TERMS":case"CLEAR_SEARCH_GEO":return Object.assign({},e,{selected:e.defaultValue});case"SET_SEARCH_SELECTED_FILTER":return Object.assign({},e,{selected:t.filter});default:return e}},k=(e={},t)=>{switch(t.type){case"RESET_SEARCH_BAR":return Object.assign({},e,{selected:e.defaultValue});case"ADD_SEARCH_SELECTED_FLAG":return Object.assign({},e,{selected:b(e.selected.concat([t.flag]))});case"REMOVE_SEARCH_SELECTED_FLAG":var s=e.selected.slice(),i=e.selected.indexOf(t.flag);return s.splice(i,1),Object.assign({},e,{selected:s});default:return e}},O="fetching",q="completed",x="failed",M="empty",D="bypass",A=(e={status:M,query:null,payload:[],highlightedIndex:null},t)=>{var s;switch(t.type){case"RESET_SUGGEST_TERMS":return Object.assign({},e,{status:M,payload:[],highlightedIndex:null});case"FETCH_SUGGEST_TERMS":return Object.assign({},e,{status:O,query:t.query,payload:[],highlightedIndex:null});case"COMPLETED_SUGGEST_TERMS":return t.query===e.query&&e.status===O?Object.assign({},e,{status:q,query:null,payload:t.terms,highlightedIndex:0}):e;case"BYPASS_SUGGEST_TERMS":return Object.assign({},e,{status:D,payload:[],highlightedIndex:null});case"FAILED_SUGGEST_TERMS":return t.query===e.query&&e.status===O?Object.assign({},e,{status:x,query:null,payload:[],highlightedIndex:null}):e;case"HIGHLIGHT_SUGGESTED_TERM":return Object.assign({},e,{highlightedIndex:t.index});case"HIGHLIGHT_NEXT_SUGGESTED_TERM":return 0===e.payload.length?e:(s=(s=null!==e.highlightedIndex?e.highlightedIndex+1:0)<e.payload.length?s:0,Object.assign({},e,{highlightedIndex:s}));case"HIGHLIGHT_PREVIOUS_SUGGESTED_TERM":return 0===e.payload.length?e:(s=(s=null!==e.highlightedIndex?e.highlightedIndex-1:e.payload.length-1)>=0?s:e.payload.length-1,Object.assign({},e,{highlightedIndex:s}));default:return e}},I=(e=0,t)=>{switch(t.type){case"RESET_SEARCH_BAR":return Math.random();default:return e}},B=(e={},t)=>{switch(t.type){case"RESET_SEARCH_BAR":case"CLEAR_SEARCH_TERMS":return Object.assign({},e,{selected:"~",selectedUnit:"meter"});case"SET_SEARCH_SELECTED_LAND_AREA_UNIT":return Object.assign({},e,{selected:"~",selectedUnit:t.unit});case"SET_SEARCH_SELECTED_LAND_AREA":return Object.assign({},e,{selected:t.option});default:return e}};function F(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function j(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?F(Object(s),!0).forEach((function(t){V(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):F(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function V(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var U=(e={},t)=>{var s;switch(t.type){case"SET_SEARCH_SORT_ORDER":return Object.assign({},e,{selected:t.option});case"ADD_POSITION_SEARCH_TERM":return s=e.options.map(e=>j(j({},e),{},{hidden:!1})),Object.assign({},e,{options:s,selected:"distance"});case"REMOVE_SEARCH_TERM":return"position"!==t.term.id?e:(s=e.options.map(e=>j(j({},e),{},{hidden:"distance"===e.value})),Object.assign({},e,{options:s,selected:s[1].value}));default:return e}},H=(e={},t)=>(t.type,e),$=(e={activeTabName:"",scrollToTab:!1,items:[]},t)=>{switch(t.type){case"ACTIVATE_LISTING_TAB":return Object.assign({},e,{activeTabName:t.name,scrollToTab:t.scrollToTab});default:return e}},G=(e={},t)=>{switch(t.type){case"SET_SEARCH_PAGINATION_CURRENT_PAGE_NUMBER":return Object.assign({},e,{currentPageNumber:t.pageNumber});default:return e}},z=(e={},t)=>{switch(t.type){case"SHOW_CONTACT_FORM":return Object.assign({},e,{isVisible:!0});case"HIDE_CONTACT_FORM":return Object.assign({},e,{isVisible:!1});case"ADD_GTM_CATEGORY_CONTACT_FORM":return Object.assign({},e,{gtmCategory:t.gtmCategory});case"ADD_GTM_ACTION_CONTACT_FORM":return Object.assign({},e,{gtmAction:t.gtmAction});case"ADD_GTM_SUBMIT_CALL_NAME":return Object.assign({},e,{gtmSubmitCallName:t.gtmSubmitCallName});default:return e}},W=(e={},t)=>{switch(t.type){case"SHOW_CALLBACK_FORM":return Object.assign({},e,{isVisible:!0});case"HIDE_CALLBACK_FORM":return Object.assign({},e,{isVisible:!1});case"ADD_GTM_CATEGORY_CALLBACK_FORM":return Object.assign({},e,{gtmCategory:t.gtmCategory});case"ADD_GTM_ACTION_CALLBACK_FORM":return Object.assign({},e,{gtmAction:t.gtmAction});default:return e}},K=(e={},t)=>{switch(t.type){case"SHOW_SELLER_CONTACT_FORM":return Object.assign({},e,{isVisible:!0});case"HIDE_SELLER_CONTACT_FORM":return Object.assign({},e,{isVisible:!1});default:return e}},Y=(e={},t)=>{switch(t.type){case"SHOW_LISTING_INFORMATIONS_FORM":return Object.assign({},e,{isVisible:!0,modalType:t.modalType});case"HIDE_LISTING_INFORMATIONS_FORM":return Object.assign({},e,{isVisible:!1});default:return e}},X=(e={},t)=>{switch(t.type){case"SHOW_LISTING_CONTACT_FORM":return Object.assign({},e,{isVisible:!0});case"HIDE_LISTING_CONTACT_FORM":return Object.assign({},e,{isVisible:!1});default:return e}},Z=(e={},t)=>{switch(t.type){case"SET_SEARCH_MAP_VISIBLE_IN_SEARCH_LISTING_COUNT":return Object.assign({},e,{visibleInSearchListingCount:t.count});case"SET_SEARCH_MAP_INITIAL_LISTINGS_FETCHED":return Object.assign({},e,{initialListingsFetched:t.fetched});default:return e}},J=(e={},t)=>{switch(t.type){case"SUBMIT_TESTIMONIALS":return Object.assign({},e,{submitting:!0});default:return e}},Q=(e={},t)=>{switch(t.type){case"SET_TESTIMONIALS_PAGINATION_CURRENT_PAGE_NUMBER":return Object.assign({},e,{currentPageNumber:t.pageNumber});default:return e}},ee=(e={},t)=>{switch(t.type){case"SET_TESTIMONIALS_REGION_ID":return Object.assign({},e,{regionId:t.regionId});default:return e}},te=(e={},t)=>{switch(t.type){case"TOGGLE_LISTING_FAVOURITE":if(e.favouriteListingIds.includes(t.listingId)){var s=e.favouriteListingIds.slice(),i=s.indexOf(t.listingId);if(-1===i)return e;s.splice(i,1);var a=Object.assign({},e.favouriteListingNotes);return delete a[t.listingId],Object.assign({},e,{favouriteListingIds:s,favouriteListingNotes:a})}return Object.assign({},e,{favouriteListingIds:e.favouriteListingIds.concat([t.listingId])});case"UPDATE_LISTING_FAVOURITE_NOTE":var r=Object.assign({},e.favouriteListingNotes);return r[t.listingId]=t.note,Object.assign({},e,{favouriteListingNotes:r});default:return e}},se=(e={showPopover:!1,currentPopover:null},t)=>{switch(t.type){case"TOGGLE_FAVOURITE_NOTES_PANEL_POPOVER":return Object.assign({},e,{showPopover:!e.showPopover});case"HIDE_FAVOURITE_NOTES_PANEL_POPOVER":return Object.assign({},e,{showPopover:!1});case"CURRENT_FAVOURITE_NOTES_PANEL_POPOVER":return Object.assign({},e,{currentPopover:t.origin});default:return e}},ie=(e={},t)=>{switch(t.type){case"SUBMIT_BUILDER_LISTINGS":default:return e}},ae=(e={},t)=>{switch(t.type){case"SET_BUILDER_LISTINGS_PAGINATION_CURRENT_PAGE_NUMBER":return Object.assign({},e,{currentPageNumber:t.pageNumber});default:return e}},re=s(57),ne=(e={amortization:re.a.getValueFromStorage("amortization","25"),downPayment:re.a.getValueFromStorage("downPayment","0"),frequency:re.a.getValueFromStorage("frequency",re.a.FREQUENCY_WEEKLY),interest:re.a.getValueFromStorage("interest","3.09"),price:"0",term:re.a.getValueFromStorage("term","5")},t)=>{switch(t.type){case"SET_MORTGAGE_CALCULATOR_VALUE":return re.a.storeValueInStorage([t.id],t.value),Object.assign({},e,{[t.id]:t.value});default:return e}},oe=(e={},t)=>{switch(t.type){case"RESET_SEARCH_BAR":case"CLEAR_SEARCH_TERMS":return Object.assign({},e,{selected:"~",selectedUnit:"meter"});case"SET_SEARCH_SELECTED_LAND_AREA_UNIT":return Object.assign({},e,{selected:"~",selectedUnit:t.unit});case"SET_SEARCH_SELECTED_LOT_SIZE_MINIMUM":return Object.assign({},e,{selectedMinimum:t.option});case"SET_SEARCH_SELECTED_LOT_SIZE_MAXIMUM":return Object.assign({},e,{selectedMaximum:t.option});case"SET_SEARCH_SELECTED_LOT_SIZE":return Object.assign({},e,{selected:t.option});default:return e}},le=(e={},t)=>{switch(t.type){case"RESET_SEARCH_BAR":case"CLEAR_SEARCH_TERMS":return Object.assign({},e,{selected:"~",selectedUnit:"meter"});case"SET_SEARCH_SELECTED_LAND_AREA_UNIT":return Object.assign({},e,{selected:"~",selectedUnit:t.unit});case"SET_SEARCH_SELECTED_LIVING_AREA_MINIMUM":return Object.assign({},e,{selectedMinimum:t.option});case"SET_SEARCH_SELECTED_LIVING_AREA_MAXIMUM":return Object.assign({},e,{selectedMaximum:t.option});case"SET_SEARCH_SELECTED_LIVING_AREA":return Object.assign({},e,{selected:t.option});default:return e}},ce=(e={currentItem:null,visible:!1},t)=>{switch(t.type){case"MODAL_SELECTED_ITEM":return Object.assign({},e,{currentItem:t.selected});case"SHOW_MODAL":return Object.assign({},e,{visible:!0});case"HIDE_MODAL":return Object.assign({},e,{visible:!1});default:return e}},pe=(e={currentPackage:window.DP.isNewHomes?"CONS":"RES"},t)=>{switch(t.type){case"SELECTED_PACKAGE":return Object.assign({},e,{currentPackage:t.selected});default:return e}},de=(e={},t)=>{switch(t.type){case"SHOW_WARNING_MESSAGE":return Object.assign({},e,{showWarningMessage:!0});default:return e}},he=s(65),ue=e=>{var t=window.devToolsExtension&&window.devToolsExtension(),s=Object(h.c)({searchLandArea:B,searchTypes:C,searchRooms:f,searchPriceRange:w,searchFlags:k,searchFilters:N,searchOnlineSince:E,searchOptions:R,searchSubTypes:S,searchTerms:T,searchBathrooms:P,searchReset:I,searchSuggestedTerms:A,searchSortOrder:U,searchBar:g,searchPagination:G,searchAdditionalCriteria:m.statelessReducer,searchFieldResults:m.statelessReducer,searchFieldInput:m.statelessReducer,mobileSearch:m.statelessReducer,searchRegionsAndCitiesResults:m.statelessReducer,searchBarPushEvents:m.statelessReducer,searchLotSize:oe,searchLivingArea:le,testimonials:J,testimonialsPagination:Q,testimonialsRegion:ee,listing:H,listingTabs:$,listingsFavourites:te,contactForm:z,sellerContactForm:K,listingTroubleReachingForm:Y,listingContactForm:X,mortgageCalculator:ne,callbackForm:W,searchMap:Z,favouriteNotesPanel:se,builderListings:ie,builderListingsPagination:ae,Modal:ce,warningMessageBar:de,Packages:pe,surveySticky:he.c});return Object(h.e)(s,e,t)},me='<p class="message error">An error occured, please try again later.</p>',ge=e=>{if(void 0!==e&&("https://tpc.googlesyndication.com"===e.origin||e.origin.endsWith(".duproprio.com"))&&e.data.hasOwnProperty("action")&&"contact-advertiser"===e.data.action){var t=p()("form#mortgage-data__form-costs"),s=t.find("input.mortgage-data__form__field__loan-amount").val(),i=t.find("select.mortgage-data__form__field__amortization").val(),a=t.find("input.mortgage-data__form__field__interest-rate").val(),r=e.data.data.advertiser,n=e.data.data.client;p.a.ajax({type:"POST",url:"/webservice/advertiser/contact",dataType:"json",data:{"advertiser-langue":window.DP.lang,"advertiser-province":window.DP.province,"hab-code":window.DP.preloadedState.listing.code,"advertiser-price":window.DP.preloadedState.listing.price,"advertiser-name":n.name,"advertiser-phone":n.phone,"advertiser-email":n.email,"advertiser-comment":n.comments,"advertiser-client":"".concat(r.id,"|").concat(r.name),"advertiser-destinationEmail":r.email.main,"advertiser-destinationEmail2":r.email.secondary,"advertiser-loanAmount":s,"advertiser-amortization":i,"advertiser-interestRate":a},beforeSend:e=>{e.setRequestHeader("X-CSRF-TOKEN",p()('meta[name="csrf-token"]').attr("content"))}}).done(t=>{var s={action:"contact-advertiser-reply",data:{message:t.hasOwnProperty("confirm")?t.confirm:me}};e.source.postMessage(s,e.origin)}).fail(()=>{var t={action:"contact-advertiser-reply",data:{message:me}};e.source.postMessage(t,e.origin)})}},_e=s(7),be=s(35),ve=s(1);class ye extends a.a.Component{constructor(e){super(e),this.state={clickedText:!1}}handleTextClick(){var e=!this.state.clickedText;this.setState({clickedText:e})}render(){return a.a.createElement("div",{className:"message"},a.a.createElement("h1",{className:"message-title"},this.props.title),a.a.createElement("p",{className:"message-text",onClick:this.handleTextClick.bind(this)},this.props.text,this.state.clickedText?" (clicked!)":""),a.a.createElement("ul",{className:"message-items"},Array.from(this.props.items).map(e=>this.renderItem(e))),a.a.createElement("pre",{className:"message-dictionary"},JSON.stringify(this.props.dictionary)))}renderItem(e){return a.a.createElement(Te,{key:"item:".concat(e.id),item:e})}}class Te extends a.a.Component{handleClick(){console.log("Item has been clicked",this.props.item)}render(){return a.a.createElement("li",{className:"message-items-item",onClick:this.handleClick.bind(this)},this.props.item.name)}}Te.propTypes={item:ve.PropTypes.object.isRequired},ye.propTypes={title:ve.PropTypes.string.isRequired,text:ve.PropTypes.string.isRequired,items:ve.PropTypes.array.isRequired,active:ve.PropTypes.bool.isRequired,dictionary:ve.PropTypes.object.isRequired};var fe=ye,Pe=s(8),Ee=s(5),we=s(22),Ce=s(29),Se=s.n(Ce),Re=(e,t="full")=>new Promise((s,i)=>{var a=Se()(window.DP.urls.proxyFreeTextSearch,e);"simple"===t&&(a=Se()(window.DP.urls.proxyFreeTextSearchSimple,e)),p.a.ajax({url:a}).done(s).fail(i)}),Ne=(e,t)=>{var s;return function(){var i=this,a=arguments,r=()=>{s=null,e.apply(i,a)};clearTimeout(s),s=setTimeout(r,t)}},ke=()=>{var e={enableHighAccuracy:!0,timeout:15e3,maximumAge:0};return new Promise((t,s)=>navigator.geolocation?navigator.geolocation.getCurrentPosition(t,s,e):s())},Le=e=>Object.keys(e).reduce((t,s)=>{var i=e[s];return("object"==typeof i&&null!==i&&i.length>0||"object"!=typeof i&&void 0!==i)&&(t[s]=i),t},{}),Oe=()=>window.$window.width()<window.DP.breakpoints.regular,qe=()=>window.DP.isRental?"is_rental":"is_for_sale",xe=()=>Oe()?5:10,Me=({searchOptions:e},t)=>{if(e.selected.find(e=>e===t))return 1},De=({searchFlags:e},t)=>{if(e.options.map(({id:e})=>e).includes(t))return e.selected.find(e=>e===t)?1:0},Ae=({searchFilters:e},t)=>{if(e.selected===t)return 1},Ie=({searchLotSize:e},t)=>{if(e.selectedUnit===t&&"~"!==e.selected&&e.selectedMinimum!==e.selectedMaximum)return e.selected},Be=({searchLivingArea:e},t)=>{if(e.selectedUnit===t&&"~"!==e.selected&&e.selectedMinimum!==e.selectedMaximum)return e.selected},Fe=(e,t)=>{var s=(({searchTerms:e})=>e.filter(e=>"regions"===e.typeOfResource).map(e=>e.id))(e),i=(({searchTerms:e})=>e.filter(e=>"cities"===e.typeOfResource).map(e=>e.id))(e),a=(({searchTerms:e},t)=>{var s=e.filter(e=>"position"===e.typeOfResource)[0],i=0===e.length,{latitude:a,longitude:r}=s?s.position.coords:{undefined:void 0},n=a&&r?[a,r].join(","):null;return i||t.position&&n!==t.position?t.position:n})(e,t),r=a?t.zoom:null,n=(({searchTerms:e})=>e.filter(e=>"position"===e.typeOfResource)[0]?1:null)(e),o=(({searchPriceRange:e})=>{if(e.selected[0])return e.selected[0].value})(e),l=(({searchPriceRange:e})=>{if(e.selected[1])return e.selected[1].value})(e),c=(({searchTypes:e})=>e.selected)(e),p=(({searchSubTypes:e})=>e.selected.map(({id:e})=>e))(e),d=(({searchRooms:e})=>{if("0"!==e.selected)return e.selected})(e),h=(({searchBathrooms:e})=>{if("0"!==e.selected)return e.selected})(e),u=Ie(e,"foot"),m=Ie(e,"meter"),g=Be(e,"foot"),_=Be(e,"meter"),b=(({searchOnlineSince:e})=>{if(0!==e.selected)return e.selected})(e),v=Ae(e,"is_featured_home"),y=Ae(e,"is_open_house"),T=Ae(e,"has_virtual_tour"),f=Ae(e,"is_sold"),P=Ae(e,"is_builder"),E=Ae(e,"is_for_sale"),w=Ae(e,"is_rental"),C=De(e,"with_builders"),S=De(e,"parent"),R=De(e,"with_external_listings"),N=Me(e,"has_fireplace"),k=Me(e,"has_pool"),L=Me(e,"has_panoramic_view"),O=Me(e,"has_parking_garage"),q=Me(e,"has_parking_exterior"),x=Me(e,"has_waterfront"),M=Me(e,"has_no_back_neighbor"),D=Me(e,"has_income"),A=(({searchPagination:e})=>{if(null!==e.currentPageNumber&&1!==e.currentPageNumber)return e.currentPageNumber})(e),I=(({searchSortOrder:e,searchTerms:t})=>{var s=t.filter(e=>"position"===e.typeOfResource)[0];return"distance"!==e.selected||s?"new_listings_first"!==e.selected?e.selected:void 0:"new_listings_first"})(e),B=Me(e,"has_heated_included"),F=Me(e,"has_lit_included"),j=Me(e,"has_hot_water_included"),V=Me(e,"has_furnished_included"),U=Me(e,"has_parking"),H=Me(e,"has_animals_accepted"),$=Me(e,"has_washer_dryer_connection"),G=Me(e,"has_elevator"),z=Me(e,"has_new_rental"),W=Me(e,"has_retired"),K=Me(e,"has_charging_station"),Y=Me(e,"has_adapted_reduced_mobility");return Le({search:!0,position:a,near_me:n,zoom:r,regions:s,cities:i,min_price:o,max_price:l,type:c,subtype:p,rooms:d,bathrooms:h,lot_dimension_sq_meter:m,lot_dimension_sq_feet:u,living_space_sq_feet:g,living_space_sq_meter:_,is_featured_home:v,online_since:b,is_sold:f,is_builder:P,is_for_sale:E,is_rental:w,is_open_house:y,has_virtual_tour:T,with_builders:C,parent:S,with_external_listings:R,has_fireplace:N,has_pool:k,has_panoramic_view:L,has_parking_garage:O,has_parking_exterior:q,has_waterfront:x,has_no_back_neighbor:M,has_income:D,pageNumber:A,sort:I,has_heated_included:B,has_lit_included:F,has_hot_water_included:j,has_furnished_included:V,has_parking:U,has_animals_accepted:H,has_washer_dryer_connection:$,has_elevator:G,has_new_rental:z,has_retired:W,has_charging_station:K,has_adapted_reduced_mobility:Y})},je=(e=!1,{searchTerms:t})=>{var s=new URLSearchParams(window.location.search),i=t.filter(e=>"regions"===e.typeOfResource||"cities"===e.typeOfResource)[0],a=e||i?null:s.get("position"),r=e||i?null:s.get("zoom");return{position:a||null,zoom:r||null}},Ve=(e,t=!1)=>{var s=Fe(e,je(t,e)),i=p.a.param(s),a=t?window.DP.urls.mapSearch:window.DP.urls.searchDispatch;window.location="".concat(a,"?").concat(i)},Ue=()=>{var e=window.DP.store.getState(),t=Fe(e,je(!1,e)),s=p.a.param(t);return p.a.ajax({url:window.DP.urls.searchUpdateCriteria,type:"POST",data:s,beforeSend:e=>{e.setRequestHeader("X-CSRF-TOKEN",p()('meta[name="csrf-token"]').attr("content"))}})},He=Fe,$e=je,Ge=e=>({type:"ADD_SEARCH_TERM",term:e}),ze=e=>({type:"REMOVE_SEARCH_TERM",term:e}),We=(e,t)=>({type:"ADD_POSITION_SEARCH_TERM",position:e,text:t}),Ke=e=>({type:"SET_SEARCH_SELECTED_ROOMS_COUNT",value:e}),Ye=e=>({type:"SET_SEARCH_SELECTED_BATHROOMS_COUNT",value:e}),Xe=e=>({type:"SET_SEARCH_SELECTED_ONLINE_SINCE",count:e}),Ze=e=>({type:"SET_SEARCH_SELECTED_PRICE_RANGE_MINIMUM",value:e}),Je=e=>({type:"SET_SEARCH_SELECTED_PRICE_RANGE_MAXIMUM",value:e}),Qe=e=>({type:"REMOVE_SEARCH_SELECTED_TYPE",searchType:e}),et=e=>({type:"ADD_SEARCH_SELECTED_TYPES",searchTypes:e}),tt=e=>({type:"REMOVE_SEARCH_SELECTED_TYPES",searchTypes:e}),st=e=>({type:"REMOVE_SEARCH_SELECTED_SUBTYPE",subType:e}),it=e=>({type:"ADD_SEARCH_SELECTED_SUBTYPES",subTypes:e}),at=e=>({type:"REMOVE_SEARCH_SELECTED_SUBTYPES",subTypes:e}),rt=e=>({type:"ADD_SEARCH_SELECTED_OPTION",option:e}),nt=e=>({type:"REMOVE_SEARCH_SELECTED_OPTION",option:e}),ot=e=>({type:"SET_SEARCH_SELECTED_FILTER",filter:e}),lt=e=>({type:"ADD_SEARCH_SELECTED_FLAG",flag:e}),ct=e=>({type:"SET_SEARCH_PAGINATION_CURRENT_PAGE_NUMBER",pageNumber:e}),pt=e=>(Ve(window.DP.store.getState(),e),{type:"SUBMIT_SEARCH_BAR"}),dt=e=>({type:"SET_SEARCH_SELECTED_LOT_SIZE_MINIMUM",option:e}),ht=e=>({type:"SET_SEARCH_SELECTED_LOT_SIZE_MAXIMUM",option:e}),ut=e=>({type:"SET_SEARCH_SELECTED_LOT_SIZE",option:e}),mt=e=>({type:"SET_SEARCH_SELECTED_LIVING_AREA_MINIMUM",option:e}),gt=e=>({type:"SET_SEARCH_SELECTED_LIVING_AREA_MAXIMUM",option:e}),_t=e=>({type:"SET_SEARCH_SELECTED_LIVING_AREA",option:e}),bt=({checked:e,partial:t,partialCount:s})=>{var i=Ee.a.build("search-checkbox",{checked:e||t,unchecked:!e&&!t,partial:t});return a.a.createElement("span",{className:i},a.a.createElement(Pe.a,{src:"/build/img/svg/icn-check.svg",cacheGetRequests:!0}),t?a.a.createElement("span",{className:"search-checkbox__partial-count"},s):null)};bt.propTypes={checked:ve.PropTypes.bool,partial:ve.PropTypes.bool,partialCount:ve.PropTypes.number};var vt=bt;class yt extends a.a.Component{constructor(e){super(e),this.state={regionCitiesId:null,fetchingNearMe:!1}}componentDidUpdate({searchSuggestedTerms:e}){var{highlightedIndex:t}=this.props.searchSuggestedTerms,s=e.highlightedIndex;if(null!==t&&s!==t&&this.refs.query){var i=Array.from(this.refs.query.querySelectorAll(".search-results__item")),a=i.slice(0,t).reduce((e,t)=>e+t.offsetHeight,0),r=i[t].offsetHeight,n=this.refs.query.offsetHeight,o=this.refs.query.scrollTop;null===s&&0===t||s<t?a>o+n-r&&(this.refs.query.scrollTop=a-n+r):a<o&&(this.refs.query.scrollTop=a)}}handleTermHighlight(e){this.props.dispatch((e=>({type:"HIGHLIGHT_SUGGESTED_TERM",index:e}))(e))}handleRegionToggleVisibilityClick(e){var t=this.state.regionCitiesId===e?null:e;this.setState({regionCitiesId:t})}handleInputNearMeClick(){ke().then(e=>{this.props.dispatch(We(e,this.props.searchBar.nearMeTermLabel)),this.setState({fetchingNearMe:!0}),this.props.dispatch(pt(!0))}).catch(()=>{this.props.dispatch({type:"SHOW_WARNING_MESSAGE"}),this.setState({fetchingNearMe:!1})}),Ue()}countCitiesCheckedInRegion(e){var t=0;return e.cities.map(e=>this.hasListTermsChecked(e)).map(e=>!0===e?t++:null),t}hasAtLeastOneCityChecked(e){return this.countCitiesCheckedInRegion(e)>0}hasListTermsChecked(e){if(void 0!==this.props.searchTerms.find(t=>t.uniqueId===e.uniqueId))return!0}render(){var e=Ee.a.build("search-results",{dp:"qc"===window.DP.province,pb:"qc"!==window.DP.province});return a.a.createElement("div",{className:e},this.renderResultsQuery(),a.a.createElement("div",{className:"search-results__actions"},a.a.createElement("span",{className:"search-results__close-button",onClick:this.props.onHideResults},this.props.searchFieldResults.closeResultsText),this.renderSubmitButton()))}renderSubmitButton(){return this.props.onSubmit?this.props.searchBar.enabled?a.a.createElement("button",{className:"search-results__submit-button",onClick:this.props.onSubmit},a.a.createElement(Pe.a,{className:"search-results__submit-button-icon",src:"/build/img/svg/icn-magnify.svg",cacheGetRequests:!0})):a.a.createElement("button",{className:"search-results__submit-button search-results__submit-button--inactive"},a.a.createElement(Pe.a,{className:"search-results__submit-button-icon",src:"/build/img/svg/icn-magnify.svg",cacheGetRequests:!0})):null}renderResultsQuery(){return this.props.searchSuggestedTerms.status===O?this.renderFetchingResults():this.props.searchSuggestedTerms.status===D?this.renderRegionsAndCitiesResults():this.props.searchSuggestedTerms.payload.length?this.renderResultsSections():this.props.searchSuggestedTerms.status===q?this.renderEmptyResults():this.props.searchSuggestedTerms.status===x?this.renderError():this.props.searchBar.displayDropdownRegionsCities?this.renderRegionsAndCitiesResults():this.renderNotFetchedResults()}renderResultsSections(){return a.a.createElement("div",{className:"search-results__query",ref:"query"},a.a.createElement("div",{className:"search-results__section"},this.renderResultsByListLink(),this.props.searchSuggestedTerms.payload.map((e,t)=>this.renderResultsItem(e,t))))}renderResultsByListLink(){return this.props.searchBar.displayDropdownRegionsCities?a.a.createElement("div",{className:"search-results__section-link",onClick:this.props.handleByPassSelect.bind(this)},this.props.searchBar.dropdownRegionsLink):null}renderResultsItem(e,t){var s=e.isDirectLink,i=this.props.searchTerms.find(t=>t.uniqueId===e.uniqueId);"cities"===e.typeOfResource&&(i=this.props.searchTerms.find(t=>t.uniqueId===e.uniqueId||t.uniqueId===e.regionUniqueId));var r=this.props.searchSuggestedTerms.highlightedIndex===t,n=Ee.a.build("search-results__item",{selected:i,directLink:s,highlighted:r}),o=a.a.createElement(Pe.a,{className:"search-results__item__arrow",src:"/build/img/svg/icn-arrow-large-right.svg",cacheGetRequests:!0});return a.a.createElement("div",{key:"searchResultsSectionItem:".concat(e.uniqueId),className:n,onClick:this.props.handleTermSelect.bind(this,e,"click"),onMouseOver:this.handleTermHighlight.bind(this,t)},a.a.createElement("div",{className:"search-results__item__content"},a.a.createElement("span",{className:"search-results__item__name",dangerouslySetInnerHTML:{__html:e.name}}),a.a.createElement("span",{className:"search-results__item__details",dangerouslySetInnerHTML:{__html:e.details}})),s?o:null)}renderRegionsAndCitiesResults(){return a.a.createElement("div",{className:"search-results__query",ref:"query"},a.a.createElement("div",{className:"search-results__section"},a.a.createElement("div",{className:"search-results__section__regions"},this.renderRegionsAndCitiesGeolocalisation(),this.props.searchRegionsAndCitiesResults.map((e,t)=>this.renderRegionsAndCitiesResultsItem(e,t)))))}renderRegionsAndCitiesGeolocalisation(){return this.props.showNearMe?a.a.createElement("div",{className:"search-results__geolocalisation-container"},a.a.createElement("div",{className:"search-results__geolocalisation",onClick:this.handleInputNearMeClick.bind(this)},a.a.createElement("span",{className:"search-results__geolocalisation-icon"},this.state.fetchingNearMe?a.a.createElement(we.a,null):a.a.createElement(Pe.a,{className:"search-field__near-me-icon is-no-events",src:"/build/img/svg/icn-pin.svg",cacheGetRequests:!0})),a.a.createElement("span",{className:"search-results__geolocalisation-label"},this.props.searchBar.nearMeTermLabel)),a.a.createElement("span",{className:"search-results__geolocalisation-line"})):null}renderRegionsAndCitiesResultsItem(e,t){var s=this.hasListTermsChecked(e.region),i="".concat("search-results__section__region"," ").concat("search-results__section__region","-").concat(t),r=Ee.a.build("search-results__section__region-title",{selected:s||this.hasAtLeastOneCityChecked(e),open:this.state.regionCitiesId===t});return a.a.createElement("div",{className:i,key:t},a.a.createElement("span",{className:r,onClick:this.handleRegionToggleVisibilityClick.bind(this,t)},a.a.createElement(Pe.a,{className:"search-results__section__region-button__arrow",src:"/build/img/svg/icn-arrow-down.svg",cacheGetRequests:!0}),a.a.createElement("h2",{className:"search-results__section__region-title-label"},e.region.name),this.renderCheckedRegionsAndCitiesCount(e,s)),this.renderSingleRegionCitiesList(e,s,t))}renderSelectAllRegionResults(e,t){var s=t,i=Ee.a.build("search-types-popover__option-label",{checked:s});return a.a.createElement("li",{key:e.region.uniqueId,className:"search-types-popover__option",onClick:this.props.handleTermSelectAllCities.bind(this,e)},a.a.createElement(vt,{key:e.region.uniqueId,checked:s}),a.a.createElement("span",{className:i},e.region.label))}renderCitiesResultsList(e,t){var s=this.hasListTermsChecked(e)||t,i=Ee.a.build("search-types-popover__option-label",{checked:s});return a.a.createElement("li",{key:e.uniqueId,className:"search-types-popover__option",onClick:this.props.handleTermSelect.bind(this,e,"click")},a.a.createElement(vt,{key:e.uniqueId,checked:s}),a.a.createElement("span",{className:i},e.name))}renderFetchingResults(){return a.a.createElement("div",{className:"search-results__query"},a.a.createElement("div",{className:"search-results__query__spinner"},a.a.createElement(we.a,null)))}renderNotFetchedResults(){var e="simple"===this.props.suggestType?this.props.searchFieldResults.notFetchedGeoResults:this.props.searchFieldResults.notFetchedResults;return a.a.createElement("div",{className:"search-results__query search-results__query--empty"},this.renderRegionsAndCitiesGeolocalisation(),a.a.createElement("p",{className:"search-results__query__empty-text"},e.title),e.text?a.a.createElement("p",{className:"search-results__query__empty-text"},e.text):null)}renderEmptyResults(){var e="fr"===window.DP.locale?"--french":"--english",t="search-results__result-empty".concat(e);return a.a.createElement("div",{className:"search-results__query search-results__query--empty"},this.renderResultsByListLink(),a.a.createElement("div",{className:"search-results__query--empty-container"},a.a.createElement("p",{className:"search-results__query__empty-title"},this.props.searchFieldResults.emptyResultsTitle," ",a.a.createElement("span",{className:t},this.props.searchText),"."),a.a.createElement("p",{className:"search-results__query__empty-text"},this.props.searchFieldResults.emptyResultsText)))}renderError(){return a.a.createElement("div",{className:"search-results__query search-results__query--empty"},a.a.createElement("p",{className:"search-results__query__empty-title"},this.props.searchFieldResults.errorTitle),a.a.createElement("p",{className:"search-results__query__empty-text"},this.props.searchFieldResults.errorText))}renderCheckedRegionsAndCitiesCount(e,t){var s=t?this.props.searchBar.dropdownRegionsCitiesLabelAll:this.countCitiesCheckedInRegion(e),i=Ee.a.build("search-results__section__region-counter",{hidden:!s});return a.a.createElement("div",null,a.a.createElement("span",{className:i,onClick:this.props.handleTermRemoveAllCities.bind(this,e,!0)},a.a.createElement(Pe.a,{className:"search-results__section__region-counter__icon-check",src:"/build/img/svg/icn-check.svg",cacheGetRequests:!0}),s,a.a.createElement(Pe.a,{className:"search-results__section__region-counter__icon-close",src:"/build/img/svg/icn-compare-no.svg",cacheGetRequests:!0})))}renderSingleRegionCitiesList(e,t,s){return this.state.regionCitiesId!==s?null:a.a.createElement("ul",{className:"search-types-popover__options"},this.renderSelectAllRegionResults(e,t),e.cities.map(e=>this.renderCitiesResultsList(e,t)))}}yt.defaultProps={suggestType:"full"},yt.propTypes={searchSuggestedTerms:ve.PropTypes.shape({payload:ve.PropTypes.arrayOf(ve.PropTypes.shape({id:ve.PropTypes.string.isRequired,name:ve.PropTypes.string.isRequired,details:ve.PropTypes.string.isRequired,typeOfResource:ve.PropTypes.string.isRequired,source:ve.PropTypes.string.isRequired,province:ve.PropTypes.string.isRequired,regionId:ve.PropTypes.number,uniqueId:ve.PropTypes.string.isRequired})).isRequired,status:ve.PropTypes.string.isRequired,highlightedIndex:ve.PropTypes.number}).isRequired,handleTermSelect:ve.PropTypes.func.isRequired,handleTermSelectAllCities:ve.PropTypes.func.isRequired,handleTermRemoveAllCities:ve.PropTypes.func.isRequired,handleByPassSelect:ve.PropTypes.func.isRequired,searchTerms:ve.PropTypes.array.isRequired,searchText:ve.PropTypes.string.isRequired,dispatch:ve.PropTypes.func.isRequired,onHideResults:ve.PropTypes.func.isRequired,onSubmit:ve.PropTypes.func,showNearMe:ve.PropTypes.bool,suggestType:ve.PropTypes.string,searchFieldResults:ve.PropTypes.shape({notFetchedGeoResults:ve.PropTypes.shape({title:ve.PropTypes.string.isRequired,text:ve.PropTypes.string.isRequired}).isRequired,notFetchedResults:ve.PropTypes.shape({title:ve.PropTypes.string.isRequired,text:ve.PropTypes.string.isRequired}).isRequired,emptyResultsTitle:ve.PropTypes.string.isRequired,emptyResultsText:ve.PropTypes.string.isRequired,closeResultsText:ve.PropTypes.string.isRequired,errorTitle:ve.PropTypes.string.isRequired,errorText:ve.PropTypes.string.isRequired}).isRequired,searchBar:ve.PropTypes.shape({button:ve.PropTypes.string.isRequired,submitting:ve.PropTypes.boolean,enabled:ve.PropTypes.boolean,nearMeTermLabel:ve.PropTypes.string.isRequired,advancedSearchLabel:ve.PropTypes.string.isRequired,disabledFields:ve.PropTypes.array.isRequired,displayDropdownRegionsCities:ve.PropTypes.bool.isRequired,dropdownRegionsCitiesLabelAll:ve.PropTypes.string.isRequired,dropdownRegionsLink:ve.PropTypes.string.isRequired}).isRequired,searchRegionsAndCitiesResults:ve.PropTypes.arrayOf(ve.PropTypes.shape({region:ve.PropTypes.shape({id:ve.PropTypes.string.isRequired,uniqueId:ve.PropTypes.string.isRequired,name:ve.PropTypes.string.isRequired,label:ve.PropTypes.string.isRequired,province:ve.PropTypes.string.isRequired,source:ve.PropTypes.string.isRequired,typeOfResource:ve.PropTypes.string,isDirectLink:ve.PropTypes.bool.isRequired}).isRequired,cities:ve.PropTypes.arrayOf(ve.PropTypes.shape({id:ve.PropTypes.string.isRequired,uniqueId:ve.PropTypes.string.isRequired,name:ve.PropTypes.string.isRequired,isDirectLink:ve.PropTypes.bool.isRequired,province:ve.PropTypes.string.isRequired,regionId:ve.PropTypes.string.isRequired,source:ve.PropTypes.string.isRequired,typeOfResource:ve.PropTypes.string.isRequired})).isRequired}))};var Tt=yt=Object(u.b)(({searchTerms:e,searchSuggestedTerms:t,searchFieldResults:s,searchBar:i,searchRegionsAndCitiesResults:a})=>({searchTerms:e,searchSuggestedTerms:t,searchFieldResults:s,searchBar:i,searchRegionsAndCitiesResults:a}))(yt);class ft extends a.a.Component{handleKeyUp(e){if(38===e.keyCode&&this.props.dispatch({type:"HIGHLIGHT_PREVIOUS_SUGGESTED_TERM"}),40===e.keyCode&&this.props.dispatch({type:"HIGHLIGHT_NEXT_SUGGESTED_TERM"}),13===e.keyCode){var t=this.props.highlightedSearchTerm;if(!t)return;this.props.handleTermSelect(t,"enter")}}getPlaceholder(){var{placeholder:e,placeholderGeo:t,selectedLabel:s}=this.props.searchFieldInput,i=this.props.searchTerms.length;return"simple"===this.props.suggestType?i>0?"".concat(i," ").concat(s):t:e}render(){return a.a.createElement("label",{className:"search-field__form__label"},a.a.createElement("span",{className:"is-visually-hidden"},this.props.searchFieldInput.placeholder),a.a.createElement("input",{className:"search-field__form__input",placeholder:this.getPlaceholder(),type:"text",value:this.props.value,onKeyUp:this.handleKeyUp.bind(this),onFocus:this.props.handleFocus.bind(this),onChange:this.props.handleChange.bind(this)}))}}ft.defaultProps={suggestType:"full"},ft.propTypes={dispatch:ve.PropTypes.func.isRequired,value:ve.PropTypes.string.isRequired,handleTermSelect:ve.PropTypes.func.isRequired,handleChange:ve.PropTypes.func.isRequired,handleFocus:ve.PropTypes.func.isRequired,searchFieldInput:ve.PropTypes.shape({placeholder:ve.PropTypes.string.isRequired,placeholderGeo:ve.PropTypes.string.isRequired,selectedLabel:ve.PropTypes.string.isRequired}).isRequired,searchTerms:ve.PropTypes.array.isRequired,highlightedSearchTerm:ve.PropTypes.object,suggestType:ve.PropTypes.string};var Pt=ft=Object(u.b)(({searchFieldInput:e,searchTerms:t,searchSuggestedTerms:s})=>{var{payload:i,highlightedIndex:a}=s;return{searchFieldInput:e,searchTerms:t,highlightedSearchTerm:i[a]}})(ft);class Et extends a.a.Component{constructor(e){super(e),this.documentClick=this.handleDocumentClick.bind(this),this.submitEnabled=!0,this.handleSearch=Ne(this.handleSearch.bind(this),500),this.state={searchText:"",showResults:!1,inputIsFocused:!1,hiddenSearchTermsCount:0}}componentDidUpdate(e,{showResults:t}){t===this.state.showResults&&(!0===t?(document.addEventListener("click",this.documentClick),document.addEventListener("touchstart",this.documentClick)):(document.removeEventListener("click",this.documentClick),document.removeEventListener("touchstart",this.documentClick)))}componentDidMount(){document.addEventListener("mousedown",this.documentClick),Oe()&&this.focusInSearchInput()}activateFormSubmit(){this.setState({searchText:""}),this.submitEnabled=!0,this.props.dispatch({type:"ENABLE_SEARCH"})}deactivateFormSubmit(){this.submitEnabled=!1,this.props.dispatch({type:"DISABLE_SEARCH"})}focusInSearchInput(){var e=95+(p()(".ad-smartbanner").length?p()(".ad-smartbanner").height():0)+(p()(".information-bar").length?p()(".information-bar").height():0);p()(".".concat("search-field__form__input")).on("focus",(function(t){if(1===p()(this).parents(".".concat("search-field--at-search-bar")).length)return null;t.preventDefault(),p()("body, html").animate({scrollTop:e})}))}focusOutSearchInput(){this.refs.searchInput.querySelector(".".concat("search-field__form__input")).blur()}handleDocumentClick(e){[this.refs.searchResults].every(t=>!t.contains(e.target))&&(this.focusOutSearchInput(),this.handleHideResults())}handleInputChange(e){var t=e.target.value,s=t.trim();this.state.searchText.trim()!==s&&(this.handleSearch(s),s.length>0?this.deactivateFormSubmit():this.activateFormSubmit()),this.setState({searchText:t})}handleSearch(e){var{suggestType:t}=this.props;e.length<=2?this.props.dispatch({type:"RESET_SUGGEST_TERMS"}):(this.state.showResults||this.setState({showResults:!0}),this.props.dispatch((({query:e})=>({type:"FETCH_SUGGEST_TERMS",query:e}))({query:e})),Re(e,t).then(t=>{this.props.dispatch((({query:e,terms:t})=>({type:"COMPLETED_SUGGEST_TERMS",query:e,terms:t}))({terms:t,query:e}))}).catch(()=>{this.props.dispatch((({query:e})=>({type:"FAILED_SUGGEST_TERMS",query:e}))({query:e}))}))}handleInputFocus(){this.setState({showResults:!0}),p()(".mobile-header").addClass("mobile-header_search-focus"),p()(".know-more__bar").addClass("know-more__bar-focus")}handleHideResults(){this.setState({showResults:!1}),setTimeout(()=>this.activateFormSubmit(),500),p()(".mobile-header").removeClass("mobile-header_search-focus"),p()(".know-more__bar").removeClass("know-more__bar-focus")}handleFormSubmit(e){e.preventDefault(),this.submitEnabled&&null===this.props.highlightedSearchResultIndex&&this.props.dispatch(pt())}handleTermSelect(e,t){if(e.isDirectLink)return this.handleTermDirectLink(e);if(this.props.searchTerms.find(t=>t.uniqueId===e.uniqueId)){if("enter"===t)return this.props.dispatch(pt());this.handleTermRemove(e)}else"cities"===e.typeOfResource?this.handleCityAdd(e):this.handleTermAdd(e)}handleTermSelectAllCities(e){this.props.searchTerms.find(t=>t.uniqueId===e.region.uniqueId)?(e.cities.map(e=>this.props.dispatch(ze(e))),this.handleTermRemove(e.region)):(this.handleTermRemoveAllCities(e),this.handleTermAdd(e.region))}handleTermRemoveAllCities(e,t){var s=e.cities.map(e=>this.props.searchTerms.find(t=>t.uniqueId===e.uniqueId)),i=t?this.handleTermRemove(e.region):null;s.map(e=>void 0!==e?this.props.dispatch(ze(e)):i)}handleByPassSelect(){this.props.dispatch({type:"BYPASS_SUGGEST_TERMS"})}handleTermAdd(e){this.props.dispatch(Ge(e)),this.activateFormSubmit(),Ue()}handleTermRemove(e){this.props.dispatch(ze(e)),this.activateFormSubmit(),Ue()}handleCityAdd(e){var t=this.props.searchRegionsAndCitiesResults.find(t=>t.region.id===String(e.regionId));t&&(this.props.searchTerms.find(t=>t.uniqueId===e.regionUniqueId)?(this.props.dispatch(ze(t.region)),t.cities.map(t=>{t.uniqueId!==e.uniqueId&&this.props.dispatch(Ge(t))}),this.activateFormSubmit(),Ue()):t.cities.map(e=>this.props.searchTerms.find(t=>t.uniqueId===e.uniqueId)).filter(e=>void 0!==e).length+1>=t.cities.length?(this.handleTermRemoveAllCities(t),this.handleTermAdd(t.region)):this.handleTermAdd(e))}handleTermDirectLink(e){window.location="/".concat(this.props.locale,"/").concat(e.id)}handleInputNearMeClick(){this.setState({fetchingNearMe:!0}),ke().then(e=>{this.props.dispatch(We(e,this.props.nearMeTermLabel)),this.setState({fetchingNearMe:!1}),this.props.dispatch(pt(!0))}).catch(()=>{this.props.dispatch({type:"SHOW_WARNING_MESSAGE"}),this.setState({fetchingNearMe:!1})}),Ue()}handleButtonClearValuesClick(){this.props.dispatch({type:"CLEAR_SEARCH_GEO"})}render(){var e=Ee.a.build("search-field",{["at".concat(this.props.location)]:!0,focus:this.state.showResults,"no-search-icon":!this.props.showSearchIcon});return a.a.createElement("div",{className:e,onFocus:this.handleInputFocus.bind(this),ref:"searchResults"},this.renderSearchIcon(),a.a.createElement("form",{onSubmit:this.handleFormSubmit.bind(this),className:"search-field__form",ref:"searchInput"},this.renderSearchInput()),this.renderNearMe(),this.renderClearValues(),this.renderSearchResults())}renderSearchIcon(){var{showSearchIcon:e}=this.props;return e?a.a.createElement("div",{className:"search-field__magnifier"},a.a.createElement(Pe.a,{className:"search-field__magnifier-icon",src:"/build/img/svg/icn-magnify.svg",cacheGetRequests:!0})):null}renderNearMe(){var{locationText:e,nearMePush:t,showNearMe:s}=this.props,{fetchingNearMe:i}=this.state;if(!s)return null;var r={fetching:i},n=Ee.a.build("search-field__near-me",r);return n=n.concat(" gtm-search-geolocalized"),a.a.createElement("div",{className:n},a.a.createElement("button",{onClick:this.handleInputNearMeClick.bind(this),className:"search-field__near-me-button gtm-search-geolocalized ".concat(t)},a.a.createElement("span",{className:"is-visually-hidden"},e),i?a.a.createElement(we.a,null):this.renderNearMeIcon()))}renderNearMeIcon(){return a.a.createElement(a.a.Fragment,null,a.a.createElement(Pe.a,{className:"search-field__near-me-icon is-no-events",src:"/build/img/svg/icn-pin.svg",cacheGetRequests:!0}),a.a.createElement(Pe.a,{className:"search-field__near-me-icon search-field__near-me-icon--hover is-no-events",src:"/build/img/svg/icn-pin-invert.svg",cacheGetRequests:!0}))}renderClearValues(){var{clearValuesText:e,showClearValues:t,searchTerms:s}=this.props;return!t||s.length<1?null:a.a.createElement("button",{onClick:this.handleButtonClearValuesClick.bind(this),className:"search-field__clear-values"},a.a.createElement("span",{className:"is-visually-hidden"},e),a.a.createElement(Pe.a,{className:"search-field__clear-values__icon",src:"/build/img/svg/icn-close.svg",cacheGetRequests:!0}))}renderSearchInput(){return a.a.createElement(Pt,{value:this.state.searchText,handleTermSelect:this.handleTermSelect.bind(this),handleFocus:this.handleInputFocus.bind(this),handleChange:this.handleInputChange.bind(this),suggestType:this.props.suggestType})}renderSearchResults(){if(this.state.showResults)return a.a.createElement(Tt,{handleTermSelect:this.handleTermSelect.bind(this),handleTermSelectAllCities:this.handleTermSelectAllCities.bind(this),handleTermRemoveAllCities:this.handleTermRemoveAllCities.bind(this),handleByPassSelect:this.handleByPassSelect.bind(this),searchText:this.state.searchText,showNearMe:this.props.showNearMe,onSubmit:this.props.onSubmit,onHideResults:this.handleHideResults.bind(this),suggestType:this.props.suggestType})}}Et.defaultProps={showClearValues:!1,showNearMe:!0,showSearchIcon:!0,suggestType:"full"},Et.propTypes={clearValuesText:ve.PropTypes.string,dispatch:ve.PropTypes.func.isRequired,highlightedSearchResultIndex:ve.PropTypes.number,locale:ve.PropTypes.string.isRequired,location:ve.PropTypes.string.isRequired,locationText:ve.PropTypes.string.isRequired,nearMePush:ve.PropTypes.string,nearMeTermLabel:ve.PropTypes.string.isRequired,onSubmit:ve.PropTypes.func,searchBathrooms:ve.PropTypes.object,searchFilters:ve.PropTypes.object,searchLandArea:ve.PropTypes.object,searchOnlineSince:ve.PropTypes.object,searchOptions:ve.PropTypes.object,searchPriceRange:ve.PropTypes.object,searchRegionsAndCitiesResults:ve.PropTypes.array.isRequired,searchRooms:ve.PropTypes.object,searchSubTypes:ve.PropTypes.object,searchTerms:ve.PropTypes.array.isRequired,searchTypes:ve.PropTypes.object,showClearValues:ve.PropTypes.bool,showSearchIcon:ve.PropTypes.bool,showNearMe:ve.PropTypes.bool,suggestType:ve.PropTypes.string,searchLotSize:ve.PropTypes.object,searchLivingArea:ve.PropTypes.object};var wt=Et=Object(u.b)(({searchRegionsAndCitiesResults:e,searchTerms:t,searchRooms:s,searchTypes:i,searchSubTypes:a,searchPriceRange:r,searchOptions:n,searchLandArea:o,searchBathrooms:l,searchOnlineSince:c,searchFilters:p,searchSuggestedTerms:d,searchLotSize:h,searchLivingArea:u})=>{var{highlightedIndex:m}=d;return{searchRegionsAndCitiesResults:e,searchTerms:t,searchRooms:s,searchTypes:i,searchSubTypes:a,searchPriceRange:r,searchOptions:n,searchLandArea:o,searchBathrooms:l,searchOnlineSince:c,searchFilters:p,searchLotSize:h,searchLivingArea:u,highlightedSearchResultIndex:m}})(Et);class Ct extends a.a.Component{constructor(e){super(e),this.documentClick=this.handleDocumentClick.bind(this)}componentDidMount(){document.addEventListener("click",this.documentClick)}componentWillUnmount(){document.removeEventListener("click",this.documentClick)}handleDocumentClick(e){this.refs.popover.contains(e.target)||this.props.onOuterClick()}render(){return a.a.createElement("div",{ref:"popover"},this.props.children)}}Ct.propTypes={onOuterClick:ve.PropTypes.func.isRequired,children:ve.PropTypes.object.isRequired};var St=Ct;class Rt extends a.a.Component{constructor(e){super(e),this.state={showPopover:!1}}handleTogglePopover(){this.setState({showPopover:!this.state.showPopover})}getLabel(){var{selectedAsLabel:e,searchRooms:t}=this.props,s=t.title;if(e){var i=t.options.find((function(e){return e.value===t.selected}));i&&(s=i.label)}return s}render(){var e="search-rooms ".concat(this.props.extraClasses);return a.a.createElement("div",{className:e},this.renderButton(),this.renderPopover())}renderButton(){var e=Ee.a.build("search-bar__options-button",{active:this.state.showPopover}),t=Ee.a.build("search-bar__options-button__arrow",{active:this.state.showPopover});return a.a.createElement("button",{onClick:this.handleTogglePopover.bind(this),className:e},a.a.createElement("span",{className:"search-bar__options-button__label"},this.getLabel()),a.a.createElement(Pe.a,{className:t,src:"/build/img/svg/icn-arrow-down.svg",cacheGetRequests:!0}))}renderPopover(){return this.state.showPopover?a.a.createElement(St,{onOuterClick:this.handleTogglePopover.bind(this)},a.a.createElement(Nt,{dispatch:this.props.dispatch,label:this.props.searchRooms.label,options:this.props.searchRooms.options,selected:this.props.searchRooms.selected})):null}}class Nt extends a.a.Component{handleOptionClick(e){setTimeout(()=>{this.props.dispatch(Ke(e)),Ue()})}render(){return a.a.createElement("div",{className:"search-rooms-popover"},a.a.createElement("ul",{className:"search-rooms-popover__options"},this.props.options.map(e=>this.renderOption(e))))}renderOption(e){var t=e.value===this.props.selected,s=Ee.a.build("search-rooms-popover__content__option",{checked:t});return a.a.createElement("li",{onClick:this.handleOptionClick.bind(this,e.value),key:"searchRoomsPopoverOption:".concat(e.value),className:s},a.a.createElement("span",{className:"search-rooms-popover__radio"}),e.label)}}var kt=ve.PropTypes.shape({title:ve.PropTypes.string.isRequired,titleSingle:ve.PropTypes.string.isRequired,label:ve.PropTypes.string,options:ve.PropTypes.arrayOf(ve.PropTypes.shape({value:ve.PropTypes.string.isRequired,label:ve.PropTypes.string.isRequired})).isRequired,selected:ve.PropTypes.string.isRequired});Nt.propTypes={dispatch:ve.PropTypes.func.isRequired,label:ve.PropTypes.string.isRequired,options:ve.PropTypes.array.isRequired,selected:ve.PropTypes.string.isRequired},Rt.defaultProps={extraClasses:"",selectedAsLabel:!1},Rt.propTypes={dispatch:ve.PropTypes.func.isRequired,extraClasses:ve.PropTypes.string,searchRooms:kt.isRequired,selectedAsLabel:ve.PropTypes.bool};var Lt=Rt=Object(u.b)(({searchRooms:e})=>({searchRooms:e}))(Rt),Ot=s(101),qt=s.n(Ot);class xt extends a.a.Component{constructor(e){super(e),this.steps=e.searchPriceRangeSlider.stepsSlider,this.options=e.searchPriceRangeSlider.options;var t=[];for(var s in t[this.steps.min[0]]=null,t[this.steps.max[0]]=null,this.options)t[this.options[s].numericValue]=this.options[s];this.priceRange=t,this.state={minPosition:!1,maxPosition:!1,sliderRange:[null,null]}}componentDidMount(){var e=this.props.searchPriceRangeSlider.selected[0],t=this.props.searchPriceRangeSlider.selected[1];this.slider=qt.a.create(this.refs.slider,{connect:!0,start:[e?e.numericValue:this.steps.min[0],t?t.numericValue:this.steps.max[0]],range:this.steps,format:{to:Number,from:Number}}),this.slider.on("update",this.handleSliderUpdate.bind(this)),this.handleSliderChange=Ne(this.handleSliderChange.bind(this),1e3),this.slider.on("change",this.handleSliderChange.bind(this)),this.handleSliderSet=Ne(this.handleSliderSet.bind(this),1e3),this.slider.on("set",this.handleSliderSet.bind(this))}componentDidUpdate(e){this.props.provider!==this.props.searchPriceRangeSlider.sliderProvider&&this.handleChangeSliderPosition(),e.searchReset!==this.props.searchReset&&this.slider.set([this.steps.min[0],this.steps.max[0]])}componentWillUnmount(){this.slider.off("update"),this.slider.off("change"),this.slider.off("set")}handleSliderChange(){this.setState({minPosition:!1,maxPosition:!1})}handleSliderUpdate(e){var[t,s]=e,i=this.priceRange[t],a=this.priceRange[s];if(a=a&&a.numericValue!==this.steps.max[0]?a:null,this.setState({sliderRange:[i?i.value:this.steps.min[0],a?a.value:this.steps.max[0]]}),t===s)return null;this.props.dispatch(Ze(i)),this.props.dispatch(Je(a)),this.props.dispatch({type:"SET_SEARCH_SELECTED_PRICE_RANGE_PROVIDER",value:this.props.provider})}handleSliderSet(){this.props.provider===this.props.searchPriceRangeSlider.sliderProvider&&Ue()}handleChangeSliderPosition(){var e=this.props.searchPriceRangeSlider.selected[0],t=this.props.searchPriceRangeSlider.selected[1];e=e?e.numericValue:this.steps.min[0],t=t?t.numericValue:this.steps.max[0],this.state.sliderRange.toString()!==[e,t].toString()&&(this.slider.set([e,t]),this.setState({sliderRange:[e,t]}))}nextRange(e){var t=Object.values(this.options).map(e=>e.numericValue),s=t.indexOf(e)+1;return t[s]}render(){var e="search-price-range ".concat(this.props.extraClasses);return a.a.createElement("div",{className:e},a.a.createElement("div",{className:"search-price-range__slider"},a.a.createElement("div",{ref:"slider"})),this.renderLabel())}renderLabel(){var e=this.props.searchPriceRangeSlider.selected[0],t=this.props.searchPriceRangeSlider.selected[1];e=e?e.value:this.steps.min[0],t=t&&t.numericValue!==this.steps.max[0]?t.value:null;var s=d.a.encodeCurrencyValue(e,{noDecimal:!0}),i=t?d.a.encodeCurrencyValue(t,{noDecimal:!0}):this.props.searchPriceRangeSlider.noMaximumLabel,r=window.DP.isRental&&t?this.props.searchPriceRangeSlider.precisionLabel:"";return a.a.createElement("div",{className:"search-price-range__label"},a.a.createElement("span",null,s),a.a.createElement("span",null,i,r))}}xt.defaultProps={extraClasses:""},xt.propTypes={dispatch:ve.PropTypes.func.isRequired,searchReset:ve.PropTypes.number,searchPriceRangeSlider:ve.PropTypes.shape({stepsSlider:ve.PropTypes.object.isRequired,options:ve.PropTypes.array.isRequired,selected:ve.PropTypes.array.isRequired,noMaximumLabel:ve.PropTypes.string.isRequired,noMinimumLabel:ve.PropTypes.string.isRequired,precisionLabel:ve.PropTypes.string.isRequired,sliderProvider:ve.PropTypes.string.isRequired}).isRequired,provider:ve.PropTypes.string.isRequired,extraClasses:ve.PropTypes.string};var Mt=xt=Object(u.b)(({searchPriceRange:e,searchReset:t})=>({searchPriceRangeSlider:e,searchReset:t}))(xt),Dt=({selected:e})=>e[0]||e[1],At=(e,t)=>{var s=0;return e.length&&e.map(e=>{s+=e.typeId===t}),s},It=(e,t)=>{var s=0;return e.options.map(e=>{var i=At(t.options,e.id),a=At(t.selected,e.id);s+=a===i?1:a}),s},Bt=e=>{var t=0,{searchTerms:s,searchTypes:i,searchSubTypes:a,searchOptions:r,searchRooms:n,searchBathrooms:o,searchPriceRange:l,searchOnlineSince:c,searchFilters:p,searchFlags:d,searchLotSize:h,searchLivingArea:u}=e;return t+=s.length,t+=It(i,a),t+=r.selected.length,n.selected>n.defaultValue&&(t+=1),o.selected>o.defaultValue&&(t+=1),Dt(l)&&(t+=1),c.selected!==c.defaultValue&&(t+=1),p.selected!==p.defaultValue&&(t+=1),h.selected!==h.defaultValue&&(t+=1),u.selected!==u.defaultValue&&(t+=1),d.defaultValue.forEach(e=>{d.selected.includes(e)||(t+=1)}),t},Ft=e=>{var t=0,{searchTerms:s,searchTypes:i,searchSubTypes:a,searchRooms:r,searchBathrooms:n,searchPriceRange:o}=e;return t+=s.length,r.selected>r.defaultValue&&(t+=1),n.selected>n.defaultValue&&(t+=1),Dt(o)&&(t+=1),It(i,a)&&(t+=1),t},jt=At;class Vt extends a.a.Component{handleOptionClick(e){var t=this.props.searchSubTypes.options.filter(e=>e.typeId===this.props.type.id);setTimeout(()=>{t.length===e?(this.props.dispatch(at(t)),this.props.dispatch(tt(this.props.type.id))):(this.props.dispatch(it(t)),this.props.dispatch(et(this.props.type.id))),Ue()})}render(){if(!this.props.subTypeOpened)return null;var e=this.props.searchSubTypes.options.filter(e=>e.typeId===this.props.type.id),t=this.props.searchSubTypes.selected.map(({id:e})=>e),s=e.filter(e=>t.includes(e.id)),i=e.length===s.length,r=Ee.a.build("search-subtypes-popover__type-name",{checked:i});return a.a.createElement("div",{className:"search-subtypes-popover__type"},a.a.createElement("div",{onClick:this.handleOptionClick.bind(this,s.length),className:r},a.a.createElement(vt,{checked:i}),this.props.searchSubTypes.checkAllLabel),a.a.createElement("div",{className:"search-subtypes-popover__subtypes"},e.map(e=>this.renderSubTypeOption(e))))}renderSubTypeOption(e){return a.a.createElement(Ut,{key:"additionalCriteriaSubtype:".concat(e.id),subType:e})}}class Ut extends a.a.Component{handleOptionClick(e){setTimeout(()=>{var t=e?st(this.props.subType):{type:"ADD_SEARCH_SELECTED_SUBTYPE",subType:this.props.subType};this.props.dispatch(t),this.updateTypeBasedOnSelectedSubtypes(),Ue()})}updateTypeBasedOnSelectedSubtypes(){var{searchSubTypes:e,subType:t}=this.props,s=jt(e.options,t.typeId);jt(e.selected,t.typeId)!==s?-1!==this.props.searchTypes.selected.indexOf(t.typeId)&&this.props.dispatch(Qe(t.typeId)):this.props.dispatch({type:"ADD_SEARCH_SELECTED_TYPE",searchType:t.typeId})}render(){var e=!!this.props.searchSubTypes.selected.find(({id:e})=>e===this.props.subType.id),t=Ee.a.build("search-subtypes-popover__subtype",{checked:e});return a.a.createElement("div",{onClick:this.handleOptionClick.bind(this,e),className:t},a.a.createElement(vt,{checked:e}),this.props.subType.name)}}var Ht=ve.PropTypes.shape({checkAllLabel:ve.PropTypes.string.isRequired,options:ve.PropTypes.arrayOf(ve.PropTypes.shape({id:ve.PropTypes.string.isRequired,name:ve.PropTypes.string.isRequired})).isRequired,selected:ve.PropTypes.arrayOf(ve.PropTypes.shape({id:ve.PropTypes.string.isRequired,typeId:ve.PropTypes.string.isRequired})).isRequired}),$t=ve.PropTypes.shape({options:ve.PropTypes.arrayOf(ve.PropTypes.shape({id:ve.PropTypes.string.isRequired,name:ve.PropTypes.string.isRequired})).isRequired,selected:ve.PropTypes.array.isRequired});Vt.propTypes={dispatch:ve.PropTypes.func.isRequired,searchSubTypes:Ht.isRequired,searchTypes:$t.isRequired,type:ve.PropTypes.object.isRequired,subTypeOpened:ve.PropTypes.bool.isRequired},Ut.propTypes={dispatch:ve.PropTypes.func.isRequired,searchSubTypes:Ht.isRequired,searchTypes:$t.isRequired,subType:ve.PropTypes.object.isRequired},Vt=Object(u.b)(({searchSubTypes:e,searchTypes:t})=>({searchSubTypes:e,searchTypes:t}))(Vt),Ut=Object(u.b)(({searchTypes:e,searchSubTypes:t})=>({searchTypes:e,searchSubTypes:t}))(Ut);var Gt=Vt;class zt extends a.a.Component{constructor(e){super(e),this.state={subTypeOpened:!1}}handleToggleClick(){this.setState({subTypeOpened:!this.state.subTypeOpened})}handleOptionClick(){var e=this.props.searchSubTypes.options.filter(e=>e.typeId===this.props.type.id);setTimeout(()=>{this.props.dispatch(at(e)),this.props.dispatch(tt(this.props.type.id)),Ue()})}render(){var e=Ee.a.build("search-types-popover__type-button",{opened:this.state.subTypeOpened});return a.a.createElement("li",{className:"search-types-popover__option search-types-popover__option--types"},a.a.createElement("div",{className:e},a.a.createElement("span",{onClick:this.handleToggleClick.bind(this)},a.a.createElement(Pe.a,{className:"search-types-popover__type-button__arrow",src:"/build/img/svg/icn-arrow-down.svg",cacheGetRequests:!0}),this.props.type.name),this.renderCheckbox()),a.a.createElement(Gt,{type:this.props.type,subTypeOpened:this.state.subTypeOpened}))}renderCheckbox(){var e=this.props.searchSubTypes.options.filter(e=>this.props.type.id===e.typeId),t=this.props.searchSubTypes.selected.map(({id:e})=>e),s=e.filter(e=>t.includes(e.id));return s.length?a.a.createElement("div",{onClick:this.handleOptionClick.bind(this),className:"search-types-popover__type-button-unchecked"},a.a.createElement(Pe.a,{className:"search-types-popover__type-button-unchecked__checked",src:"/build/img/svg/icn-check.svg"}),e.length===s.length?this.props.searchTypes.checkedAllLabel:s.length,a.a.createElement(Pe.a,{className:"search-types-popover__type-button-unchecked__close",src:"/build/img/svg/icn-close.svg"})):null}}zt.propTypes={dispatch:ve.PropTypes.func.isRequired,selectedTypes:ve.PropTypes.array.isRequired,searchTypes:ve.PropTypes.object.isRequired,searchSubTypes:ve.PropTypes.object.isRequired,type:ve.PropTypes.object.isRequired};var Wt=zt=Object(u.b)(({searchTypes:e,searchSubTypes:t})=>({searchTypes:e,searchSubTypes:t}))(zt);class Kt extends a.a.Component{constructor(e){super(e)}handleOptionClick(e){var t=this.props.searchSubTypes.options.filter(e=>e.typeId===this.props.type.id);setTimeout(()=>{t.length===e||0!==e?(this.props.dispatch(at(t)),this.props.dispatch(tt(this.props.type.id))):(this.props.dispatch(it(t)),this.props.dispatch(et(this.props.type.id))),Ue()})}render(){var e=this.props.searchSubTypes.options.filter(e=>e.typeId===this.props.type.id),t=this.props.searchSubTypes.selected.map(({id:e})=>e),s=e.filter(e=>t.includes(e.id)),i=0!==s.length,r=Ee.a.build("search-types-popover__type-button",{opened:i});return a.a.createElement("li",{className:"search-types-popover__option search-types-popover__option--types",onClick:this.handleOptionClick.bind(this,s.length)},a.a.createElement("div",{className:r},a.a.createElement(vt,{checked:i}),a.a.createElement("span",null,this.props.type.name)))}}Kt.propTypes={dispatch:ve.PropTypes.func.isRequired,selectedTypes:ve.PropTypes.array.isRequired,searchTypes:ve.PropTypes.object.isRequired,searchSubTypes:ve.PropTypes.object.isRequired,type:ve.PropTypes.object.isRequired};var Yt=Kt=Object(u.b)(({searchTypes:e,searchSubTypes:t})=>({searchTypes:e,searchSubTypes:t}))(Kt),Xt=ve.PropTypes.shape({options:ve.PropTypes.arrayOf(ve.PropTypes.shape({id:ve.PropTypes.string.isRequired,name:ve.PropTypes.string.isRequired})).isRequired,selected:ve.PropTypes.array.isRequired});class Zt extends a.a.Component{constructor(e){super(e),this.state={showPopover:!1}}handleTogglePopover(){this.setState({showPopover:!this.state.showPopover})}render(){var e="search-types ".concat(this.props.extraClasses);return a.a.createElement("div",{className:e},this.renderButton(),this.renderPopover())}renderButton(){var e=Ee.a.build("search-bar__options-button",{active:this.state.showPopover});return a.a.createElement("button",{onClick:this.handleTogglePopover.bind(this),className:e},this.renderButtonLabel())}renderLabel(){var{selectedAsLabel:e,searchTypes:t,selectedLabel:s}=this.props,i=t.placeholder,r=t.placeholderShort;if(e)if(1===t.selected.length){var n=t.options.find((function(e){return e.id===t.selected[0]}));n&&(i=r=n.name)}else t.selected.length>1&&(i=r="".concat(t.selected.length," ").concat(s));return a.a.createElement(a.a.Fragment,null,a.a.createElement("span",{className:"search-bar__options-button__label-long"},i),a.a.createElement("span",{className:"search-bar__options-button__label-short"},r))}renderButtonLabel(){var e=Ee.a.build("search-bar__options-button__arrow",{active:this.state.showPopover});return a.a.createElement("span",{className:"search-bar__options-button__label"},this.renderLabel(),a.a.createElement(Pe.a,{className:e,src:"/build/img/svg/icn-arrow-down.svg",cacheGetRequests:!0}))}renderPopover(){return this.state.showPopover?a.a.createElement(St,{onOuterClick:this.handleTogglePopover.bind(this)},a.a.createElement(Jt,{dispatch:this.props.dispatch,searchTypes:this.props.searchTypes})):null}}class Jt extends a.a.Component{render(){return a.a.createElement("div",{className:"search-types-popover"},a.a.createElement("ul",{className:"search-types-popover__options"},this.props.searchTypes.options.map(e=>this.renderOption(e))))}renderOption(e){return"qc"!==window.DP.province?a.a.createElement(Yt,{type:e,key:"searchTypesPopoverOption:".concat(e.id),selectedTypes:this.props.searchTypes.selected,dispatch:this.props.dispatch}):a.a.createElement(Wt,{type:e,key:"searchTypesPopoverOption:".concat(e.id),selectedTypes:this.props.searchTypes.selected,dispatch:this.props.dispatch})}}Jt.propTypes={dispatch:ve.PropTypes.func.isRequired,searchTypes:Xt.isRequired},Zt.defaultProps={extraClasses:"",selectedAsLabel:!1,selectedLabel:""},Zt.propTypes={dispatch:ve.PropTypes.func.isRequired,extraClasses:ve.PropTypes.string,searchTypes:Xt.isRequired,selectedAsLabel:ve.PropTypes.bool,selectedLabel:ve.PropTypes.string};var Qt=Zt=Object(u.b)(({searchTypes:e})=>({searchTypes:e}))(Zt);class es extends a.a.Component{handleOptionClick(e){this.props.dispatch(ot(e.id)),Ue()}render(){return a.a.createElement("div",{className:"search-additional-criteria-popover__section"},a.a.createElement("div",{className:"search-additional-criteria-popover__section__title search-additional-criteria-popover__section__title--filter"},this.props.searchFilters.title),a.a.createElement("div",{className:"search-additional-criteria-popover__content"},a.a.createElement("ul",{className:"search-additional-criteria-popover__content__options"},this.props.searchFilters.options.map(e=>this.renderOption(e)))))}renderOption(e){var t=this.props.searchFilters.selected===e.id,s=Ee.a.build("search-additional-criteria-popover__content__option",{checked:t});return a.a.createElement("li",{key:"search-additional-criteriaFilter:".concat(e.id),onClick:this.handleOptionClick.bind(this,e),className:"".concat(s," ").concat(e.id)},a.a.createElement("span",{className:"search-additional-criteria-popover__radio"}),e.name)}}var ts=ve.PropTypes.shape({title:ve.PropTypes.string.isRequired,options:ve.PropTypes.arrayOf(ve.PropTypes.shape({id:ve.PropTypes.string.isRequired,name:ve.PropTypes.string.isRequired})).isRequired,selected:ve.PropTypes.string.isRequired});es.propTypes={dispatch:ve.PropTypes.func.isRequired,searchFilters:ts.isRequired};var ss=es=Object(u.b)(({searchFilters:e})=>({searchFilters:e}))(es),is=ve.PropTypes.shape({title:ve.PropTypes.string.isRequired,options:ve.PropTypes.arrayOf(ve.PropTypes.shape({id:ve.PropTypes.string.isRequired,name:ve.PropTypes.string.isRequired,nameWithoutText:ve.PropTypes.string.isRequired,help:ve.PropTypes.string,invisible:ve.PropTypes.bool})).isRequired,selected:ve.PropTypes.array.isRequired});class as extends a.a.Component{render(){return a.a.createElement("div",{className:"search-additional-criteria-popover__section"},a.a.createElement("div",{className:"search-additional-criteria-popover__section__title search-additional-criteria-popover__section__title--flags"},this.props.searchFlags.title),a.a.createElement("div",{className:"search-additional-criteria-popover__content"},a.a.createElement("ul",{className:"search-additional-criteria-popover__content__options"},this.props.searchFlags.options.map(e=>{var t=!!this.props.searchFlags.selected.find(t=>t===e.id);return a.a.createElement(rs,{key:"search-additional-criteriaFlag:".concat(e.id),dispatch:this.props.dispatch,option:e,checked:t})}))))}}class rs extends a.a.Component{handleOptionClick(){var e=this.props.checked?{type:"REMOVE_SEARCH_SELECTED_FLAG",flag:this.props.option.id}:lt(this.props.option.id);this.props.dispatch(e),Ue()}render(){var e=Ee.a.build("search-additional-criteria-popover__content__option",{checked:this.props.checked});return a.a.createElement("div",{className:"search-additional-criteria-popover__content__option-wrapper".concat(this.props.option.invisible?" is-visually-hidden":"")},a.a.createElement("li",{onClick:this.handleOptionClick.bind(this),className:e},a.a.createElement(vt,{checked:this.props.checked}),this.props.option.name),this.renderHelp())}renderHelp(){if(this.props.option.help&&""!==this.props.option.help)return a.a.createElement("div",{className:"search-additional-criteria-popover__content__option-help"},a.a.createElement(Pe.a,{className:"search-additional-criteria-popover__content__option-help-toggle",src:"/build/img/svg/icn-navbar-contact.svg",cacheGetRequests:!0}),a.a.createElement("div",{className:"search-additional-criteria-popover__content__option-help-content"},a.a.createElement("div",{className:"popover-arrow"}),this.props.option.help))}}as.propTypes={dispatch:ve.PropTypes.func.isRequired,searchFlags:is.isRequired},rs.propTypes={dispatch:ve.PropTypes.func.isRequired,checked:ve.PropTypes.bool.isRequired,option:ve.PropTypes.shape({id:ve.PropTypes.string.isRequired,name:ve.PropTypes.string.isRequired,nameWithoutText:ve.PropTypes.string.isRequired,help:ve.PropTypes.string,invisible:ve.PropTypes.bool}).isRequired};var ns=as=Object(u.b)(({searchFlags:e})=>({searchFlags:e}))(as);class os extends a.a.Component{render(){var e=this.props.searchOptions.options;return a.a.createElement("div",{id:this.props.dropDownId,className:"select-dropdown__options jq-dropdown"},a.a.createElement("div",{className:"search-subtypes-popover__subtypes"},e.map(e=>this.renderSubOption(e))))}renderSubOption(e){return this.props.searchOptions.showEmptyChoice||"0"!==e.id?a.a.createElement(ls,{key:"additionalCriteriaOption:".concat(e.id),option:e}):null}}class ls extends a.a.Component{handleOptionClick(e){var t=e?nt(this.props.option.id):rt(this.props.option.id);this.props.dispatch(t),Ue()}render(){var e=!!this.props.searchOptions.selected.find(e=>e===this.props.option.id),t=Ee.a.build("search-subtypes-popover__subtype",{checked:e});return a.a.createElement("div",{onClick:this.handleOptionClick.bind(this,e),className:t},a.a.createElement(vt,{checked:e}),this.props.option.name)}}var cs=ve.PropTypes.shape({title:ve.PropTypes.string.isRequired,actionTitle:ve.PropTypes.string.isRequired,actionSelectAll:ve.PropTypes.string.isRequired,actionUnselectAll:ve.PropTypes.string.isRequired,multipleValueText:ve.PropTypes.string.isRequired,options:ve.PropTypes.arrayOf(ve.PropTypes.shape({id:ve.PropTypes.string.isRequired,name:ve.PropTypes.string.isRequired})).isRequired,selected:ve.PropTypes.array.isRequired,showEmptyChoice:ve.PropTypes.bool.isRequired});os.propTypes={dispatch:ve.PropTypes.func.isRequired,searchOptions:cs.isRequired,dropDownId:ve.PropTypes.string},ls.propTypes={dispatch:ve.PropTypes.func.isRequired,searchOptions:cs.isRequired,option:ve.PropTypes.object.isRequired},os=Object(u.b)(({searchOptions:e})=>({searchOptions:e}))(os),ls=Object(u.b)(({searchOptions:e})=>({searchOptions:e}))(ls);var ps=os;class ds extends a.a.Component{render(){return a.a.createElement(a.a.Fragment,null,this.props.searchBar.isRental?this.renderRentalSection():this.renderSellSection())}renderSellSection(){return a.a.createElement("div",{className:"search-additional-criteria-popover__section"},a.a.createElement("div",{className:"search-additional-criteria-popover__section__title"},this.props.searchOptions.title),a.a.createElement("div",{className:"select-dropdown"},a.a.createElement("div",{className:"select-dropdown__label","data-jq-dropdown":"#".concat("characteristics-dropdown")},a.a.createElement("span",{className:"select-dropdown__placeholder"},this.renderLabel()),a.a.createElement(Pe.a,{className:"select-dropdown__arrow",src:"/build/img/svg/icn-arrow-down.svg",cacheGetRequests:!0})),a.a.createElement(ps,{dropDownId:"characteristics-dropdown"})))}renderRentalSection(){return a.a.createElement("div",{className:"search-additional-criteria-popover__section"},a.a.createElement("div",{className:"search-additional-criteria-popover__section__title"},this.props.searchOptions.title),a.a.createElement("div",{className:"search-additional-criteria-popover__content"},a.a.createElement("div",{className:"search-additional-criteria-popover__content__options"},this.props.searchOptions.options.map(e=>this.renderRentalOption(e)))))}renderRentalOption(e){return"0"===e.id?null:a.a.createElement(hs,{key:"additionalCriteriaOption:".concat(e.id),option:e})}renderLabel(){var e=this.props.searchOptions.options,t=this.props.searchOptions.selected.map(e=>e),s=e.filter(e=>t.includes(e.id)),i=this.props.searchOptions.title;return s.length&&!Oe()&&(i=this.renderSelectedCountText(s)),i}renderSelectedCountText(e){var t=e.length>1?this.props.searchOptions.selectedCountText[1]:this.props.searchOptions.selectedCountText[0];return"".concat(e.length," ").concat(t)}}class hs extends a.a.Component{handleOptionClick(e){var t=e?nt(this.props.option.id):rt(this.props.option.id);this.props.dispatch(t),Ue()}render(){var e=!!this.props.searchOptions.selected.find(e=>e===this.props.option.id),t=Ee.a.build("search-additional-criteria-popover__content__option",{checked:e});return a.a.createElement("div",{onClick:this.handleOptionClick.bind(this,e),className:t},a.a.createElement(vt,{checked:e}),this.props.option.name)}}var us=ve.PropTypes.shape({title:ve.PropTypes.string.isRequired,actionTitle:ve.PropTypes.string.isRequired,actionSelectAll:ve.PropTypes.string.isRequired,actionUnselectAll:ve.PropTypes.string.isRequired,multipleValueText:ve.PropTypes.string.isRequired,options:ve.PropTypes.arrayOf(ve.PropTypes.shape({id:ve.PropTypes.string.isRequired,name:ve.PropTypes.string.isRequired})).isRequired,selected:ve.PropTypes.array.isRequired,selectedCountText:ve.PropTypes.array}),ms=ve.PropTypes.shape({isRental:ve.PropTypes.boolean});ds.propTypes={dispatch:ve.PropTypes.func.isRequired,searchOptions:us.isRequired,searchBar:ms.isRequired},hs.propTypes={dispatch:ve.PropTypes.func.isRequired,searchOptions:us.isRequired,option:ve.PropTypes.object.isRequired},ds=Object(u.b)(({searchOptions:e,searchBar:t})=>({searchOptions:e,searchBar:t}))(ds),hs=Object(u.b)(({searchOptions:e})=>({searchOptions:e}))(hs);var gs=ds;class _s extends a.a.Component{handleOptionClick(e){setTimeout(()=>{this.props.dispatch(Ye(e)),Ue()})}renderPlaceholder(){var{searchBathrooms:e}=this.props,t=e.options.find(t=>t.value===e.selected);return Object(be.b)()?e.title:t.label}render(){return a.a.createElement("div",{className:"search-additional-criteria-popover__section"},a.a.createElement("div",{className:"search-additional-criteria-popover__section__title"},this.props.searchBathrooms.title),a.a.createElement("div",{className:"select-dropdown"},a.a.createElement("div",{className:"select-dropdown__label","data-jq-dropdown":"#".concat("bathrooms-dropdown")},a.a.createElement("span",{className:"select-dropdown__placeholder"},this.renderPlaceholder()),a.a.createElement(Pe.a,{className:"select-dropdown__arrow",src:"/build/img/svg/icn-arrow-down.svg",cacheGetRequests:!0})),a.a.createElement("div",{className:"search-bathrooms-popover jq-dropdown",id:"bathrooms-dropdown"},a.a.createElement("ul",{className:"search-bathrooms-popover__content__options"},this.props.searchBathrooms.options.map(e=>this.renderOption(e))))))}renderOption(e){var t=e.value===this.props.searchBathrooms.selected,s=Ee.a.build("search-bathrooms-popover__content__option",{checked:t});return a.a.createElement("li",{onClick:this.handleOptionClick.bind(this,e.value),key:"searchBathRoomsPopoverOption:".concat(e.value),className:s},a.a.createElement("span",{className:"search-bathrooms-popover__radio"}),e.label)}}var bs=ve.PropTypes.shape({title:ve.PropTypes.string.isRequired,titleSingle:ve.PropTypes.string.isRequired,options:ve.PropTypes.arrayOf(ve.PropTypes.shape({value:ve.PropTypes.string.isRequired,label:ve.PropTypes.string.isRequired})).isRequired,selected:ve.PropTypes.string.isRequired});_s.propTypes={dispatch:ve.PropTypes.func.isRequired,searchBathrooms:bs.isRequired};var vs=_s=Object(u.b)(({searchBathrooms:e})=>({searchBathrooms:e}))(_s),ys=s(75);function Ts(){return(Ts=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e}).apply(this,arguments)}class fs extends a.a.Component{handleSelect(e){this.props.onSelect(e),"amortization"===this.props.dropdownId&&setTimeout(()=>{new ys.a(p()(".listing-mortgage-calculator__content")).calculate(p()(".mortgage-data__table__row__monthly-mortgage"))})}render(){return a.a.createElement("div",{className:"select-dropdown"},this.renderLabel(),this.renderPopover())}renderLabel(){var e=this.props.options.find(e=>e.value===this.props.selected),t=!!this.props.isDisabled,s=Ee.a.build("select-dropdown__label",{disabled:t}),i={};return t||(i["data-jq-dropdown"]="#".concat(this.props.dropdownId)),a.a.createElement("div",Ts({className:s},i),e&&!Oe()?this.renderSelectedValue(e):this.renderPlaceHolder(),a.a.createElement(Pe.a,{className:"select-dropdown__arrow",src:"/build/img/svg/icn-arrow-down.svg",cacheGetRequests:!0}))}renderSelectedValue(e){return a.a.createElement("span",{className:"select-dropdown__selected-value"},e.label)}renderPlaceHolder(){return a.a.createElement("span",{className:"select-dropdown__placeholder"},this.props.placeholder)}renderPopover(){return a.a.createElement("div",{id:this.props.dropdownId,className:"select-dropdown__options jq-dropdown"},this.props.options.map(e=>this.renderOption(e)))}renderOption(e){var t=this.props.selected===e.value,s=Ee.a.build("select-dropdown__option",{selected:t});return a.a.createElement("div",{key:e.value,className:s,"data-value":e.value,onClick:this.handleSelect.bind(this,e)},e.label)}}fs.propTypes={onSelect:ve.PropTypes.func.isRequired,dropdownId:ve.PropTypes.string.isRequired,selected:ve.PropTypes.oneOfType([ve.PropTypes.string,ve.PropTypes.number]),isDisabled:ve.PropTypes.bool,placeholder:ve.PropTypes.oneOfType([ve.PropTypes.string,ve.PropTypes.number]),options:ve.PropTypes.arrayOf(ve.PropTypes.shape({label:ve.PropTypes.string.isRequired,value:ve.PropTypes.oneOfType([ve.PropTypes.string,ve.PropTypes.number])})).isRequired};var Ps=fs;class Es extends a.a.Component{handleOptionChange(e){setTimeout(()=>{this.props.dispatch(Xe(e.value)),Ue(),window.Dropdown("hide")})}handleOptionClick(e){setTimeout(()=>{this.props.dispatch(Xe(e)),Ue()})}render(){return a.a.createElement(a.a.Fragment,null,this.props.searchBar.isRental?this.renderRentalSection():this.renderSellSection())}renderSellSection(){return a.a.createElement("div",{className:"search-additional-criteria-popover__section"},a.a.createElement("div",{className:"search-additional-criteria-popover__section__title"},this.props.searchOnlineSince.title),a.a.createElement(Ps,{dropdownId:"online-since-dropdown",options:this.props.searchOnlineSince.options,placeholder:this.props.searchOnlineSince.title,selected:this.props.searchOnlineSince.selected,onSelect:this.handleOptionChange.bind(this)}))}renderRentalSection(){return a.a.createElement("div",{className:"search-additional-criteria-popover__section"},a.a.createElement("div",{className:"search-additional-criteria-popover__section__title"},this.props.searchOnlineSince.title),a.a.createElement("div",{className:"search-additional-criteria-popover__content"},a.a.createElement("ul",{className:"search-additional-criteria-popover__content__options"},this.props.searchOnlineSince.options.map(e=>this.renderRentalOption(e)))))}renderRentalOption(e){var t=e.value===this.props.searchOnlineSince.selected,s=Ee.a.build("search-additional-criteria-popover__content__option",{checked:t});return a.a.createElement("li",{onClick:this.handleOptionClick.bind(this,e.value),key:"searchAdditionalCriteriaOption:".concat(e.value),className:s},a.a.createElement("span",{className:"search-additional-criteria-popover__radio"}),e.label)}}var ws=ve.PropTypes.shape({title:ve.PropTypes.string.isRequired,options:ve.PropTypes.arrayOf(ve.PropTypes.shape({value:ve.PropTypes.number.isRequired,label:ve.PropTypes.string.isRequired})).isRequired,selected:ve.PropTypes.number.isRequired}),Cs=ve.PropTypes.shape({isRental:ve.PropTypes.boolean});Es.propTypes={dispatch:ve.PropTypes.func.isRequired,searchOnlineSince:ws.isRequired,searchBar:Cs.isRequired};var Ss=Es=Object(u.b)(({searchOnlineSince:e,searchBar:t})=>({searchOnlineSince:e,searchBar:t}))(Es);class Rs extends a.a.Component{handleUnitClick(e){this.props.dispatch((e=>({type:"SET_SEARCH_SELECTED_LAND_AREA_UNIT",unit:e}))(e)),this.props.dispatch(dt("")),this.props.dispatch(ht("")),this.props.dispatch(ut("~")),this.props.dispatch(mt("")),this.props.dispatch(gt("")),this.props.dispatch(_t("~"))}render(){return a.a.createElement("div",{className:"search-additional-criteria-popover__section search-additional-criteria-popover__section--land-area"},a.a.createElement("div",{className:"search-additional-criteria-popover__section__title search-additional-criteria-popover__section__title--land-area"},a.a.createElement("div",{className:"search-additional-criteria-popover__section__label"},this.props.searchLandArea.title),this.renderActions()))}renderActions(){var e=Ee.a.build("search-additional-criteria-popover__actions__unit",{selected:"foot"===this.props.searchLandArea.selectedUnit}),t=Ee.a.build("search-additional-criteria-popover__actions__unit",{selected:"meter"===this.props.searchLandArea.selectedUnit});return a.a.createElement("div",{className:"search-additional-criteria-popover__actions"},a.a.createElement("span",{className:"search-additional-criteria-popover__actions__units"},a.a.createElement("span",{className:e,onClick:this.handleUnitClick.bind(this,"foot")},this.props.searchLandArea.footTitle),a.a.createElement("span",{className:t,onClick:this.handleUnitClick.bind(this,"meter")},this.props.searchLandArea.meterTitle)))}}var Ns=ve.PropTypes.shape({title:ve.PropTypes.string.isRequired,meterTitle:ve.PropTypes.string.isRequired,footTitle:ve.PropTypes.string.isRequired,selectedUnit:ve.PropTypes.string.isRequired,selected:ve.PropTypes.string.isRequired});Rs.propTypes={dispatch:ve.PropTypes.func.isRequired,searchLandArea:Ns.isRequired};var ks=Rs=Object(u.b)(({searchSelectedLandAreaUnit:e,searchLandArea:t,setSearchSelectedLotSizeMinimum:s,setSearchSelectedLotSizeMaximum:i,setSearchSelectedLotSize:a})=>({selectedLandAreaUnit:e,searchLandArea:t,setSearchSelectedLotSizeMinimum:s,setSearchSelectedLotSizeMaximum:i,setSearchSelectedLotSize:a}))(Rs);function Ls(){return(Ls=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e}).apply(this,arguments)}var Os=/\D/;class qs extends a.a.Component{constructor(e){super(e),this.state={inputOption:{label:this.props.options[0].label,value:this.props.options[0].value},inputTextCleaned:""},this.handleChange=this.handleChange.bind(this),this.handleBlur=this.handleBlur.bind(this),this.handleKeyDown=this.handleKeyDown.bind(this)}handleSelect(e,t){t||(this.props.onSelect(e),this.setState({inputTextCleaned:"",inputOption:{label:"",value:""}}))}handleChange(e){var t=e.target.value.replace(Os,"").trim(),s=Number(t),i={label:this.props.options[0].label,value:this.props.options[0].value};if("undefined"!==s&&Number.isInteger(s)){var a=this.handleInvertedMinimumValue(this.props.selectedMinimum,s);!this.handleInvertedMaximumValue(this.props.selectedMaximum,s)&&!a&&s<99999999&&(i={label:t,value:t},this.setState({inputTextCleaned:""})),this.setState({inputOption:i}),this.setState({inputTextCleaned:t})}}handleInvertedMinimumValue(e,t){return void 0!==e&&""!==e&&e>=t}handleInvertedMaximumValue(e,t){return void 0!==e&&""!==e&&e<=t}handleBlur(){""!==this.state.inputOption.value&&this.state.inputOption.value!==this.props.selected&&this.props.onSelect(this.state.inputOption)}handleKeyDown(e){13===e.keyCode&&this.props.onSelect(this.state.inputOption)}render(){return a.a.createElement("div",{className:"select-dropdown"},this.renderMobileLabel(),this.renderLabel(),this.renderPopover())}renderMobileLabel(){var e=void 0!==this.props.mobileMinimumLabel,t=void 0!==this.props.mobileMaximumLabel;if(e||t)return null;var s=e?this.props.mobileMinimumLabel:this.props.mobileMaximumLabel;return a.a.createElement("div",{className:"select-dropdown__label--mobile"},s)}renderLabel(){var e=""===this.props.selected||void 0===this.props.selected?{label:this.props.options[0].label,value:this.props.options[0].value}:{label:d.a.formatNumbers(this.props.selected),value:this.props.selected},t=!!this.props.isDisabled,s=Ee.a.build("select-dropdown__label",{disabled:t}),i={};return t||(i["data-jq-dropdown-children"]="#".concat(this.props.dropdownId)),a.a.createElement("div",Ls({className:s},i),e?this.renderSelectedValue(e):this.renderPlaceHolder(),a.a.createElement(Pe.a,{className:"select-dropdown__arrow",src:"/build/img/svg/icn-arrow-down.svg",cacheGetRequests:!0}))}renderSelectedValue(e){return a.a.createElement("span",{className:"select-dropdown__selected-value"},e.label)}renderPlaceHolder(){return a.a.createElement("span",{className:"select-dropdown__placeholder"},this.props.placeholder)}renderPopover(){return a.a.createElement("div",{id:this.props.dropdownId,className:"select-dropdown__options jq-dropdown-children"},this.renderInput(),this.props.options.map(e=>this.renderOption(e)))}renderOption(e){var t=this.props.selected===e.value,s=""!==e.value&&(""!==this.props.selectedMaximum&&Number(e.value)>=Number(this.props.selectedMaximum)||""!==this.props.selectedMinimum&&Number(e.value)<=Number(this.props.selectedMinimum)),i=Ee.a.build("select-dropdown__option",{selected:t,disabled:s});return a.a.createElement("div",{key:e.value,className:i,onClick:this.handleSelect.bind(this,e,s)},e.label)}renderInput(){if(this.props.inputAvailable)return a.a.createElement("input",{type:"text",value:this.state.inputTextCleaned,className:"select-dropdown__input",onBlur:this.handleBlur,onChange:this.handleChange,onKeyDown:this.handleKeyDown})}}qs.propTypes={onSelect:ve.PropTypes.func.isRequired,dropdownId:ve.PropTypes.string.isRequired,selected:ve.PropTypes.string,selectedMinimum:ve.PropTypes.string,selectedMaximum:ve.PropTypes.string,isDisabled:ve.PropTypes.bool,placeholder:ve.PropTypes.string,inputAvailable:ve.PropTypes.bool,mobileMinimumLabel:ve.PropTypes.string,mobileMaximumLabel:ve.PropTypes.string,options:ve.PropTypes.arrayOf(ve.PropTypes.shape({label:ve.PropTypes.string.isRequired,value:ve.PropTypes.string})).isRequired};var xs=qs;class Ms extends a.a.Component{constructor(e){super(e),this.selectMinimum=this.handleSelectMinimum.bind(this),this.selectMaximum=this.handleSelectMaximum.bind(this)}handleSelectMinimum(e){setTimeout(()=>{this.props.dispatch(dt(e.value));var t="".concat(this.props.searchLotSize.selectedMinimum,"~").concat(this.props.searchLotSize.selectedMaximum);this.props.dispatch(ut(t)),Ue(),window.DropdownChildren("hide")})}handleSelectMaximum(e){setTimeout(()=>{this.props.dispatch(ht(e.value));var t="".concat(this.props.searchLotSize.selectedMinimum,"~").concat(this.props.searchLotSize.selectedMaximum);this.props.dispatch(ut(t)),Ue(),window.DropdownChildren("hide")})}isInFeet(){return"foot"===this.props.searchLotSize.selectedUnit}render(){return a.a.createElement("div",{className:"search-additional-criteria-popover__section search-lot-size"},a.a.createElement("div",{className:"search-additional-criteria-popover__section__title",dangerouslySetInnerHTML:{__html:this.handleTitleBasedOnUnit()}}),a.a.createElement(xs,{dropdownId:"lot-size-minimum-dropdown",placeholder:this.props.searchLotSize.defaultMinimumValue,options:this.handleUnitMinimumOption(),selected:this.props.searchLotSize.selectedMinimum,selectedMaximum:this.props.searchLotSize.selectedMaximum,inputAvailable:!0,onSelect:this.selectMinimum,mobileMinimumLabel:this.props.searchLotSize.mobileMinimumLabel}),a.a.createElement(xs,{dropdownId:"lot-size-maximum-dropdown",placeholder:this.props.searchLotSize.defaultMaximumValue,options:this.handleUnitMaximumOption(),selected:this.props.searchLotSize.selectedMaximum,selectedMinimum:this.props.searchLotSize.selectedMinimum,inputAvailable:!0,onSelect:this.selectMaximum,mobileMaximumLabel:this.props.searchLotSize.mobileMaximumLabel}))}handleUnitMinimumOption(){return this.isInFeet()?this.props.searchLotSize.optionsMinimumFooter:this.props.searchLotSize.optionsMinimumMeter}handleUnitMaximumOption(){return this.isInFeet()?this.props.searchLotSize.optionsMaximumFooter:this.props.searchLotSize.optionsMaximumMeter}handleTitleBasedOnUnit(){var e=this.isInFeet()?this.props.searchLotSize.titleUnit.footer:this.props.searchLotSize.titleUnit.meter;return"".concat(this.props.searchLotSize.title," <span>").concat(e,"</span>")}}var Ds=ve.PropTypes.shape({title:ve.PropTypes.string.isRequired,titleUnit:ve.PropTypes.object.isRequired,optionsMinimumFooter:ve.PropTypes.arrayOf(ve.PropTypes.shape({value:ve.PropTypes.string.isRequired,label:ve.PropTypes.string.isRequired})).isRequired,optionsMinimumMeter:ve.PropTypes.arrayOf(ve.PropTypes.shape({value:ve.PropTypes.string.isRequired,label:ve.PropTypes.string.isRequired})).isRequired,optionsMaximumFooter:ve.PropTypes.arrayOf(ve.PropTypes.shape({value:ve.PropTypes.string.isRequired,label:ve.PropTypes.string.isRequired})).isRequired,optionsMaximumMeter:ve.PropTypes.arrayOf(ve.PropTypes.shape({value:ve.PropTypes.string.isRequired,label:ve.PropTypes.string.isRequired})).isRequired,selectedUnit:ve.PropTypes.string.isRequired,selectedMinimum:ve.PropTypes.string,selectedMaximum:ve.PropTypes.string,defaultMinimumValue:ve.PropTypes.string.isRequired,defaultMaximumValue:ve.PropTypes.string.isRequired});Ms.propTypes={dispatch:ve.PropTypes.func.isRequired,searchLotSize:Ds.isRequired};var As=Ms=Object(u.b)(({searchSelectedLotSize:e,setSearchSelectedLotSizeMinimum:t,setSearchSelectedLotSizeMaximum:s,searchLotSize:i})=>({selectedLotSize:e,setSearchSelectedLotSizeMinimum:t,setSearchSelectedLotSizeMaximum:s,searchLotSize:i}))(Ms);class Is extends a.a.Component{constructor(e){super(e),this.selectMinimum=this.handleSelectMinimum.bind(this),this.selectMaximum=this.handleSelectMaximum.bind(this)}handleSelectMinimum(e){setTimeout(()=>{this.props.dispatch(mt(e.value));var t="".concat(this.props.searchLivingArea.selectedMinimum,"~").concat(this.props.searchLivingArea.selectedMaximum);this.props.dispatch(_t(t)),Ue(),window.DropdownChildren("hide")})}handleSelectMaximum(e){setTimeout(()=>{this.props.dispatch(gt(e.value));var t="".concat(this.props.searchLivingArea.selectedMinimum,"~").concat(this.props.searchLivingArea.selectedMaximum);this.props.dispatch(_t(t)),Ue(),window.DropdownChildren("hide")})}isInFeet(){return"foot"===this.props.searchLivingArea.selectedUnit}render(){return a.a.createElement("div",{className:"search-additional-criteria-popover__section search-living-area"},a.a.createElement("div",{className:"search-additional-criteria-popover__section__title",dangerouslySetInnerHTML:{__html:this.handleTitleBasedOnUnit()}}),a.a.createElement(xs,{dropdownId:"living-area-minimum-dropdown",placeholder:this.props.searchLivingArea.defaultMinimumValue,options:this.handleUnitMinimumOption(),selected:this.props.searchLivingArea.selectedMinimum,selectedMaximum:this.props.searchLivingArea.selectedMaximum,inputAvailable:!0,onSelect:this.selectMinimum,mobileMinimumLabel:this.props.searchLivingArea.mobileMinimumLabel}),a.a.createElement(xs,{dropdownId:"living-area-maximum-dropdown",placeholder:this.props.searchLivingArea.defaultMaximumValue,options:this.handleUnitMaximumOption(),selected:this.props.searchLivingArea.selectedMaximum,selectedMinimum:this.props.searchLivingArea.selectedMinimum,inputAvailable:!0,onSelect:this.selectMaximum,mobileMaximumLabel:this.props.searchLivingArea.mobileMaximumLabel}))}handleUnitMinimumOption(){return this.isInFeet()?this.props.searchLivingArea.optionsMinimumFooter:this.props.searchLivingArea.optionsMinimumMeter}handleUnitMaximumOption(){return this.isInFeet()?this.props.searchLivingArea.optionsMaximumFooter:this.props.searchLivingArea.optionsMaximumMeter}handleTitleBasedOnUnit(){var e=this.isInFeet()?this.props.searchLivingArea.titleUnit.footer:this.props.searchLivingArea.titleUnit.meter;return"".concat(this.props.searchLivingArea.title," <span>").concat(e,"</span>")}}var Bs=ve.PropTypes.shape({title:ve.PropTypes.string.isRequired,titleUnit:ve.PropTypes.object.isRequired,optionsMinimumFooter:ve.PropTypes.arrayOf(ve.PropTypes.shape({value:ve.PropTypes.string.isRequired,label:ve.PropTypes.string.isRequired})).isRequired,optionsMinimumMeter:ve.PropTypes.arrayOf(ve.PropTypes.shape({value:ve.PropTypes.string.isRequired,label:ve.PropTypes.string.isRequired})).isRequired,optionsMaximumFooter:ve.PropTypes.arrayOf(ve.PropTypes.shape({value:ve.PropTypes.string.isRequired,label:ve.PropTypes.string.isRequired})).isRequired,optionsMaximumMeter:ve.PropTypes.arrayOf(ve.PropTypes.shape({value:ve.PropTypes.string.isRequired,label:ve.PropTypes.string.isRequired})).isRequired,selectedUnit:ve.PropTypes.string.isRequired,selectedMinimum:ve.PropTypes.string,selectedMaximum:ve.PropTypes.string,defaultMinimumValue:ve.PropTypes.string.isRequired,defaultMaximumValue:ve.PropTypes.string.isRequired});Is.propTypes={dispatch:ve.PropTypes.func.isRequired,searchLivingArea:Bs.isRequired};var Fs=Is=Object(u.b)(({searchSelectedLivingArea:e,setSearchSelectedLivingAreaMinimum:t,setSearchSelectedLivingAreaMaximum:s,searchLivingArea:i})=>({selectedLivingArea:e,setSearchSelectedLivingAreaMinimum:t,setSearchSelectedLivingAreaMaximum:s,searchLivingArea:i}))(Is);class js extends a.a.Component{constructor(e){super(e),this.state={filterClick:!1,layoutClassName:Object(be.b)()?"mobile":"desktop"},this.windowResize=this.handleWindowResize.bind(this)}componentDidMount(){window.addEventListener("viewport-size-change",this.windowResize)}componentWillUnmount(){window.removeEventListener("viewport-size-change",this.windowResize)}handleWindowResize(){this.setState({layoutClassName:Object(be.b)()?"mobile":"desktop"})}handleButtonClick(){this.props.dispatch(ct("1")),this.props.dispatch(pt()),this.setState({filterClick:!0}),_e.a.pushDynamicEvent("apply-filter-button-click",window.DP.context.pageType)}render(){var e=Ee.a.build("search-additional-criteria-popover",{rental:this.props.searchBar.isRental,sell:!this.props.searchBar.isRental}),t=Ee.a.build("search-additional-criteria-popover__column",{desktop:"desktop"===this.state.layoutClassName,mobile:"mobile"===this.state.layoutClassName});return a.a.createElement("div",{className:e},a.a.createElement("div",{className:"search-additional-criteria-popover__columns"},this.renderFirstColumn(),a.a.createElement("div",{className:"".concat(t," search-additional-criteria-popover__column--last")},a.a.createElement(ss,null),this.props.searchBar.isRental?a.a.createElement(Ss,null):null,a.a.createElement(ns,null),this.renderButton())))}renderButton(){return this.props.searchBar.isRental?null:this.props.searchBar.submitting&&this.state.filterClick?a.a.createElement("button",{className:"search-bar__input-wrapper__button search-bar__input-wrapper__button__filter search-bar__input-wrapper__button--loading"},a.a.createElement(we.a,null)):this.props.searchBar.enabled?a.a.createElement("button",{className:"search-bar__input-wrapper__button search-bar__input-wrapper__button__filter",onClick:this.handleButtonClick.bind(this)},this.props.searchBar.filter):a.a.createElement("button",{className:"search-bar__input-wrapper__button search-bar__input-wrapper__button__filter search-bar__input-wrapper__button--inactive"},this.props.searchBar.filter)}renderFirstColumn(){return"desktop"===this.state.layoutClassName&&this.renderDesktopFirstColumn()||this.renderMobileFirstColumn()}renderMobileFirstColumn(){return a.a.createElement("div",{className:"search-additional-criteria-popover__column search-additional-criteria-popover__column--mobile search-additional-criteria-popover__column--first"},this.props.searchBar.isRental?null:a.a.createElement(vs,null),a.a.createElement(gs,null),this.renderMobileLivingAreaDropdown(),this.renderMobileLotSizeDropdown(),this.props.searchBar.isRental?null:a.a.createElement(Ss,null),this.props.disabledFields.includes("land_area")?null:a.a.createElement(ks,null))}renderMobileLotSizeDropdown(){return this.props.disabledFields.includes("land_area")||this.props.searchBar.isRental?null:a.a.createElement("div",{className:"search-additional-criteria-popover__section"},a.a.createElement("div",{className:"select-dropdown"},a.a.createElement("div",{className:"select-dropdown__label","data-jq-dropdown":"#".concat("lot-size-dropdown")},a.a.createElement("span",{className:"select-dropdown__placeholder",dangerouslySetInnerHTML:{__html:this.handleTitleBasedOnUnit(this.props.lotSizeLabel)}}),a.a.createElement(Pe.a,{className:"select-dropdown__arrow",src:"/build/img/svg/icn-arrow-down.svg",cacheGetRequests:!0})),a.a.createElement("div",{id:"lot-size-dropdown",className:"select-dropdown__options jq-dropdown"},a.a.createElement(As,null))))}renderMobileLivingAreaDropdown(){return this.props.searchBar.isRental?null:a.a.createElement("div",{className:"search-additional-criteria-popover__section"},a.a.createElement("div",{className:"select-dropdown"},a.a.createElement("div",{className:"select-dropdown__label","data-jq-dropdown":"#".concat("living-area-dropdown")},a.a.createElement("span",{className:"select-dropdown__placeholder",dangerouslySetInnerHTML:{__html:this.handleTitleBasedOnUnit(this.props.livingAreaLabel)}}),a.a.createElement(Pe.a,{className:"select-dropdown__arrow",src:"/build/img/svg/icn-arrow-down.svg",cacheGetRequests:!0})),a.a.createElement("div",{id:"living-area-dropdown",className:"select-dropdown__options jq-dropdown"},a.a.createElement(Fs,null))))}renderDesktopFirstColumn(){return a.a.createElement("div",{className:"search-additional-criteria-popover__column search-additional-criteria-popover__column--desktop search-additional-criteria-popover__column--first"},a.a.createElement(gs,null),this.props.searchBar.isRental?null:a.a.createElement(vs,null),this.props.searchBar.isRental?null:a.a.createElement(Fs,null),this.props.disabledFields.includes("land_area")?null:a.a.createElement(As,null),this.props.searchBar.isRental?null:a.a.createElement(Ss,null),this.props.disabledFields.includes("land_area")?null:a.a.createElement(ks,null))}handleTitleBasedOnUnit(e){var t="foot"===this.props.selectedUnit?this.props.titleUnit.footer:this.props.titleUnit.meter;return"".concat(e,"&nbsp;<span>").concat(t,"</span>")}}js.propTypes={disabledFields:ve.PropTypes.array.isRequired,lotSizeLabel:ve.PropTypes.string.isRequired,selectedUnit:ve.PropTypes.string.isRequired,titleUnit:ve.PropTypes.object.isRequired,livingAreaLabel:ve.PropTypes.string.isRequired,dispatch:ve.PropTypes.func.isRequired,searchBar:ve.PropTypes.shape({submitting:ve.PropTypes.boolean,enabled:ve.PropTypes.boolean,filter:ve.PropTypes.string.isRequired,isRental:ve.PropTypes.boolean}).isRequired};var Vs=js=Object(u.b)(({searchBar:e})=>({searchBar:e}))(js);class Us extends a.a.Component{constructor(e){super(e),this.state={showPopover:(!Object(be.b)()||!this.props.searchBar.isRental)&&Object(be.b)()},this.gtmClassName=this.fetchGtmClassName()}handleTogglePopover(){Object(be.b)()?this.props.searchBar.isRental?this.setState({showPopover:!this.state.showPopover}):this.setState({showPopover:!0}):this.setState({showPopover:!this.state.showPopover})}handleWindowResize(){window.innerWidth<=window.DP.breakpoints.regular&&!this.props.searchBar.isRental&&this.setState({showPopover:!0})}fetchGtmClassName(){return Object(be.b)()?"gtm-search-link-more-criterias-mob":"gtm-search-link-more-criterias"}render(){var e=Ee.a.build("search-additional-criteria",{rental:this.props.searchBar.isRental});return a.a.createElement("div",{className:e},this.renderButton(),this.renderPopover())}renderButton(){var e=Ee.a.build("search-bar__options-button",{"additional-criteria":!0,active:this.state.showPopover}),t=Ee.a.build("search-bar__options-button__arrow",{active:this.state.showPopover}),s="search-bar__options-button__label search-bar__options-button__label--additional-criteria ".concat(this.props.moreCriteriaPush);return t="".concat(t," is-no-events ").concat(this.props.moreCriteriaPush),a.a.createElement("button",{onClick:this.handleTogglePopover.bind(this),className:"".concat(e," ").concat(this.gtmClassName)},a.a.createElement("span",{className:s},this.props.searchAdditionalCriteria.title),a.a.createElement(Pe.a,{className:t,src:"/build/img/svg/icn-arrow-down.svg",cacheGetRequests:!0}))}renderPopover(){return this.state.showPopover?a.a.createElement(St,{onOuterClick:this.handleTogglePopover.bind(this)},a.a.createElement("div",{ref:"root"},a.a.createElement(Vs,{title:this.props.searchAdditionalCriteria.title,disabledFields:this.props.disabledFields,lotSizeLabel:this.props.lotSizeLabel,selectedUnit:this.props.selectedUnit,titleUnit:this.props.titleUnit,livingAreaLabel:this.props.livingAreaLabel}))):null}}Us.propTypes={moreCriteriaPush:ve.PropTypes.string,disabledFields:ve.PropTypes.array.isRequired,lotSizeLabel:ve.PropTypes.string.isRequired,selectedUnit:ve.PropTypes.string.isRequired,titleUnit:ve.PropTypes.object.isRequired,livingAreaLabel:ve.PropTypes.string.isRequired,searchAdditionalCriteria:ve.PropTypes.shape({title:ve.PropTypes.string.isRequired,smallTitle:ve.PropTypes.string.isRequired}).isRequired,searchBar:ve.PropTypes.shape({isRental:ve.PropTypes.boolean}).isRequired};var Hs=Us=Object(u.b)(({searchAdditionalCriteria:e,searchBar:t})=>({searchAdditionalCriteria:e,searchBar:t}))(Us);class $s extends a.a.Component{handleReset(){confirm(this.props.searchBar.resetConfirmAlert)?(this.props.dispatch(dt("")),this.props.dispatch(ht("")),this.props.dispatch(mt("")),this.props.dispatch(gt("")),this.props.dispatch({type:"RESET_SEARCH_BAR"}),Ue(),this.handleGtmPushOnClick(),this.props.onHandleButtonClick()):this.handleGtmPushOnClick()}handleGtmPushOnClick(){"purplebricks"===window.DP.theme&&Oe()&&_e.a.pushDynamicEvent("header-reset-button-mobile","".concat(window.DP.context.pageType,"_Mobile"))}render(){return a.a.createElement("button",{className:"search-bar__button search-bar__reset-button",onClick:this.handleReset.bind(this)},this.props.searchBar.resetButton)}}$s.propTypes={onHandleButtonClick:ve.PropTypes.func.isRequired,dispatch:ve.PropTypes.func.isRequired,searchBar:ve.PropTypes.shape({resetButton:ve.PropTypes.string.isRequired,resetConfirmAlert:ve.PropTypes.string.isRequired}).isRequired};var Gs=$s=Object(u.b)(({searchBar:e})=>({searchBar:e}))($s);class zs extends a.a.Component{constructor(e){super(e);var t=window.DP.store.getState(),s=He(t,$e(!1,t));delete s.position,delete s.zoom,this.activeCriteria=JSON.stringify(s)}handleApplyChanges(){this.props.onHandleButtonClick()}isModifiedCriteria(){var e=window.DP.store.getState(),t=He(e,$e(!1,e));delete t.position,delete t.zoom;var s=JSON.stringify(t);return this.activeCriteria!==s&&(window.location.pathname.indexOf("search")>-1||window.location.pathname.indexOf("recherche")>-1)}render(){var e="modified_criteria";return this.isModifiedCriteria()&&!this.props.searchClick||(e+=" modified_criteria--hidden"),a.a.createElement("div",{className:e},this.props.searchBar.searchModifiedCriteria.oneOrMoreCriteriaChange,a.a.createElement("button",{className:"search-bar__input-wrapper__button",onClick:this.handleApplyChanges.bind(this)},this.props.searchBar.searchModifiedCriteria.applyChanges))}}zs.propTypes={searchClick:ve.PropTypes.bool.isRequired,onHandleButtonClick:ve.PropTypes.func.isRequired,dispatch:ve.PropTypes.func.isRequired,searchBar:ve.PropTypes.shape({resetButton:ve.PropTypes.string.isRequired,resetConfirmAlert:ve.PropTypes.string.isRequired,searchModifiedCriteria:ve.PropTypes.shape({oneOrMoreCriteriaChange:ve.PropTypes.string.isRequired,applyChanges:ve.PropTypes.string.isRequired}).isRequired}).isRequired};var Ws=zs=Object(u.b)(({searchBar:e})=>({searchBar:e}))(zs);class Ks extends a.a.Component{handleToggle(){this.props.searchBar.tagsCollapsed?this.props.dispatch({type:"EXPAND_TAGS"}):this.props.dispatch({type:"COLLAPSE_TAGS"})}displayContentBasedOnContext(){return"tags"===this.props.context?this.displayTagButtonContent():this.displayLeftButtonContent()}displayTagButtonContent(){return a.a.createElement("div",null,a.a.createElement("div",{className:"search-bar__button-show-extra-tags__name"},"..."),a.a.createElement("div",{className:"search-bar__button-show-extra-tags__remove-button"},a.a.createElement(Pe.a,{src:"/build/img/svg/icn-arrow-down.svg",cacheGetRequests:!0})))}displayLeftButtonContent(){var e=Ee.a.build("search-bar__button-show-extra-tags__arrow",{active:!this.props.searchBar.tagsCollapsed});return a.a.createElement(Pe.a,{className:e,src:"/build/img/svg/icn-arrow-down.svg",cacheGetRequests:!0})}render(){if(this.props.totalTagsCount<=xe())return null;var e=Ee.a.build("search-bar__button-show-extra-tags",{left:"left"===this.props.context,tags:"tags"===this.props.context});return a.a.createElement("button",{className:e,onClick:this.handleToggle.bind(this)},this.displayContentBasedOnContext())}}Ks.propTypes={totalTagsCount:ve.PropTypes.number,context:ve.PropTypes.string,dispatch:ve.PropTypes.func.isRequired,searchBar:ve.PropTypes.shape({tagsCollapsed:ve.PropTypes.boolean}).isRequired};var Ys=Ks=Object(u.b)(({searchBar:e})=>({searchBar:e}))(Ks),Xs=(e,t)=>{for(var s,i,a,r,n,o,l=e.replace(/</g,"\n<").replace(/>/g,">\n").replace(/\n\n/g,"\n").replace(/^\n/g,"").replace(/\n$/g,"").split("\n"),c=[],p=0,d=!1,h=0;h<l.length;h++)if(s=(i=l[h]).replace(/[ ]+/g," "),i.length){if("<"!==i[0])if(p>=t)i="";else if(p+s.length>=t){if(" "===i[(a=t-p)-1])for(;a&&" "===i[(a-=1)-1];);else-1!==(r=i.substring(a).split("").indexOf(" "))?a+=r:a=i.length;i="".concat(i.substring(0,a),"â€¦"),p=t,d=!0}else p+=s.length;else if(p>=t)if(o=(n=i.match(/[a-zA-Z]+/))?n[0]:"")if("</"!==i.substring(0,2))c.push(o),i="";else{for(;c[c.length-1]!==o&&c.length;)c.pop();c.length&&(i=""),c.pop()}else i="";l[h]=i}return{html:l.join("\n").replace(/\n/g,""),more:d}},Zs=e=>e.replace(/<\/?[^>]+(>|$)/g,""),Js=e=>{var t="";if("fr"===document.getElementsByTagName("html")[0].getAttribute("lang")){var s=e.toString().split(",");t="".concat(s[0],"<sup>").concat(s[1],"$</sup>")}else{var i=e.toString().split(".");t="$".concat(i[0],"<sup>").concat(i[1],"</sup>")}return t};class Qs extends a.a.Component{handleTermDelete(e){setTimeout(()=>{this.props.dispatch(ze(e)),this.props.dispatch({type:"ENABLE_SEARCH"}),Ue()})}render(){var{term:e}=this.props,t=this.props.extraClassNames?this.props.extraClassNames:[],s=["search-terms-item"].concat(t);return a.a.createElement("div",{className:s.join(" ")},a.a.createElement("div",{className:"search-terms-item__name"},Zs(e.name)),a.a.createElement("div",{className:"search-terms-item__remove-button",onClick:this.handleTermDelete.bind(this,e)},"Ã—"))}}Qs.propTypes={term:ve.PropTypes.object.isRequired,extraClassNames:ve.PropTypes.array,dispatch:ve.PropTypes.func.isRequired};var ei=Qs=Object(u.b)()(Qs);class ti extends a.a.Component{handleRoomCountDelete(){setTimeout(()=>{this.props.dispatch(Ke("0")),Ue()})}render(){var{searchRooms:e}=this.props;if("0"===e.selected)return null;var t=this.props.extraClassNames?this.props.extraClassNames:[],s=["search-terms-item"].concat(t),i=e.options.find(t=>t.value===e.selected),r="1~1"!==i.value?e.title:e.titleSingle;return a.a.createElement("div",{className:s.join(" ")},a.a.createElement("div",{className:"search-terms-item__name"},i.label," ",r.toLowerCase()),a.a.createElement("div",{className:"search-terms-item__remove-button",onClick:this.handleRoomCountDelete.bind(this)},"Ã—"))}}ti.propTypes={searchRooms:ve.PropTypes.object,extraClassNames:ve.PropTypes.array,dispatch:ve.PropTypes.func.isRequired};var si=ti=Object(u.b)(({searchRooms:e})=>({searchRooms:e}))(ti);class ii extends a.a.Component{handleTypeDelete(e){this.props.searchSubTypes&&setTimeout(()=>{this.props.searchSubTypes.selected.map(t=>t.typeId===e?this.props.dispatch(st(t)):null),this.props.dispatch(Qe(e)),Ue()})}render(){var{searchSubTypes:e,optionType:t}=this.props,s=jt(e.options,t.id);if(jt(e.selected,t.id)!==s)return null;var i=this.props.extraClassNames?this.props.extraClassNames:[],r=["search-terms-item"].concat(i);return a.a.createElement("div",{className:r.join(" ")},a.a.createElement("div",{className:"search-terms-item__name"},t.name),a.a.createElement("div",{className:"search-terms-item__remove-button",onClick:this.handleTypeDelete.bind(this,t.id)},"Ã—"))}}ii.propTypes={searchSubTypes:ve.PropTypes.object,optionType:ve.PropTypes.object,extraClassNames:ve.PropTypes.array,dispatch:ve.PropTypes.func.isRequired};var ai=ii=Object(u.b)(({searchSubTypes:e})=>({searchSubTypes:e}))(ii);class ri extends a.a.Component{handleSubTypeDelete(e){setTimeout(()=>{this.props.dispatch(st(e)),this.props.dispatch(tt(e.typeId)),Ue()})}render(){var{searchSubTypes:e,selectedSubType:t}=this.props,s=jt(e.options,t.typeId),i=jt(e.selected,t.typeId);if(0!==i&&i===s)return null;var r=this.props.extraClassNames?this.props.extraClassNames:[],n=["search-terms-item"].concat(r);return a.a.createElement("div",{className:n.join(" ")},a.a.createElement("div",{className:"search-terms-item__name"},t.name),a.a.createElement("div",{className:"search-terms-item__remove-button",onClick:this.handleSubTypeDelete.bind(this,t)},"Ã—"))}}ri.propTypes={searchSubTypes:ve.PropTypes.object,selectedSubType:ve.PropTypes.object,extraClassNames:ve.PropTypes.array,dispatch:ve.PropTypes.func.isRequired};var ni=ri=Object(u.b)(({searchSubTypes:e})=>({searchSubTypes:e}))(ri);class oi extends a.a.Component{handlePriceRangeReset(){setTimeout(()=>{this.props.dispatch(Ze(null)),this.props.dispatch(Je(null)),Ue()})}buildPriceRangeString(e){var t=null===e.selected[0]?"".concat(e.minimumToggleLabel," ").concat(e.noMinimumLabel):d.a.encodeCurrencyValue(e.selected[0].value,{noDecimal:!0});return t+=" â€” ",t+=null===e.selected[1]?e.maximumToggleLabel:d.a.encodeCurrencyValue(e.selected[1].value,{noDecimal:!0})}render(){var{searchPriceRange:e}=this.props;if(!e.selected[0]&&!e.selected[1])return null;var t=this.props.extraClassNames?this.props.extraClassNames:[],s=["search-terms-item"].concat(t);return a.a.createElement("div",{className:s.join(" ")},a.a.createElement("div",{className:"search-terms-item__name"},this.buildPriceRangeString(e)),a.a.createElement("div",{className:"search-terms-item__remove-button",onClick:this.handlePriceRangeReset.bind(this)},"Ã—"))}}oi.propTypes={searchPriceRange:ve.PropTypes.object,extraClassNames:ve.PropTypes.array,dispatch:ve.PropTypes.func.isRequired};var li=oi=Object(u.b)(({searchPriceRange:e})=>({searchPriceRange:e}))(oi);class ci extends a.a.Component{handleTypeDelete(e){setTimeout(()=>{this.props.dispatch(nt(e)),Ue()})}render(){var{searchOptions:e}=this.props,t=e.options.find(e=>e.id===this.props.selectedOption);if(!e.selected.length||"0"===t.id)return null;var s=this.props.extraClassNames?this.props.extraClassNames:[],i=["search-terms-item"].concat(s);return a.a.createElement("div",{className:i.join(" ")},a.a.createElement("div",{className:"search-terms-item__name"},t.name),a.a.createElement("div",{className:"search-terms-item__remove-button",onClick:this.handleTypeDelete.bind(this,t.id)},"Ã—"))}}ci.propTypes={searchOptions:ve.PropTypes.object,selectedOption:ve.PropTypes.string,extraClassNames:ve.PropTypes.array,dispatch:ve.PropTypes.func.isRequired};var pi=ci=Object(u.b)(({searchOptions:e})=>({searchOptions:e}))(ci);class di extends a.a.Component{handleLotSizeReset(){setTimeout(()=>{this.props.dispatch(dt("")),this.props.dispatch(ht("")),this.props.dispatch(ut("~")),Ue()})}renderLotSize(){var{searchLotSize:e}=this.props,t=e.label.tag,s=e.label.minimumOf,i=e.label.maximumOf,a="",r="",n=e.optionsMinimumMeter,o=e.optionsMaximumMeter,l=e.meterTitle;"foot"===e.selectedUnit&&(n=e.optionsMinimumFooter,o=e.optionsMaximumFooter,l=e.footTitle);var c=this.renderMinimumSelection(n),p=this.renderMaximumSelection(o);return c!==p&&(r=p===o[0].label?"".concat(s," ").concat(c):c===n[0].label?"".concat(i," ").concat(p):"".concat(c," - ").concat(p),a="".concat(r," ").concat(l," ").concat(t)),a}renderMinimumSelection(e){var{searchLotSize:t}=this.props;return t.selectedMinimum!==t.selectedMaximum&&""!==t.selectedMinimum&&void 0!==t.selectedMinimum&&"undefined"!==t.selectedMinimum?d.a.formatNumbers(t.selectedMinimum):e[0].label}renderMaximumSelection(e){var{searchLotSize:t}=this.props;return t.selectedMaximum!==t.selectedMinimum&&""!==t.selectedMaximum&&void 0!==t.selectedMaximum&&"undefined"!==t.selectedMaximum?d.a.formatNumbers(t.selectedMaximum):e[0].label}render(){var{searchLotSize:e}=this.props;if("~"===e.selected)return null;var t=this.props.extraClassNames?this.props.extraClassNames:[],s=["search-terms-item"].concat(t);return a.a.createElement("div",{className:s.join(" ")},a.a.createElement("div",{className:"search-terms-item__name"},this.renderLotSize()),a.a.createElement("div",{className:"search-terms-item__remove-button",onClick:this.handleLotSizeReset.bind(this)},"Ã—"))}}di.propTypes={searchLotSize:ve.PropTypes.object,extraClassNames:ve.PropTypes.array,dispatch:ve.PropTypes.func.isRequired};var hi=di=Object(u.b)(({searchLotSize:e})=>({searchLotSize:e}))(di);class ui extends a.a.Component{handleLivingAreaReset(){setTimeout(()=>{this.props.dispatch(mt("")),this.props.dispatch(gt("")),this.props.dispatch(_t("~")),Ue()})}renderLivingArea(){var{searchLivingArea:e}=this.props,t=e.label.tag,s=e.label.minimumOf,i=e.label.maximumOf,a="",r="",n=e.optionsMinimumMeter,o=e.optionsMaximumMeter,l=e.meterTitle;"foot"===e.selectedUnit&&(n=e.optionsMinimumFooter,o=e.optionsMaximumFooter,l=e.footTitle);var c=this.renderMinimumSelection(n),p=this.renderMaximumSelection(o);return c!==p&&(r=p===o[0].label?"".concat(s," ").concat(c):c===n[0].label?"".concat(i," ").concat(p):"".concat(c," - ").concat(p),a="".concat(r," ").concat(l," ").concat(t)),a}renderMinimumSelection(e){var{searchLivingArea:t}=this.props;return t.selectedMinimum!==t.selectedMaximum&&""!==t.selectedMinimum&&void 0!==t.selectedMinimum&&"undefined"!==t.selectedMinimum?d.a.formatNumbers(t.selectedMinimum):e[0].label}renderMaximumSelection(e){var{searchLivingArea:t}=this.props;return t.selectedMaximum!==t.selectedMinimum&&""!==t.selectedMaximum&&void 0!==t.selectedMaximum&&"undefined"!==t.selectedMaximum?d.a.formatNumbers(t.selectedMaximum):e[0].label}render(){var{searchLivingArea:e}=this.props;if("~"===e.selected)return null;var t=this.props.extraClassNames?this.props.extraClassNames:[],s=["search-terms-item"].concat(t);return a.a.createElement("div",{className:s.join(" ")},a.a.createElement("div",{className:"search-terms-item__name"},this.renderLivingArea()),a.a.createElement("div",{className:"search-terms-item__remove-button",onClick:this.handleLivingAreaReset.bind(this)},"Ã—"))}}ui.propTypes={searchLivingArea:ve.PropTypes.object,extraClassNames:ve.PropTypes.array,dispatch:ve.PropTypes.func.isRequired};var mi=ui=Object(u.b)(({searchLivingArea:e})=>({searchLivingArea:e}))(ui);class gi extends a.a.Component{handleRoomCountDelete(){setTimeout(()=>{this.props.dispatch(Ye("0")),Ue()})}render(){var{searchBathrooms:e}=this.props;if("0"===e.selected)return null;var t=this.props.extraClassNames?this.props.extraClassNames:[],s=e.options.find(t=>t.value===e.selected),i=["search-terms-item"].concat(t),r="1~1"!==s.value?e.title:e.titleSingle;return a.a.createElement("div",{className:i.join(" ")},a.a.createElement("div",{className:"search-terms-item__name"},s.label," ",r.toLowerCase()),a.a.createElement("div",{className:"search-terms-item__remove-button",onClick:this.handleRoomCountDelete.bind(this)},"Ã—"))}}gi.propTypes={searchBathrooms:ve.PropTypes.object,extraClassNames:ve.PropTypes.array,dispatch:ve.PropTypes.func.isRequired};var _i=gi=Object(u.b)(({searchBathrooms:e})=>({searchBathrooms:e}))(gi);class bi extends a.a.Component{handleRoomCountDelete(){setTimeout(()=>{this.props.dispatch(Xe(0)),Ue()})}render(){var{searchOnlineSince:e}=this.props;if(0===e.selected)return null;var t=e.options.find(t=>t.value===e.selected),s=this.props.extraClassNames?this.props.extraClassNames:[],i=["search-terms-item"].concat(s);return a.a.createElement("div",{className:i.join(" ")},a.a.createElement("div",{className:"search-terms-item__name"},e.title," ",t.label),a.a.createElement("div",{className:"search-terms-item__remove-button",onClick:this.handleRoomCountDelete.bind(this)},"Ã—"))}}bi.propTypes={searchOnlineSince:ve.PropTypes.object,extraClassNames:ve.PropTypes.array,dispatch:ve.PropTypes.func.isRequired};var vi=bi=Object(u.b)(({searchOnlineSince:e})=>({searchOnlineSince:e}))(bi);class yi extends a.a.Component{handleFiltersReset(){setTimeout(()=>{this.props.dispatch(ot(qe())),Ue()})}render(){var{searchFilters:e}=this.props;if("is_builder"===e.selected&&"qc"===window.DP.province||e.selected===qe())return null;var t=e.options.find(t=>t.id===e.selected);if(void 0===t)return null;var s=this.props.extraClassNames?this.props.extraClassNames:[],i=["search-terms-item"].concat(s);return a.a.createElement("div",{className:i.join(" ")},a.a.createElement("div",{className:"search-terms-item__name"},t.name),a.a.createElement("div",{className:"search-terms-item__remove-button",onClick:this.handleFiltersReset.bind(this)},"Ã—"))}}yi.propTypes={searchFilters:ve.PropTypes.object,extraClassNames:ve.PropTypes.array,dispatch:ve.PropTypes.func.isRequired};var Ti=yi=Object(u.b)(({searchFilters:e})=>({searchFilters:e}))(yi);class fi extends a.a.Component{handleTypeDelete(e){setTimeout(()=>{this.props.dispatch(lt(e)),Ue()})}render(){var e="purplebricks"===window.DP.theme,{searchFlags:t}=this.props,s=[...t.options];e&&(s=t.options.filter(e=>"with_builders"!==e.id));var i=s.filter(e=>e.id!==this.props.selectedOption);0===i.length&&(i=s);var r=s.find(e=>e.id===i[0].id),n=this.props.extraClassNames?this.props.extraClassNames:[],o=["search-terms-item"].concat(n);return a.a.createElement("div",{className:o.join(" ")},a.a.createElement("div",{className:"search-terms-item__name"},r.nameWithoutText),a.a.createElement("div",{className:"search-terms-item__remove-button",onClick:this.handleTypeDelete.bind(this,r.id)},"Ã—"))}}fi.propTypes={searchFlags:ve.PropTypes.object,selectedOption:ve.PropTypes.string,extraClassNames:ve.PropTypes.array,dispatch:ve.PropTypes.func.isRequired};var Pi=fi=Object(u.b)(({searchFlags:e})=>({searchFlags:e}))(fi);class Ei extends a.a.Component{render(){var e,t,s="purplebricks"===window.DP.theme,i=Ee.a.build("search-bar__tags",{active:!this.props.searchBar.tagsCollapsed});this.visibleTags=1,s?(e=this.props.searchFlags.selected.filter(e=>"with_builders"!==e),t=this.props.searchFlags.defaultValue.filter(e=>"with_builders"!==e)):(e=this.props.searchFlags.selected,t=this.props.searchFlags.defaultValue);var r=e.map(e=>this.renderFlags(e));return 0===r.length&&(r=t.map(e=>this.renderFlags(e))),a.a.createElement("div",{className:i},this.props.searchTerms.map(this.renderTerm.bind(this)),this.props.searchTypes.options.map(e=>this.renderType(e)),this.props.searchSubTypes.selected.map(e=>this.renderSubType(e)),this.renderNumberOfRooms(),this.renderPriceRange(),this.props.searchOptions.selected.map(e=>this.renderOptions(e)),this.renderLivingArea(),this.renderLotSize(),this.renderBathrooms(),this.renderOnlineSince(),this.renderFilters(),r,this.renderShowExtraTags())}renderTerm(e){if(!(this.props.searchBar.tagsCollapsed&&this.visibleTags>xe()))return++this.visibleTags,a.a.createElement(ei,{key:"searchTermsItem:".concat(e.uniqueId),term:e})}renderType(e){var{searchSubTypes:t}=this.props;if(this.props.searchBar.tagsCollapsed){var s=jt(t.options,e.id);if(jt(t.selected,e.id)!==s||this.visibleTags>xe())return}return++this.visibleTags,a.a.createElement(ai,{key:"searchTypesPopoverOption:".concat(e.id),optionType:e,searchSubTypes:t})}renderSubType(e){if(this.props.searchBar.tagsCollapsed){var{searchSubTypes:t}=this.props,s=jt(t.options,e.typeId),i=jt(t.selected,e.typeId);if(0!==i&&i===s||this.visibleTags>xe())return}return++this.visibleTags,a.a.createElement(ni,{key:"searchSubTypesPopoverOption:".concat(e.typeId).concat(e.id),selectedSubType:e})}renderFlags(e){var t,s,{searchFlags:i}=this.props;if("purplebricks"===window.DP.theme?(t=i.selected.filter(e=>"with_builders"!==e),s=i.defaultValue.filter(e=>"with_builders"!==e)):(t=i.selected,s=i.defaultValue),!(t.length===s.length||this.visibleTags>xe()))return++this.visibleTags,a.a.createElement(Pi,{key:"flagsOption:".concat(e),selectedOption:e})}renderOptions(e){if(this.props.searchBar.tagsCollapsed){var{searchOptions:t}=this.props,s=t.options.find(t=>t.id===e);if(!t.selected.length||0===s.id||this.visibleTags>xe())return}return++this.visibleTags,a.a.createElement(pi,{key:"characteristicsOption:".concat(e),selectedOption:e})}renderNumberOfRooms(){if(!this.props.searchBar.tagsCollapsed||!("0"===this.props.searchRooms.selected||this.visibleTags>xe()))return++this.visibleTags,a.a.createElement(si,null)}renderPriceRange(){if(!this.props.searchBar.tagsCollapsed||!(!this.props.searchPriceRange.selected[0]&&!this.props.searchPriceRange.selected[1]||this.visibleTags>xe()))return++this.visibleTags,a.a.createElement(li,null)}renderLotSize(){if(!this.props.searchBar.tagsCollapsed||!("~"===this.props.searchLotSize.selected||this.visibleTags>xe()))return++this.visibleTags,a.a.createElement(hi,null)}renderLivingArea(){if(!this.props.searchBar.tagsCollapsed||!("~"===this.props.searchLivingArea.selected||this.visibleTags>xe()))return++this.visibleTags,a.a.createElement(mi,null)}renderBathrooms(){if(!this.props.searchBar.tagsCollapsed||!("0"===this.props.searchBathrooms.selected||this.visibleTags>xe()))return++this.visibleTags,a.a.createElement(_i,null)}renderOnlineSince(){if(!this.props.searchBar.tagsCollapsed||!(0===this.props.searchOnlineSince.selected||this.visibleTags>xe()))return++this.visibleTags,a.a.createElement(vi,null)}renderFilters(){if(!this.props.searchBar.tagsCollapsed||!(this.props.searchFilters.selected===qe()||this.visibleTags>xe()))return++this.visibleTags,a.a.createElement(Ti,null)}renderShowExtraTags(){return a.a.createElement(Ys,{context:"tags",totalTagsCount:this.props.totalTagsCount})}}Ei.propTypes={dispatch:ve.PropTypes.func.isRequired,searchBar:ve.PropTypes.shape({tagsCollapsed:ve.PropTypes.boolean}).isRequired,searchTerms:ve.PropTypes.array.isRequired,searchRooms:ve.PropTypes.object,searchTypes:ve.PropTypes.object,searchSubTypes:ve.PropTypes.object,searchPriceRange:ve.PropTypes.object,searchOptions:ve.PropTypes.object,searchLandArea:ve.PropTypes.object,searchBathrooms:ve.PropTypes.object,searchOnlineSince:ve.PropTypes.object,searchFilters:ve.PropTypes.object,searchFlags:ve.PropTypes.object,totalTagsCount:ve.PropTypes.number,searchLotSize:ve.PropTypes.object,searchLivingArea:ve.PropTypes.object};var wi=Ei=Object(u.b)(({searchBar:e,searchTerms:t,searchRooms:s,searchTypes:i,searchSubTypes:a,searchPriceRange:r,searchOptions:n,searchLandArea:o,searchBathrooms:l,searchOnlineSince:c,searchFilters:p,searchFlags:d,searchLotSize:h,searchLivingArea:u})=>({searchBar:e,searchTerms:t,searchRooms:s,searchTypes:i,searchSubTypes:a,searchPriceRange:r,searchOptions:n,searchLandArea:o,searchBathrooms:l,searchOnlineSince:c,searchFilters:p,searchFlags:d,searchLotSize:h,searchLivingArea:u}))(Ei);class Ci extends a.a.Component{render(){if(!window.DP.configSwitch.SearchBarTabs)return null;var e=this.props.items,t=[];for(var s in e)t.push(this.renderItem(e[s]));return a.a.createElement("nav",{className:"header-searchbar-nav__list-container"},a.a.createElement("ul",{className:"header-searchbar-nav__list"},t))}renderItem(e){var t=Ee.a.build("header-searchbar-nav__item",{highlighted:e.active});return a.a.createElement("li",{className:t,key:e.key},a.a.createElement("a",{href:e.url,className:"header-searchbar-nav__link",onClick:this.triggerGtmPush.bind(this,e.key)},e.label))}triggerGtmPush(e){_e.a.pushToDataLayer("gtm-event","Search_Navigation","Inventory_Tab",this.renderGTMEventLabel(e))}renderGTMEventLabel(e){var t="";switch(e){case"newly_built":t="NewHomes";break;case"for_rent":t="Rental";break;default:case"for_sale":t="Resale"}return t}}Ci.propTypes={items:ve.PropTypes.arrayOf(ve.PropTypes.shape({key:ve.PropTypes.string.isRequired,label:ve.PropTypes.string.isRequired,url:ve.PropTypes.string.isRequired,active:ve.PropTypes.bool.isRequired})).isRequired};var Si=Ci;class Ri extends a.a.Component{render(){return a.a.createElement("div",{className:"warning-message-bar"},a.a.createElement("div",{className:"warning-message-bar__text"},a.a.createElement(Pe.a,{src:"/build/img/svg/icn-warning.svg",cacheGetRequests:!0}),this.props.message))}}Ri.propTypes={message:ve.PropTypes.string.isRequired};var Ni=Ri;class ki extends a.a.Component{constructor(e){super(e),this.state={searchTermsTotalCount:0,searchClick:!1}}componentDidMount(){this.calculateTotalSearchTerms(),this.openIntroFirstLoad(),_e.a.registerElements()}componentDidUpdate(){this.calculateTotalSearchTerms()}calculateTotalSearchTerms(){var e=Bt(this.props);e!==this.state.searchTermsTotalCount&&this.setState({searchTermsTotalCount:e})}openIntroFirstLoad(){return"qc"===window.DP.province?null:(l.a.setBucket("firstimer_intro"),l.a.get("_has_been_shown")?null:!(this.state.searchTermsTotalCount&&!l.a.get("_has_been_shown"))||(l.a.setBucket("firstimer_intro"),l.a.set("_has_been_shown",!0),!1))}handleButtonClick(){this.props.dispatch(ct("1")),this.props.dispatch(pt()),this.setState({searchClick:!0})}handleButtonClose(){p()(".mobile-menu").removeClass("mobile-menu--active"),p()(".mobile-header__item").removeClass("mobile-header__item--active"),p()("#chat-widget-container").show()}fetchGtmClassName(){return p()(".mobile-header").is(":visible")?"search-bar__input-wrapper__button gtm-header-mobile-link-search-bar-button":"search-bar__input-wrapper__button gtm-header-link-search-bar-button"}selectedFilters(){return void 0!==this.props.searchFilters.options.find(e=>e.id===this.props.searchFilters.selected)}render(){var e=Ee.a.build("search-bar__input-wrapper__background",{"visible-tags":this.state.searchTermsTotalCount}),t=Ee.a.build("search-bar",{"tabs-visible":window.DP.configSwitch.SearchBarTabs});return a.a.createElement("div",{className:t},a.a.createElement(Si,{items:this.props.searchBar.headerNav.items}),this.renderHeader(),this.renderIntro(),!this.props.warningMessageBar.showWarningMessage||a.a.createElement(Ni,{message:this.props.geoWarningMessage}),a.a.createElement("div",{className:"search-bar__input-wrapper"},a.a.createElement("div",{className:"search-bar__input-wrapper__fields"},a.a.createElement(wt,{location:"SearchBar",onSubmit:this.handleButtonClick.bind(this),nearMeTermLabel:this.props.searchBar.nearMeTermLabel,locale:this.props.searchBar.locale,nearMePush:this.props.searchBarPushEvents.nearMe,locationText:this.props.searchBar.locationText}),a.a.createElement("div",{className:"search-bar__input-wrapper__separator"},"Â "),a.a.createElement("div",{className:"search-bar__input-wrapper__item"},a.a.createElement(Mt,{provider:"searchBar"})),a.a.createElement("div",{className:"search-bar__input-wrapper__item"},a.a.createElement(Qt,null)),this.renderRooms(),a.a.createElement("div",{className:"search-bar__input-wrapper__item"},a.a.createElement(Hs,{moreCriteriaPush:this.props.searchBarPushEvents.moreCriteria,disabledFields:this.props.searchBar.disabledFields,lotSizeLabel:this.props.searchLotSize.title,selectedUnit:this.props.searchLandArea.selectedUnit,titleUnit:this.props.searchLotSize.titleUnit,livingAreaLabel:this.props.searchLivingArea.title})),this.renderButton(),a.a.createElement("div",{className:e},"Â "),this.renderTags()),a.a.createElement("div",{className:"search-bar__input-wrapper__actions"},a.a.createElement(Gs,{onHandleButtonClick:this.handleButtonClick.bind(this)}),this.renderButton())),a.a.createElement(Ws,{onHandleButtonClick:this.handleButtonClick.bind(this),searchClick:this.state.searchClick}))}renderHeader(){return a.a.createElement("div",{className:"search-bar__header-mobile"},a.a.createElement("span",{className:"search-bar__header-mobile-title"},this.props.searchBar.headerTitle),a.a.createElement("div",{onClick:this.handleButtonClose.bind(this),className:"search-bar__header-mobile-close"},a.a.createElement(Pe.a,{className:"search-bar__header-mobile-close-icon",src:"/build/img/svg/icn-close.svg",cacheGetRequests:!0})))}renderRooms(){return this.props.searchBar.disabledFields.includes("rooms")?null:a.a.createElement("div",{className:"search-bar__input-wrapper__item"},a.a.createElement(Lt,null))}renderTags(){var e=Ee.a.build("search-bar__input-wrapper__tags",{hidden:!this.state.searchTermsTotalCount||1===this.state.searchTermsTotalCount&&!this.selectedFilters()});return a.a.createElement("div",{className:e,ref:"searchTerms"},a.a.createElement("div",{className:"search-bar__input-wrapper__tags-leftside"},a.a.createElement("span",{className:"search-bar__input-wrapper__tags-label"},this.props.searchBar.labelTags),a.a.createElement(Ys,{context:"left",totalTagsCount:this.state.searchTermsTotalCount})),a.a.createElement(wi,{totalTagsCount:this.state.searchTermsTotalCount}),a.a.createElement(Gs,{onHandleButtonClick:this.handleButtonClick.bind(this)}))}renderIntro(){return this.openIntroFirstLoad()?a.a.createElement("div",{className:"search-bar__first-timer-intro"},a.a.createElement("h4",{className:"search-bar__first-timer-intro-title"},this.props.searchBar.firstTimerIntro),a.a.createElement(Pe.a,{className:"search-bar__first-timer-intro-arrow",src:"/build/img/svg/icn-arrow-long-down.svg",cacheGetRequests:!0})):null}renderButton(){var e=this.fetchGtmClassName();return e="".concat(e," ").concat(this.props.searchBarPushEvents.findHomeButton),this.props.searchBar.submitting&&this.state.searchClick?a.a.createElement("button",{className:"search-bar__input-wrapper__button search-bar__input-wrapper__button--loading ".concat(this.props.searchBarPushEvents.findHomeButton)},a.a.createElement(we.a,null)):this.props.searchBar.enabled?a.a.createElement("button",{onClick:this.handleButtonClick.bind(this),className:e},this.props.searchBar.button):a.a.createElement("button",{className:"search-bar__input-wrapper__button search-bar__input-wrapper__button--inactive"},this.props.searchBar.button)}}ki.propTypes={dispatch:ve.PropTypes.func.isRequired,searchBarPushEvents:ve.PropTypes.object,searchBar:ve.PropTypes.shape({firstTimerIntro:ve.PropTypes.string.isRequired,button:ve.PropTypes.string.isRequired,submitting:ve.PropTypes.boolean,enabled:ve.PropTypes.boolean,searchModifiedCriteria:ve.PropTypes.object.isRequired,tagsCollapsed:ve.PropTypes.boolean,nearMeTermLabel:ve.PropTypes.string.isRequired,disabledFields:ve.PropTypes.array.isRequired,locale:ve.PropTypes.string.isRequired,labelTags:ve.PropTypes.string.isRequired,headerNav:ve.PropTypes.object.isRequired,headerTitle:ve.PropTypes.string.isRequired,locationText:ve.PropTypes.string.isRequired}).isRequired,searchRooms:ve.PropTypes.object,searchTerms:ve.PropTypes.array,searchTypes:ve.PropTypes.object,searchSubTypes:ve.PropTypes.object,searchPriceRange:ve.PropTypes.object,searchOptions:ve.PropTypes.object,searchLandArea:ve.PropTypes.object,searchBathrooms:ve.PropTypes.object,searchOnlineSince:ve.PropTypes.object,searchFilters:ve.PropTypes.object,searchFlags:ve.PropTypes.object,searchLotSize:ve.PropTypes.object,searchLivingArea:ve.PropTypes.object,geoWarningMessage:ve.PropTypes.string.isRequired,warningMessageBar:ve.PropTypes.shape({showWarningMessage:ve.PropTypes.bool})};var Li=ki=Object(u.b)(({searchBarPushEvents:e,searchBar:t,searchRooms:s,searchTypes:i,searchSubTypes:a,searchPriceRange:r,searchOptions:n,searchLandArea:o,searchBathrooms:l,searchOnlineSince:c,searchFilters:p,searchTerms:d,searchFlags:h,searchLotSize:u,searchLivingArea:m,warningMessageBar:g})=>({searchBarPushEvents:e,searchBar:t,searchRooms:s,searchTypes:i,searchSubTypes:a,searchPriceRange:r,searchOptions:n,searchLandArea:o,searchBathrooms:l,searchOnlineSince:c,searchFilters:p,searchTerms:d,searchFlags:h,searchLotSize:u,searchLivingArea:m,warningMessageBar:g}))(ki),Oi=m.createProviderWrappedComponent(e=>a.a.createElement(Li,e));class qi extends a.a.Component{constructor(e){super(e);var t=e.items.find(e=>e.active),s=parseInt(t.value,10);this.previousLink=s-1,this.nextLink=s+1}handlePageChange(e){this.props.onPageChange(e)}render(){return this.props.items.length?a.a.createElement("nav",{className:"pagination"},this.renderPreviousLink(),a.a.createElement("ul",{className:"pagination__list"},this.renderPageNumbers(this.props.items)),this.renderNextLink()):null}urlForPage(e){return e>1?"?pageNumber=".concat(e):window.location.pathname}renderPageNumbers(e){if(window.innerWidth<=768){var t=e.findIndex(e=>e.active),s=e.length-1;return e.map((e,i)=>{if(e.id>=8&&i>=t-1&&i<=t+1||e.id<8&&i>=t-5&&i<=t+2||0===i||i===s||"gap"===e.type)return this.renderItem(e)})}return e.map(e=>this.renderItem(e))}renderItem(e){return a.a.createElement(xi,{key:"pagination:item:".concat(e.id),onClick:this.props.useHref?void 0:this.handlePageChange.bind(this,e.value),href:this.props.useHref?this.urlForPage(e.value):void 0,item:e,pageNumbersGtmClass:this.props.pageNumbersGtmClass})}renderPreviousLink(){var e=Ee.a.build("pagination__arrow",{left:!0,disabled:!this.props.previousLinkActive}),t=a.a.createElement(Pe.a,{className:"pagination__icon--left is-no-events",src:"/build/img/svg/icn-arrow-small-left.svg",cacheGetRequests:!0});return this.props.previousLinkActive?a.a.createElement("div",{className:e},a.a.createElement("a",{onClick:this.props.useHref?void 0:this.handlePageChange.bind(this,this.previousLink),href:this.props.useHref?this.urlForPage(this.previousLink):void 0,className:this.props.previousGtmClass},t,a.a.createElement("span",{className:"pagination__icon-label is-no-events"},this.props.prevLabel))):a.a.createElement("div",{className:e},t)}renderNextLink(){var e=Ee.a.build("pagination__arrow",{right:!0,disabled:!this.props.nextLinkActive}),t=a.a.createElement(Pe.a,{className:"pagination__icon--right is-no-events",src:"/build/img/svg/icn-arrow-small-right.svg",cacheGetRequests:!0});return this.props.nextLinkActive?a.a.createElement("div",{className:e},a.a.createElement("a",{onClick:this.props.useHref?void 0:this.handlePageChange.bind(this,this.nextLink),href:this.props.useHref?this.urlForPage(this.nextLink):void 0,className:this.props.nextGtmClass},a.a.createElement("span",{className:"pagination__icon-label is-no-events"},this.props.nextLabel),t)):a.a.createElement("div",{className:e},t)}}var xi=({item:e,onClick:t,href:s,pageNumbersGtmClass:i})=>{var r=Ee.a.build("pagination__item",{active:e.active,gap:"gap"===e.type});return"gap"===e.type?a.a.createElement("li",{className:r},a.a.createElement("span",null,e.value)):a.a.createElement("li",{className:r},a.a.createElement("a",{onClick:t,href:s,className:i},e.value))};xi.propTypes={onClick:ve.PropTypes.func,href:ve.PropTypes.string,item:ve.PropTypes.shape({type:ve.PropTypes.string.isRequired,id:ve.PropTypes.string,value:ve.PropTypes.string,active:ve.PropTypes.bool}).isRequired,pageNumbersGtmClass:ve.PropTypes.string},qi.propTypes={onPageChange:ve.PropTypes.func.isRequired,previousLinkActive:ve.PropTypes.bool.isRequired,nextLinkActive:ve.PropTypes.bool.isRequired,useHref:ve.PropTypes.bool.isRequired,prevLabel:ve.PropTypes.string,nextLabel:ve.PropTypes.string,pageNumbersGtmClass:ve.PropTypes.string,previousGtmClass:ve.PropTypes.string,nextGtmClass:ve.PropTypes.string,items:ve.PropTypes.array.isRequired};var Mi=qi;class Di extends a.a.Component{handlePageChange(e){this.props.dispatch(ct(e.toString())),this.props.dispatch(pt())}render(){return a.a.createElement(Mi,{items:this.props.items,nextLinkActive:this.props.nextLinkActive,previousLinkActive:this.props.previousLinkActive,prevLabel:this.props.prevLabel,nextLabel:this.props.nextLabel,useHref:this.props.useHref,onPageChange:this.handlePageChange.bind(this),pageNumbersGtmClass:this.props.pageNumbersGtmClass,previousGtmClass:this.props.previousGtmClass,nextGtmClass:this.props.nextGtmClass})}}Di.propTypes={dispatch:ve.PropTypes.func.isRequired,previousLinkActive:ve.PropTypes.bool.isRequired,nextLinkActive:ve.PropTypes.bool.isRequired,prevLabel:ve.PropTypes.string.isRequired,nextLabel:ve.PropTypes.string.isRequired,items:ve.PropTypes.array.isRequired,useHref:ve.PropTypes.bool.isRequired,currentPageNumber:ve.PropTypes.string,pageNumbersGtmClass:ve.PropTypes.string,previousGtmClass:ve.PropTypes.string,nextGtmClass:ve.PropTypes.string},Di=Object(u.b)(({searchPagination:e})=>{var{currentPageNumber:t}=e;return{currentPageNumber:t}})(Di);var Ai=m.createProviderWrappedComponent(e=>a.a.createElement(Di,e)),Ii=e=>{var t=(e=>{var t=(({testimonialsPagination:e})=>{if(null!==e.currentPageNumber&&1!==e.currentPageNumber)return e.currentPageNumber})(e),s=(({testimonialsRegion:e})=>e.regionId)(e);return Le({pageNumber:t,regionId:s})})(e),s=p.a.param(t);window.location="".concat(window.DP.urls.testimonials,"?").concat(s)},Bi=e=>({type:"SET_TESTIMONIALS_PAGINATION_CURRENT_PAGE_NUMBER",pageNumber:e}),Fi=()=>(Ii(window.DP.store.getState()),{type:"SUBMIT_TESTIMONIALS"});class ji extends a.a.Component{handlePageChange(e){this.props.dispatch(Bi(e.toString())),this.props.dispatch(Fi())}render(){return a.a.createElement(Mi,{items:this.props.items,nextLinkActive:this.props.nextLinkActive,previousLinkActive:this.props.previousLinkActive,onPageChange:this.handlePageChange.bind(this)})}}ji.propTypes={dispatch:ve.PropTypes.func.isRequired,previousLinkActive:ve.PropTypes.bool.isRequired,nextLinkActive:ve.PropTypes.bool.isRequired,items:ve.PropTypes.array.isRequired,currentPageNumber:ve.PropTypes.string},ji=Object(u.b)(({testimonialsPagination:e})=>{var{currentPageNumber:t}=e;return{currentPageNumber:t}})(ji);var Vi=m.createProviderWrappedComponent(e=>a.a.createElement(ji,e)),Ui=s(52),Hi=s.n(Ui);class $i extends a.a.Component{render(){var e=Ee.a.build("photo-viewer__slide",{"brokerage-sold":this.props.isPurplebricksSold,"3D_showcase":"3D showcase"===this.props.photo.type});return a.a.createElement("div",{className:e,onClick:this.props.onSlideClick},this.renderBrokerageSold(),this.render3DShowcase(),this.renderImageTag(this.props.photo))}renderImageTag(e){var t="".concat(this.props.baseUrl).concat(e.formats[this.props.photoLarge]),s="".concat(this.props.baseUrl).concat(e.formats[this.props.photoHighRes]," ").concat(this.props.photoHighRes,"w,\n                             ").concat(this.props.baseUrl).concat(e.formats[this.props.photoLarge]," ").concat(this.props.photoLarge,"w,\n                             ").concat(this.props.baseUrl).concat(e.formats[this.props.photoBig]," ").concat(this.props.photoBig,"w\n                             ");return a.a.createElement("div",{className:"photo-viewer__slide__image-container"},a.a.createElement("img",{alt:this.setPhotosAlternativeText(e),className:"photo-viewer__image","data-srcset":s,"data-lazy":t,"data-sizes":this.props.primaryPhotoSizes}))}render3DShowcase(){return"3D showcase"!==this.props.photo.type?null:a.a.createElement("div",{className:"photo-viewer__3dshowcase-container"},a.a.createElement(Pe.a,{className:"photo-viewer__caption-button--showcase-3d-play-icon",src:"/build/img/svg/icn-play-button.svg",cacheGetRequests:!0}),a.a.createElement("p",{className:"photo-viewer__3dshowcase-container-text"}," ",this.props.showcase3DVisit))}renderBrokerageSold(){return this.props.isPurplebricksSold?a.a.createElement("div",{className:"photo-viewer__sold-container"},a.a.createElement("div",{className:"photo-viewer__sold"},this.props.iSoldLabel)):null}setPhotosAlternativeText(){var e=this.props.photo.alternative_text;return this.props.photo.type&&this.props.photo.description&&!this.props.isSold&&(e="".concat(this.props.photo.type," - ").concat(this.props.photo.description)),e}}$i.propTypes={photo:ve.PropTypes.object.isRequired,baseUrl:ve.PropTypes.string.isRequired,onSlideClick:ve.PropTypes.func.isRequired,isPurplebricksSold:ve.PropTypes.bool.isRequired,iSoldLabel:ve.PropTypes.string.isRequired,isSold:ve.PropTypes.bool,showcase3DVisit:ve.PropTypes.string.isRequired,photoHighRes:ve.PropTypes.number.isRequired,photoLarge:ve.PropTypes.number.isRequired,photoBig:ve.PropTypes.number.isRequired,primaryPhotoSizes:ve.PropTypes.string.isRequired};var Gi=$i,zi=()=>window.devicePixelRatio>1||window.matchMedia&&window.matchMedia("(-webkit-min-device-pixel-ratio: 1.5),(-moz-min-device-pixel-ratio: 1.5),(min-device-pixel-ratio: 1.5)").matches,Wi=()=>zi()?600:320,Ki=()=>window.innerWidth<=window.DP.breakpoints.medium&&!zi()?1024:1600,Yi={accessibility:!1,arrows:!1,lazyLoad:"ondemand",centerMode:!0,centerPadding:0,slidesToShow:1,speed:200,zIndex:1};class Xi extends a.a.Component{constructor(e){super(e),this.state={showModal:!1},this.photoSize=Ki()}componentDidMount(){this.photosElement=p()(this.refs.photos),this.modalElement=p()(this.refs.modal),this.$showcase3DButtonElement=p()(".".concat("photo-viewer")).find(".".concat("photo-viewer-3d-showcase__button"))}componentDidUpdate(e,{showModal:t}){!1===t&&!0===this.state.showModal&&(this.photosElement.is(".".concat("slick-initialized"))?(this.photosElement.slick("setPosition"),this.photosElement.slick("slickGoTo",this.props.activePhoto.index,!0)):this.initializeSlider())}handleOpenButtonClick(){this.setState({showModal:!0})}handleCloseButtonClick(){this.setState({showModal:!1})}handleNextButtonClick(){this.photosElement.slick("slickNext")}handlePreviousButtonClick(){this.photosElement.slick("slickPrev")}handleKeyUp(e){this.state.showModal&&(37===e.keyCode&&this.photosElement.slick("slickPrev"),39===e.keyCode&&this.photosElement.slick("slickNext"))}handle3DShowcaseClick(e){e.stopPropagation(),this.$showcase3DButtonElement.trigger("click")}renderTitleSeparator(e){return e.type&&e.description?a.a.createElement("span",{className:"photo-viewer-fullscreen__photo-separator"},"/"):null}renderSinglePhoto(e,t){return a.a.createElement("div",{key:"photoViewer:photo:".concat(t),className:"photo-viewer-fullscreen__photo"},this.render3DShowcase(e),this.renderPhoto(e))}render3DShowcase(e){var t="3D showcase"===e.type,s=Ee.a.build("photo-viewer-fullscreen__photo-image",{"3d-showcase":t});return t?a.a.createElement("div",{className:"photo-viewer-fullscreen__photo-wrapper"},a.a.createElement("img",{"data-lazy":"".concat(this.props.photoBaseUrl).concat(e.formats[this.photoSize]),className:s,alt:this.setPhotosAlternativeText(e)}),a.a.createElement("div",{className:"photo-viewer__3dshowcase-container photo-viewer-fullscreen__photo-image",onClick:this.handle3DShowcaseClick.bind(this)},a.a.createElement(Pe.a,{className:"photo-viewer__caption-button--showcase-3d-play-icon",src:"/build/img/svg/icn-play-button.svg",cacheGetRequests:!0}),a.a.createElement("p",{className:"photo-viewer__3dshowcase-container-text"}," ",this.props.showcase3DVisit))):null}renderPhoto(e){return"3D showcase"===e.type?null:a.a.createElement("div",{className:"photo-viewer-fullscreen__photo-wrapper"},this.renderImageTag(e),a.a.createElement("div",{className:"photo-viewer-fullscreen__photo-info "},a.a.createElement("span",{className:"photo-viewer-fullscreen__photo-type"},e.type),this.renderTitleSeparator(e),a.a.createElement("span",{className:"photo-viewer-fullscreen__photo-description"},e.description)))}renderImageTag(e){var t="".concat(this.props.photoBaseUrl).concat(e.formats[this.photoSize]),s="".concat(this.props.photoBaseUrl).concat(e.formats[1600]," 1600w,\n                             ").concat(this.props.photoBaseUrl).concat(e.formats[1024]," 1024w,\n                             ").concat(this.props.photoBaseUrl).concat(e.formats[600]," 600w\n                             ");return a.a.createElement("div",{className:"photo-viewer__slide__image-container"},a.a.createElement("img",{alt:this.setPhotosAlternativeText(e),className:"photo-viewer-fullscreen__photo-image","data-srcset":s,"data-lazy":t}))}setPhotosAlternativeText(e){var t=e.alternative_text;return e.type&&e.description&&!this.props.isSold&&(t="".concat(e.type," - ").concat(e.description)),t}render(){var e=Ee.a.build("photo-viewer-fullscreen__modal",{visible:this.state.showModal});return a.a.createElement("div",{className:"photo-viewer-fullscreen"},a.a.createElement("div",{className:"photo-viewer-fullscreen__button",onClick:this.handleOpenButtonClick.bind(this)},a.a.createElement(Pe.a,{className:"photo-viewer-fullscreen__button__icon",src:"/build/img/svg/icn-fullscreen.svg",cacheGetRequests:!0})),a.a.createElement("div",{className:e,ref:"modal"},a.a.createElement("div",{onClick:this.handleCloseButtonClick.bind(this)},a.a.createElement(Pe.a,{className:"photo-viewer-fullscreen__modal-close-button",src:"/build/img/svg/icn-close.svg",cacheGetRequests:!0})),a.a.createElement("div",{className:"photo-viewer-fullscreen__viewport"},a.a.createElement(Zi,{photoCount:this.props.photos.length,onPreviousButtonClick:this.handlePreviousButtonClick.bind(this),onNextButtonClick:this.handleNextButtonClick.bind(this)}),a.a.createElement("div",{className:"photo-viewer-fullscreen__viewport__photos",ref:"photos"},Array.from(this.props.photos).map((e,t)=>this.renderSinglePhoto(e,t))))))}initializeSlider(){window.$window.on("keyup.PhotoViewerFullscreen",this.handleKeyUp.bind(this));var e=Object.assign({},Yi,{initialSlide:this.props.activePhoto.index});Hi()(this.photosElement,e)}}var Zi=({photoCount:e,onPreviousButtonClick:t,onNextButtonClick:s})=>1===e?null:a.a.createElement("div",{className:"photo-viewer-fullscreen__viewport__navigation"},a.a.createElement("div",{onClick:t,className:"photo-viewer-fullscreen__viewport__navigation-button photo-viewer-fullscreen__viewport__navigation-button--prev"},a.a.createElement(Pe.a,{className:"photo-viewer-fullscreen__viewport__navigation-button__icon",src:"/build/img/svg/icn-arrow-small-left.svg",cacheGetRequests:!0})),a.a.createElement("div",{onClick:s,className:"photo-viewer-fullscreen__viewport__navigation-button photo-viewer-fullscreen__viewport__navigation-button--next"},a.a.createElement(Pe.a,{className:"photo-viewer-fullscreen__viewport__navigation-button__icon",src:"/build/img/svg/icn-arrow-small-right.svg",cacheGetRequests:!0})));Xi.propTypes={photos:ve.PropTypes.array.isRequired,activePhoto:ve.PropTypes.object.isRequired,photoBaseUrl:ve.PropTypes.string.isRequired,has3DShowcase:ve.PropTypes.bool,showcaseUrl:ve.PropTypes.string,listingCode:ve.PropTypes.string.isRequired,isSold:ve.PropTypes.bool,showcase3DVisit:ve.PropTypes.string.isRequired},Zi.propTypes={photoCount:ve.PropTypes.number.isRequired,onPreviousButtonClick:ve.PropTypes.func.isRequired,onNextButtonClick:ve.PropTypes.func.isRequired};var Ji=Xi,Qi=e=>'<krpano version="'.concat(1.19,'" onstart="loadscene(scene0);">\n        <include url="/build/vendor/krpano/skin/sphere.xml?nocache=%$random%" if="isSphere === true" />\n        <include url="/build/vendor/krpano/skin/cylinder.xml?nocache=%$random%" if="isSphere === false" />\n        <skin_settings webvr="').concat(e,'" title="').concat(!0,'" thumbs="').concat(!0,'" thumbs_width="').concat(100,'" thumbs_height="').concat(40,'" thumbs_padding="').concat(10,'" thumbs_crop="').concat("",'" />'),ea=(e,t,s,i)=>{var a=' <view hlookat="'.concat("0.0",'" vlookat="').concat("0.0",'" fovtype="').concat("HFOV",'" fov="').concat("110",'" fovmin="').concat("70",'" fovmax="').concat("140",'" limitview="').concat("range",'" />');return i&&(a='<view hlookat="'.concat("0.0",'" vlookat="').concat("0.0",'" fovtype="').concat("HFOV",'" fov="').concat("110",'" fovmin="').concat("70",'" fovmax="').concat("140",'" hlookatmin="').concat("-180",'" hlookatmax="').concat("+180",'" vlookatmin="').concat("-70",'" vlookatmax="').concat("+70",'" limitview="').concat("range",'" />')),'<scene name="scene'.concat(t,'" title="').concat(e[t].title,'" thumburl="').concat(s).concat(e[t].thumb,'" heading="').concat(0,'">\n    ').concat(a,'\n    <preview url="').concat(s).concat(e[t].thumb,'" />')},ta=()=>"</scene>",sa=(e,t,s)=>"<image><".concat(e,' url="').concat(s).concat(t,'" /></image>'),ia=()=>'<security cors="'.concat("",'"><crossdomainxml url="').concat("/crossdomain.xml",'" />\n    <allowdomain domain="').concat("duproprio.com",'" /></security></krpano>'),aa=(e,t,s)=>{var i=Qi(t);for(var a of Object.keys(e))i+=ea(e,a,s,t),i+=sa(e[a].type,e[a].photo,s),i+=ta();return i+=ia()};class ra extends a.a.Component{constructor(e){super(e),this.isSphere=e.panorama.some(e=>"sphere"===e.type),this.state={showModal:!1}}handleOpenClick(){var e,t,s;window.embedpano((e=this.props.panorama,t=this.isSphere,s=this.props.photoBaseUrl,{swf:"".concat("/build/vendor/krpano/","krpano.swf"),target:"panorama",xml:"",basepath:"/build/vendor/krpano/",html5:"prefer+webgl",initvars:{isSphere:t},mobilescale:1,passQueryParameters:!0,vars:{onstart:"loadxml(".concat(aa(e,t,s),")")}})),this.setState({showModal:!0})}handleCloseClick(){this.setState({showModal:!1}),this.refs.viewer.innerHTML=""}render(){var e=Ee.a.build("photo-viewer-panorama-modal",{visible:this.state.showModal}),t=Ee.a.build("photo-viewer-panorama-content",{sphere:this.isSphere});return a.a.createElement("div",{className:"photo-viewer-panorama"},a.a.createElement("div",{onClick:this.handleOpenClick.bind(this),className:"photo-viewer-panorama__button"}),a.a.createElement("div",{className:e},a.a.createElement("div",{className:t},a.a.createElement("div",{className:"photo-viewer-panorama-content__header"},a.a.createElement("div",{onClick:this.handleCloseClick.bind(this)},a.a.createElement(Pe.a,{className:"photo-viewer-panorama-modal__close-button",src:"/build/img/svg/icn-close.svg",cacheGetRequests:!0}))),a.a.createElement("div",{className:"photo-viewer-panorama-content__viewer",id:"panorama",ref:"viewer"}))))}}ra.propTypes={panorama:ve.PropTypes.array,photoBaseUrl:ve.PropTypes.string.isRequired};var na=ra,oa=(e,t)=>{var s=(e=>Se()(window.DP.urls.proxyStats,e))(e),i={type:t};return p.a.ajax({method:"POST",url:s,data:i,beforeSend:e=>{e.setRequestHeader("X-CSRF-TOKEN",p()('meta[name="csrf-token"]').attr("content"))}})};class la extends a.a.Component{constructor(e){super(e),this.state={showModal:!1}}handleOpenClick(){this.setState({showModal:!0}),oa(this.props.listingCode,"click_3d_virtual_tour")}handleCloseClick(){this.setState({showModal:!1})}renderMatterportIframe(){return this.state.showModal?a.a.createElement("iframe",{className:"photo-viewer-3d-showcase-content__viewer matterportIframe_vrmfu2",width:"853",height:"480",src:this.props.showcaseUrl,frameBorder:"0",allowFullScreen:!0}):null}renderLogoSVG(){return"qc"===window.DP.province?a.a.createElement("div",{className:"photo-viewer-3d-showcase-modal__logo-dp"},a.a.createElement(Pe.a,{className:"photo-viewer-3d-showcase-modal__logo-dp-home",src:"/build/img/svg/logo-home.svg",cacheGetRequests:!0}),a.a.createElement(Pe.a,{className:"photo-viewer-3d-showcase-modal__logo-dp-text",src:"/build/img/svg/logo-duproprio-text.svg",cacheGetRequests:!0})):a.a.createElement("div",{className:"photo-viewer-3d-showcase-modal__logo-pb"},a.a.createElement(Pe.a,{className:"photo-viewer-3d-showcase-modal__logo-pb-home",src:"/build/img/svg/purplebricks/logo-purplebricks.svg",cacheGetRequests:!0}))}render(){var e=Ee.a.build("photo-viewer-3d-showcase-modal",{visible:this.state.showModal});return a.a.createElement("div",{className:"photo-viewer-3d-showcase"},a.a.createElement("div",{onClick:this.handleOpenClick.bind(this),className:"photo-viewer-3d-showcase__button"}),a.a.createElement("div",{className:e},a.a.createElement("div",{className:"photo-viewer-3d-showcase-content"},a.a.createElement("div",{className:"photo-viewer-3d-showcase-content__header"},this.renderLogoSVG(),a.a.createElement("div",{className:"photo-viewer-3d-showcase-modal__close-button-container",onClick:this.handleCloseClick.bind(this)},a.a.createElement(Pe.a,{className:"photo-viewer-3d-showcase-modal__close-button",src:"/build/img/svg/icn-close.svg",cacheGetRequests:!0}))),this.renderMatterportIframe())))}}la.propTypes={showcaseUrl:ve.PropTypes.string.isRequired,listingCode:ve.PropTypes.string.isRequired};var ca=la,pa=/TEXTAREA|INPUT|SELECT/,da={accessibility:!1,arrows:!1,centerMode:!0,centerPadding:0,focusOnSelect:!0,responsive:[{breakpoint:4e3,settings:{lazyLoad:"ondemand"}},{breakpoint:window.DP.breakpoints.regular,settings:{variableWidth:!1}}],slidesToShow:1,variableWidth:!0,speed:200,zIndex:1};class ha extends a.a.Component{constructor(e){super(e);var t=e.photos.map((e,t)=>Object.assign({},e,{index:t}));this.photoCount=t.length,this.hasSinglePhoto=1===this.photoCount,this.hasPanorama=e.panorama&&e.panorama.length>0,this.isFixedHeightListing=e.fixedHeightListing,this.photos=1===t.length?t:t.concat(t),this.state={activePhoto:this.photos[0],fullScreenTriggered:!1}}componentDidMount(){this.$photosElement=p()(this.refs.photos),this.$fullscreenButtonElement=p()(this.refs.root).find(".".concat("photo-viewer-fullscreen__button")),this.$panoramaButtonElement=p()(this.refs.root).find(".".concat("photo-viewer-panorama__button")),this.$showcase3DButtonElement=p()(this.refs.root).find(".".concat("photo-viewer-3d-showcase__button")),this.$photosElement.on("afterChange",this.handleSliderAfterChange.bind(this)),this.$photosElement.on("lazyLoaded",this.handleSlideLazyLoaded.bind(this)),this.$photosElement.on("swipe",this.handleSwipe.bind(this)),Hi()(this.$photosElement,da),window.$window.on("keyup.PhotoViewer",this.handleKeyUp.bind(this))}componentWillUnmount(){window.$window.off("keyup.PhotoViewer")}handleNextButtonClick(){this.state.fullScreenTriggered&&this.setState({fullScreenTriggered:!1}),this.$photosElement.slick("slickNext")}handlePreviousButtonClick(){this.state.fullScreenTriggered&&this.setState({fullScreenTriggered:!1}),this.$photosElement.slick("slickPrev")}handleSwipe(){this.setState({fullScreenTriggered:!1})}handleSliderAfterChange(e,t,s){var i=this.photos[s];this.setState({activePhoto:i},(function(){this.state.fullScreenTriggered&&this.$fullscreenButtonElement.trigger("click")}))}handleSlideLazyLoaded(){this.$photosElement.slick("setPosition")}handleKeyUp(e){e.target.tagName.match(pa)||(37===e.keyCode&&this.$photosElement.slick("slickPrev"),39===e.keyCode&&this.$photosElement.slick("slickNext"))}handlePhotoClick(){this.props.isPurplebricksSold||("3D showcase"===this.state.activePhoto.type?this.$showcase3DButtonElement.trigger("click"):this.shouldClickTriggerFullScreen()?this.$fullscreenButtonElement.trigger("click"):this.setState({fullScreenTriggered:!1}))}handleFullscreenClick(e){e.stopPropagation(),this.$fullscreenButtonElement.trigger("click")}handlePanoramaClick(e){_e.a.pushDynamicEvent("listing-photosection-360panorama","Listing"),e.stopPropagation(),this.$panoramaButtonElement.trigger("click")}handle3DShowcaseClick(e){e.stopPropagation(),this.$showcase3DButtonElement.trigger("click")}render(){if(!this.state.activePhoto)return null;var e=Ee.a.build("photo-viewer__viewport__slides",{single:this.hasSinglePhoto}),t=Ee.a.build("photo-viewer",{fixedHeight:this.isFixedHeightListing});return a.a.createElement("div",{className:t,ref:"root"},a.a.createElement("div",{className:"photo-viewer__viewport"},a.a.createElement(ma,{photoCount:this.photoCount,onPreviousButtonClick:this.handlePreviousButtonClick.bind(this),onNextButtonClick:this.handleNextButtonClick.bind(this)}),a.a.createElement("div",{className:e,ref:"photos"},Array.from(this.photos).map(this.renderSlide.bind(this)))),this.renderViewerCaption(),this.renderFullscreenViewer(),this.renderPanoramaViewer(),this.render3DShowcaseViewer())}renderSlide(e,t){return a.a.createElement(Gi,{key:"photoViewer:slide:".concat(t),photo:e,onSlideClick:this.handlePhotoClick.bind(this),baseUrl:this.props.photoBaseUrl,isPurplebricksSold:this.props.isPurplebricksSold,iSoldLabel:this.props.iSoldLabel,showcase3DVisit:this.props.showcase3DVisit,isSold:this.props.isSold,photoHighRes:this.props.photoHighRes,photoLarge:this.props.photoLarge,photoBig:this.props.photoBig,primaryPhotoSizes:this.props.primaryPhotoSizes})}renderFullscreenViewer(){return a.a.createElement(Ji,{photos:this.photos,activePhoto:this.state.activePhoto,photoBaseUrl:this.props.photoBaseUrl,has3DShowcase:this.props.has3DShowcase,showcaseUrl:this.props.showcaseUrl,listingCode:this.props.listingCode,isSold:this.props.isSold,showcase3DVisit:this.props.showcase3DVisit})}renderPanoramaViewer(){return this.hasPanorama?a.a.createElement(na,{panorama:this.props.panorama,photoBaseUrl:this.props.photoBaseUrl}):null}render3DShowcaseViewer(){return this.props.has3DShowcase?a.a.createElement(ca,{showcaseUrl:this.props.showcaseUrl,listingCode:this.props.listingCode}):null}shouldClickTriggerFullScreen(){var e=this.$photosElement.slick("slickCurrentSlide");return e>this.photoCount-1&&(e-=this.photoCount),this.state.activePhoto.index===e}renderViewerCaption(){return a.a.createElement("div",{className:"photo-viewer__caption"},a.a.createElement("div",{className:"photo-viewer__caption-informations"},a.a.createElement(ua,{photoCount:this.photoCount,onPreviousButtonClick:this.handlePreviousButtonClick.bind(this),onNextButtonClick:this.handleNextButtonClick.bind(this)}),a.a.createElement("div",{className:"photo-viewer__caption-texts"},this.renderPhotoCount(),this.renderType(),this.renderSeparator(),this.renderDescription()),a.a.createElement("div",{className:"photo-viewer__caption-buttons"},this.renderPanoramaButton(),this.render3DShowcaseButton(),this.renderFullscreenButton())))}renderPhotoCount(){if(1===this.photoCount)return null;var e=this.state.activePhoto.index+1;return a.a.createElement("div",{className:"photo-viewer__caption-count"},e," / ",this.photoCount)}renderType(){return""===this.state.activePhoto?null:"3D showcase"===this.state.activePhoto.type?a.a.createElement("div",{className:"photo-viewer__caption-type"},this.state.activePhoto.alternative_text):a.a.createElement("div",{className:"photo-viewer__caption-type"},this.state.activePhoto.type)}renderSeparator(){return""===this.state.activePhoto.type||""===this.state.activePhoto.description?null:a.a.createElement("div",{className:"photo-viewer__caption-separator"},"â€“")}renderDescription(){return a.a.createElement("div",{className:"photo-viewer__caption-description"},this.state.activePhoto.description)}renderFullscreenButton(){return this.props.isPurplebricksSold?null:a.a.createElement("div",{className:"photo-viewer__caption-button photo-viewer__caption-button--fullscreen",onClick:this.handleFullscreenClick.bind(this)},a.a.createElement(Pe.a,{className:"photo-viewer__caption-button--fullscreen-icon",src:"/build/img/svg/icn-fullscreen.svg",cacheGetRequests:!0}))}renderPanoramaButton(){return this.hasPanorama?a.a.createElement("div",{className:"photo-viewer__caption-button photo-viewer__caption-button--panorama gtm-listing-panorama-button",onClick:this.handlePanoramaClick.bind(this)},a.a.createElement("div",{className:"photo-viewer__caption-button_label hidden-xlarge"},this.props.panorama360ShortLabel),a.a.createElement("div",{className:"photo-viewer__caption-button_label hidden-small hidden-medium hidden-regular hidden-large"},this.props.panorama360Label),a.a.createElement(Pe.a,{className:"photo-viewer__caption-button--panorama-button-icon hidden-small",src:"/build/img/svg/icn-visite-360.svg",cacheGetRequests:!0})):null}render3DShowcaseButton(){return this.props.has3DShowcase?a.a.createElement("div",{className:"photo-viewer__caption-button photo-viewer__caption-button--showcase-3d gtm-listing-showcase-3d-button",onClick:this.handle3DShowcaseClick.bind(this)},a.a.createElement("div",{className:"photo-viewer__caption-button_label hidden-xlarge"},this.props.showcase3DShortLabel),a.a.createElement("div",{className:"photo-viewer__caption-button_label hidden-small hidden-medium hidden-regular hidden-large"},this.props.showcase3DLabel),a.a.createElement(Pe.a,{className:"photo-viewer__caption-button--showcase-3d-button-icon hidden-small",src:"/build/img/svg/icn-visite-3d.svg",cacheGetRequests:!0})):null}}var ua=({photoCount:e,onPreviousButtonClick:t,onNextButtonClick:s})=>1===e?null:a.a.createElement("div",{className:"photo-viewer__caption-navigation"},a.a.createElement("div",{onClick:t,className:"photo-viewer__caption-button photo-viewer__caption-button--navigation"},a.a.createElement(Pe.a,{className:"photo-viewer__caption-button--navigation__icon",src:"/build/img/svg/icn-arrow-small-left.svg",cacheGetRequests:!0})),a.a.createElement("div",{onClick:s,className:"photo-viewer__caption-button photo-viewer__caption-button--navigation"},a.a.createElement(Pe.a,{className:"photo-viewer__caption-button--navigation__icon",src:"/build/img/svg/icn-arrow-small-right.svg",cacheGetRequests:!0}))),ma=({photoCount:e,onPreviousButtonClick:t,onNextButtonClick:s})=>1===e?null:a.a.createElement("div",{className:"photo-viewer__viewport__navigation"},a.a.createElement("div",{onClick:t,className:"photo-viewer__viewport__navigation-button photo-viewer__viewport__navigation-button--prev"},a.a.createElement(Pe.a,{className:"photo-viewer__viewport__navigation-button__icon",src:"/build/img/svg/icn-arrow-small-left.svg",cacheGetRequests:!0})),a.a.createElement("div",{onClick:s,className:"photo-viewer__viewport__navigation-button photo-viewer__viewport__navigation-button--next"},a.a.createElement(Pe.a,{className:"photo-viewer__viewport__navigation-button__icon",src:"/build/img/svg/icn-arrow-small-right.svg",cacheGetRequests:!0})));ma.propTypes={photoCount:ve.PropTypes.number.isRequired,onPreviousButtonClick:ve.PropTypes.func.isRequired,onNextButtonClick:ve.PropTypes.func.isRequired},ua.propTypes={photoCount:ve.PropTypes.number.isRequired,onPreviousButtonClick:ve.PropTypes.func.isRequired,onNextButtonClick:ve.PropTypes.func.isRequired},ha.propTypes={photoBaseUrl:ve.PropTypes.string.isRequired,photos:ve.PropTypes.array.isRequired,panorama:ve.PropTypes.array,fixedHeightListing:ve.PropTypes.bool,isPurplebricksSold:ve.PropTypes.bool.isRequired,iSoldLabel:ve.PropTypes.string.isRequired,showcaseUrl:ve.PropTypes.string,showcase3DLabel:ve.PropTypes.string,showcase3DShortLabel:ve.PropTypes.string,panorama360Label:ve.PropTypes.string,panorama360ShortLabel:ve.PropTypes.string,has3DShowcase:ve.PropTypes.bool,listingCode:ve.PropTypes.string.isRequired,isSold:ve.PropTypes.bool,showcase3DVisit:ve.PropTypes.string.isRequired,photoHighRes:ve.PropTypes.number.isRequired,photoLarge:ve.PropTypes.number.isRequired,photoBig:ve.PropTypes.number.isRequired,primaryPhotoSizes:ve.PropTypes.string.isRequired};var ga=ha;class _a extends a.a.Component{constructor(e){super(e),this.state={searchTermsTotalCount:0,searchClick:!1}}componentDidMount(){this.calculateTotalSearchTerms()}componentDidUpdate(){this.calculateTotalSearchTerms()}calculateTotalSearchTerms(){var e=Bt(this.props);e!==this.state.searchTermsTotalCount&&this.setState({searchTermsTotalCount:e})}handleOpenFullSearchClick(){p()(".".concat("mobile-header__item--search")).click(),p()(".".concat("search-bar__options-button--additional-criteria")).click()}render(){var e=Ee.a.build("mobile-search__button",{inactive:!this.props.searchBar.enabled});e=e.concat(" gtm-homepage-link-search-button",this.props.searchBarPushEvents.searchButton);var t=()=>{this.props.searchBar.enabled&&(this.props.dispatch(pt()),e.includes(" gtm-homepage-link-search-bar")||(e=e.concat(" gtm-homepage-link-search-bar")))};return a.a.createElement("div",{className:"mobile-search-wrap"},a.a.createElement(Si,{items:this.props.searchBar.headerNav.items}),a.a.createElement("div",{className:"mobile-search"},a.a.createElement(wt,{location:"HomeHero",onSubmit:t,nearMeTermLabel:this.props.nearMeTermLabel,locale:this.props.searchBar.locale,nearMePush:this.props.searchBarPushEvents.nearMe,locationText:this.props.searchBar.locationText})),a.a.createElement("div",{className:"search-bar__input-wrapper__tags",ref:"searchTerms"},a.a.createElement(wi,{totalTagsCount:this.state.searchTermsTotalCount})),a.a.createElement(Mt,{provider:"mobileSearch"}),a.a.createElement("div",{className:"mobile-search-wrapper__buttons"},a.a.createElement("button",{className:"mobile-search__button mobile-search__button--criteria ".concat(this.props.searchBarPushEvents.moreCriteria),onClick:this.handleOpenFullSearchClick},a.a.createElement("span",{className:"is-no-events"},this.props.searchBar.additionalCriteriaButtonText)),a.a.createElement("button",{className:e,onClick:t},a.a.createElement("span",{className:"mobile-search__button-text-label is-no-events"},this.props.searchBar.searchButtonText),a.a.createElement("span",{className:"mobile-search__button-icon-label is-no-events"},a.a.createElement(Pe.a,{className:"mobile-search__button-icon-label-icon",src:"/build/img/svg/icn-magnify.svg",cacheGetRequests:!0})))),a.a.createElement(Ws,{onHandleButtonClick:t,searchClick:this.state.searchClick}))}}_a.propTypes={dispatch:ve.PropTypes.func.isRequired,searchBarPushEvents:ve.PropTypes.object,nearMeTermLabel:ve.PropTypes.string.isRequired,searchBar:ve.PropTypes.shape({button:ve.PropTypes.string.isRequired,submitting:ve.PropTypes.boolean,enabled:ve.PropTypes.boolean,tagsCollapsed:ve.PropTypes.boolean,nearMeTermLabel:ve.PropTypes.string.isRequired,advancedSearchLabel:ve.PropTypes.string.isRequired,disabledFields:ve.PropTypes.array.isRequired,locale:ve.PropTypes.string.isRequired,headerNav:ve.PropTypes.object.isRequired,additionalCriteriaButtonText:ve.PropTypes.string.isRequired,searchButtonText:ve.PropTypes.string.isRequired,locationText:ve.PropTypes.string.isRequired}).isRequired};var ba=_a=Object(u.b)(({searchBarPushEvents:e,searchBar:t,searchRooms:s,searchTypes:i,searchSubTypes:a,searchPriceRange:r,searchOptions:n,searchLandArea:o,searchBathrooms:l,searchOnlineSince:c,searchFilters:p,searchTerms:d,searchFlags:h,searchLotSize:u,searchLivingArea:m})=>({searchBarPushEvents:e,searchBar:t,searchRooms:s,searchTypes:i,searchSubTypes:a,searchPriceRange:r,searchOptions:n,searchLandArea:o,searchBathrooms:l,searchOnlineSince:c,searchFilters:p,searchTerms:d,searchFlags:h,searchLotSize:u,searchLivingArea:m}))(_a),va=m.createProviderWrappedComponent(e=>a.a.createElement(ba,e)),ya=(e,t,s)=>{s.alreadyCalled&&fa(e),window.$window.scrollTop()+window.$window.height()>t.offset().top-300&&(s.alreadyCalled=!0,s())},Ta=(e,t,s)=>{window.$window.on("scroll.".concat(e),ya.bind(void 0,e,t,s))},fa=e=>{window.$window.off("scroll.".concat(e))},Pa=(...e)=>{Ta(...e)},Ea={accessibility:!1,arrows:!0,autoplay:!0,autoplaySpeed:5e3,dots:!0,dotsClass:"".concat("auto-promo-viewer__dots"),slidesToShow:1,speed:200,zIndex:1,prevArrow:".".concat("auto-promo-viewer__viewport__navigation-button--prev"),nextArrow:".".concat("auto-promo-viewer__viewport__navigation-button--next")};class wa extends a.a.Component{constructor(e){super(e);var t=e.promos[0],s=e.promos.length;this.state={activePromoIndex:0,activePromo:t,promoCount:s}}componentDidMount(){this.imagesElement=p()(this.refs.images),this.imagesElement.on("afterChange",this.handleSliderAfterChange.bind(this));var e=this.refs.content,t=Object.assign({},Ea,{appendDots:e});p()(this.refs.content).find(".".concat("auto-promo-viewer__viewport__navigation-button--prev",", .").concat("auto-promo-viewer__viewport__navigation-button--next")).on("click",e=>{this.handleGtmPushOnClick,e.preventDefault()}),Pa("AutoPromoViewer",this.imagesElement,()=>{Hi()(this.imagesElement,t),p()(this.refs.content).find(".".concat("auto-promo-viewer__dots"," button")).off("click"),p()(this.refs.content).find(".".concat("auto-promo-viewer__dots"," button")).on("click",e=>{this.handleGtmPushOnClick,e.preventDefault()})})}handleSliderAfterChange(e,t,s){var i=this.props.promos[s];this.setState({activePromo:i,activePromoIndex:s})}handleGtmPushOnClick(){_e.a.pushToDataLayer("gtm-event","Homepage_Navigation","Click_ViewerFeatures","undefined")}render(){var e="#";return e=e.concat(this.props.anchor),a.a.createElement("a",{href:this.state.activePromo.actionUrl,className:"auto-promo-viewer",name:this.props.anchor},a.a.createElement("div",{className:"auto-promo-viewer__content js-auto-promo-viewer",ref:"content","data-label":e},a.a.createElement(Ra,{promoCount:this.state.promoCount}),a.a.createElement("div",{className:"auto-promo-viewer__infos"},a.a.createElement(Ca,{titleText:this.state.activePromo.title}),a.a.createElement(Sa,{subTitleText:this.state.activePromo.subtitle}),a.a.createElement("div",{className:"auto-promo-viewer__action"},a.a.createElement("span",{className:"auto-promo-viewer__action-link"},this.state.activePromo.action,a.a.createElement(Pe.a,{className:"auto-promo-viewer__action-link-icon",src:"/build/img/svg/icn-arrow-right.svg",cacheGetRequests:!0}))))),a.a.createElement("div",{className:"auto-promo-viewer__images",ref:"images"},Array.from(this.props.promos).map((e,t)=>a.a.createElement("div",{key:"autoPromoViewer:promo:".concat(t),className:"auto-promo-viewer__promo"},a.a.createElement("img",{"data-lazy":e.imageUrl,alt:e.imageAlt})))))}}var Ca=({titleText:e})=>a.a.createElement("h4",{className:"auto-promo-viewer__title",dangerouslySetInnerHTML:{__html:e}}),Sa=({subTitleText:e})=>e?a.a.createElement("h5",{className:"auto-promo-viewer__subtitle",dangerouslySetInnerHTML:{__html:e}}):null,Ra=({promoCount:e})=>1===e?null:a.a.createElement("div",{className:"auto-promo-viewer__viewport__navigation"},a.a.createElement("div",{className:"auto-promo-viewer__viewport__navigation-button auto-promo-viewer__viewport__navigation-button--prev"},a.a.createElement(Pe.a,{className:"auto-promo-viewer__viewport__navigation-button__icon",src:"/build/img/svg/icn-arrow-large-left.svg",cacheGetRequests:!0})),a.a.createElement("div",{className:"auto-promo-viewer__viewport__navigation-button auto-promo-viewer__viewport__navigation-button--next"},a.a.createElement(Pe.a,{className:"auto-promo-viewer__viewport__navigation-button__icon",src:"/build/img/svg/icn-arrow-large-right.svg",cacheGetRequests:!0})));Ca.propTypes={titleText:ve.PropTypes.string.isRequired},Sa.propTypes={subTitleText:ve.PropTypes.string},Ra.propTypes={promoCount:ve.PropTypes.number.isRequired},wa.propTypes={promos:ve.PropTypes.array.isRequired,anchor:ve.PropTypes.string.isRequired};var Na=wa,ka={accessibility:!1,arrows:!1,autoplay:!0,autoplaySpeed:1e4,slidesToShow:1,speed:200,zIndex:1};class La extends a.a.Component{constructor(e){super(e);var t=e.testimonials[0];this.state={activeTestimonialIndex:0,activeTestimonial:t}}componentDidMount(){this.imagesElement=p()(this.refs.images),this.imagesElement.on("afterChange",this.handleSliderAfterChange.bind(this)),Pa("TestimonialViewer",this.imagesElement,()=>{Hi()(this.imagesElement,ka)})}handleSliderAfterChange(e,t,s){var i=this.props.testimonials[s];this.setState({activeTestimonial:i,activeTestimonialIndex:s})}getAnchorLabel(){return void 0===this.props.anchor?null:"#".concat(this.props.anchor)}render(){var e=this.getAnchorLabel()?"js-testimonial-viewer":"";return a.a.createElement("div",{className:"testimonial-viewer"},a.a.createElement("div",{className:"testimonial-viewer__viewport"},a.a.createElement("div",{className:"testimonial-viewer__images ".concat(e),ref:"images","data-label":this.getAnchorLabel()},Array.from(this.props.testimonials).map((e,t)=>a.a.createElement("div",{key:"testimonialViewer:testimonial:".concat(t),className:"testimonial-viewer__testimonial"},a.a.createElement("img",{"data-lazy":e.imageUrl,alt:e.imageAlt}))))),a.a.createElement("div",{className:"testimonial-viewer__content"},this.renderTagline(),a.a.createElement("h3",{className:"testimonial-viewer__title"},this.state.activeTestimonial.title,this.renderLegalHelp()),a.a.createElement("div",{className:"testimonial-viewer__quote"},a.a.createElement("div",{className:"testimonial-viewer__quote-text"},this.state.activeTestimonial.quote)),this.props.action?a.a.createElement("div",{className:"testimonial-viewer__action"},a.a.createElement("a",{className:"testimonial-viewer__action-link gtm-homepage-link-testimonial-navigation",href:this.props.actionUrl},this.props.action,a.a.createElement(Pe.a,{className:"testimonial-viewer__action-link-icon",src:"/build/img/svg/icn-arrow-right.svg",cacheGetRequests:!0}))):null))}renderLegalHelp(){return this.state.activeTestimonial.disableLegal?null:a.a.createElement("div",{className:"testimonial-viewer__legal"},a.a.createElement(Pe.a,{className:"testimonial-viewer__legal-icon",src:"/build/img/svg/icn-question-mark.svg",cacheGetRequests:!0}),a.a.createElement("div",{className:"testimonial-viewer__legal-content"},a.a.createElement("div",{className:"popover-arrow"}),this.props.legalMessage))}renderTagline(){return this.state.activeTestimonial.tagline?a.a.createElement("h2",{className:"testimonial-viewer__tagline"},this.state.activeTestimonial.tagline):null}}La.propTypes={action:ve.PropTypes.string,actionUrl:ve.PropTypes.string,testimonials:ve.PropTypes.array.isRequired,legalMessage:ve.PropTypes.string.isRequired,anchor:ve.PropTypes.string};var Oa=La,qa=s(28);class xa extends a.a.Component{handleSelect(e){this.props.dispatch((e=>({type:"SET_SEARCH_SORT_ORDER",option:e}))(e.value)),this.props.dispatch(ct("1")),this.props.dispatch(pt()),window.Dropdown("hide")}render(){var e=this.props.searchSortOrder.options.filter(e=>!1===e.hidden);return a.a.createElement(qa.a,{dropdownId:"sort-order-dropdown",options:e,selected:this.props.searchSortOrder.selected,onSelect:this.handleSelect.bind(this)})}}xa.propTypes={dispatch:ve.PropTypes.func.isRequired,searchSortOrder:ve.PropTypes.shape({selected:ve.PropTypes.string,options:ve.PropTypes.arrayOf(ve.PropTypes.shape({label:ve.PropTypes.string.isRequired,value:ve.PropTypes.string.isRequired})).isRequired}).isRequired},xa=Object(u.b)(({searchSortOrder:e})=>({searchSortOrder:e}))(xa);var Ma=m.createProviderWrappedComponent(e=>a.a.createElement(xa,e));class Da extends a.a.Component{handleSelect(e){this.props.dispatch({type:"SET_TESTIMONIALS_REGION_ID",regionId:e.value}),this.props.dispatch(Bi("1")),this.props.dispatch(Fi()),window.Dropdown("hide")}render(){return a.a.createElement(qa.a,{dropdownId:"testimonials-region-dropdown",options:this.props.options,selected:this.props.regionId,onSelect:this.handleSelect.bind(this)})}}Da.propTypes={dispatch:ve.PropTypes.func.isRequired,regionId:ve.PropTypes.string,options:ve.PropTypes.arrayOf(ve.PropTypes.shape({label:ve.PropTypes.string.isRequired,value:ve.PropTypes.string})).isRequired},Da=Object(u.b)(({testimonialsRegion:e})=>{var{regionId:t}=e;return{regionId:t}})(Da);var Aa=m.createProviderWrappedComponent(e=>a.a.createElement(Da,e)),Ia=e=>new Promise((t,s)=>{var i="".concat(window.DP.urls.proxyFeaturedHomes);p.a.ajax({url:i,data:e}).done(e=>{e||s(),t(e.listings)}).fail(s)}),Ba={accessibility:!1,arrows:!0,dots:!1,responsive:[{breakpoint:900,settings:{arrows:!1,slidesToShow:2,slidesToScroll:2}},{breakpoint:1100,settings:{arrows:!1,slidesToShow:3,slidesToScroll:3}},{breakpoint:1300,settings:{arrows:!1,slidesToShow:4,slidesToScroll:4}}],slidesToShow:6,slidesToScroll:6,infinite:!0,speed:200,zIndex:1,prevArrow:".featured-properties__viewport__navigation-button--prev",nextArrow:".featured-properties__viewport__navigation-button--next"};class Fa extends a.a.Component{constructor(e){super(e),this.state={isFirstElement:!0,isLastElement:!1,loaded:!1,properties:[],title:window.DP.isRental?this.props.titleRental:this.props.title}}fetchFeaturedHomes(){this.setState({loaded:!1}),Ia(this.props.params).then(e=>{this.setState({properties:e})})}componentDidMount(){this.fetchFeaturedHomes()}componentDidUpdate(){if(!this.state.loaded){this.elements=p()(this.refs.elements);var e=Object.assign({},Ba);Hi()(this.elements,e),this.elements.on("afterChange",this.handleSliderAfterChange.bind(this))}}handleSliderAfterChange(e,t,s){var i=0===s,a=Ba.slidesToShow+s>=this.state.properties.length;this.setState({isFirstElement:i,isLastElement:a,loaded:!0})}render(){return 0===this.state.properties.length?this.renderPlaceholder():a.a.createElement("div",{className:"search-results-feature-properties"},a.a.createElement("div",{className:"featured-properties__wrapper"},a.a.createElement("div",{className:"featured-properties"},a.a.createElement("h2",{className:"featured-properties__title"},this.state.title),a.a.createElement("div",{className:"featured-properties__viewport"},a.a.createElement(ja,{isFirstElement:this.state.isFirstElement,isLastElement:this.state.isLastElement}),a.a.createElement("div",{className:"featured-properties__viewport__elements",ref:"elements"},this.state.properties.map((e,t)=>this.renderFeaturedProperty(e,t)))))))}renderFeaturedProperty(e,t){return a.a.createElement("div",{key:"featuredProperties:property:".concat(t),className:"featured-properties__property"},a.a.createElement("a",{href:e.url,className:"featured-properties__property__link",onClick:()=>{oa(e.id,"view_from_featured_listing"),_e.a.pushDynamicEvent("listing-featuredhomes-view-property",window.DP.context.pageType)}},a.a.createElement("img",{className:"featured-properties__property__image","data-lazy":"".concat(e.photo),alt:""}),this.renderOpenHouse(e.open_house,e.show_big_open_house),a.a.createElement("div",{className:"featured-properties__property__infos"},a.a.createElement("span",{className:"featured-properties__property__title"},e.address.city),a.a.createElement("div",{className:"featured-properties__property__meta"},a.a.createElement("span",{className:"featured-properties__property__price"},e.price.display)))))}renderOpenHouse(e,t){if("object"!=typeof e)return null;var s=Ee.a.build("featured-properties__property-open-house-tag",{"big-open-house":t});return a.a.createElement("div",{className:s},this.props.openHouse,t?a.a.createElement(Pe.a,{className:"featured-properties__big-open-house-balloons",src:"/build/img/svg/big-open-house-balloons.svg",cacheGetRequests:!0}):null)}renderPlaceholder(){return a.a.createElement("div",{className:"search-results-feature-properties search-results-feature-properties--placeholder"},a.a.createElement("div",{className:"featured-properties__wrapper"},a.a.createElement("div",{className:"featured-properties"},a.a.createElement("h2",{className:"featured-properties__title"},this.state.title),a.a.createElement("div",{className:"featured-properties__loading loading-dots"},a.a.createElement("div",{className:"loading-dots__dot"}),a.a.createElement("div",{className:"loading-dots__dot"}),a.a.createElement("div",{className:"loading-dots__dot"})))))}}var ja=({isFirstElement:e,isLastElement:t})=>{var s=Ee.a.build("featured-properties__viewport__navigation-button",{prev:!0,hidden:e}),i=Ee.a.build("featured-properties__viewport__navigation-button",{next:!0,hidden:t});return a.a.createElement("div",{className:"featured-properties__viewport__navigation"},a.a.createElement("div",{className:s,onClick:()=>{_e.a.pushDynamicEvent("listing-featuredhomes-arrow-left",window.DP.context.pageType)}},a.a.createElement(Pe.a,{className:"featured-properties__viewport__navigation-button__icon is-no-events",src:"/build/img/svg/icn-arrow-large-left.svg",cacheGetRequests:!0})),a.a.createElement("div",{className:i,onClick:()=>{_e.a.pushDynamicEvent("listing-featuredhomes-arrow-right",window.DP.context.pageType)}},a.a.createElement(Pe.a,{className:"featured-properties__viewport__navigation-button__icon is-no-events",src:"/build/img/svg/icn-arrow-large-right.svg",cacheGetRequests:!0})))};ja.propTypes={isFirstElement:ve.PropTypes.bool.isRequired,isLastElement:ve.PropTypes.bool.isRequired},Fa.propTypes={title:ve.PropTypes.string.isRequired,titleRental:ve.PropTypes.string.isRequired,openHouse:ve.PropTypes.string.isRequired,priceOnRequest:ve.PropTypes.string.isRequired,params:ve.PropTypes.object.isRequired};var Va=Fa,Ua=e=>new Promise((t,s)=>{var i="".concat(window.DP.urls.proxySimilarHomes);p.a.ajax({url:i,data:e}).done(e=>{e||s(),t(e.listings)}).fail(s)}),Ha={accessibility:!1,arrows:!1,dots:!1,responsive:[{breakpoint:900,settings:{arrows:!1,slidesToShow:2,slidesToScroll:2}},{breakpoint:1100,settings:{arrows:!1,slidesToShow:3,slidesToScroll:3}},{breakpoint:1300,settings:{arrows:!1,slidesToShow:3,slidesToScroll:3}}],slidesToShow:3,slidesToScroll:3,zIndex:1,swipe:!1};class $a extends a.a.Component{constructor(e){super(e),this.state={loaded:!1,properties:[]}}fetchSimilarHomes(){this.setState({loaded:!1});var e=this.props.listingId;Ua({listingId:e}).then(e=>{this.setState({properties:e})})}componentDidMount(){this.fetchSimilarHomes()}componentDidUpdate(){if(!this.state.loaded){this.elements=p()(this.refs.elements);var e=Object.assign({},Ha);Hi()(this.elements,e)}}render(){return void 0===this.state.properties||this.state.properties.length<3?null:a.a.createElement("div",{className:"search-results-similar-properties"},a.a.createElement("div",{className:"similar-properties__wrapper"},a.a.createElement("div",{className:"similar-properties"},a.a.createElement("h2",{className:"similar-properties__title"},this.props.title),a.a.createElement("div",{className:"similar-properties__viewport"},a.a.createElement("div",{className:"similar-properties__viewport__elements",ref:"elements"},this.state.properties.map((e,t)=>this.renderSimilarProperty(e,t)))))))}renderSimilarProperty(e,t){return a.a.createElement("div",{key:"similarProperties:property:".concat(t),className:"similar-properties__property"},a.a.createElement("a",{href:e.url,className:"".concat("gtm-search-results-link-similar-property"," similar-properties__property__link")},a.a.createElement("img",{className:"similar-properties__property__image","data-lazy":"".concat(e.photo),alt:e.photos[0].alternative_text}),this.renderOpenHouse(e.open_house),a.a.createElement("div",{className:"similar-properties__property__infos"},a.a.createElement("span",{className:"similar-properties__property__title"},e.address.city),a.a.createElement("div",{className:"similar-properties__property__meta"},a.a.createElement("span",{className:"similar-properties__property__price"},e.price.display)))))}renderOpenHouse(e){return"object"!=typeof e?null:a.a.createElement("div",null,this.props.openHouse)}}$a.propTypes={title:ve.PropTypes.string.isRequired,openHouse:ve.PropTypes.string.isRequired,priceOnRequest:ve.PropTypes.string.isRequired,listingId:ve.PropTypes.string.isRequired};var Ga=$a,za=(e,t,s,i)=>{var a=.05*t;a+=a*s;var r=t*e+parseInt(i,10);return a-(r+=r*s)},Wa=(e,t,s,i)=>{var a=void 0!==i?i:0;return Math.floor(((e,t,s,i)=>{switch(e){case"ab":var a=((e,t)=>e<1e5?.07*e:1e5*.07+(e-1e5)*t)(t,.03)-i;return a*s+a;case"mb":var r=t*(.05-.02)-i;return r*s+r;case"on":return za(.025,t,s,i);default:var n=.05*t-i;return n*s+n}})(e,t,s,a))},Ka='<span class="'.concat("savings-calculator__handle__icon-left",'"></span>'),Ya='<span class="'.concat("savings-calculator__handle__icon-right",'"></span>');class Xa extends a.a.Component{constructor(e){super(e),this.state={sliderCurrentValue:e.slider.startingPrice}}componentDidMount(){var e={start:[this.props.slider.startingPrice],connect:"lower",range:this.getDefaultSteps(),format:{to:Number,from:Number},tooltips:[{to:this.createTooltipContent.bind(this)}]};this.slider=qt.a.create(this.refs.slider,e),this.appendHandleIcons(),this.slider.on("slide",this.handleSliderSlide.bind(this)),this.props.slider.isGtmOn&&this.slider.on("change",this.handleSliderChange.bind(this)),this.addTipToTooltip()}addTipToTooltip(){var e=document.querySelector("#react-component-SavingsCalculator .noUi-tooltip"),t=document.createElement("div");t.className="noUi-tooltip__tip",e.appendChild(t)}createTooltipContent(e){var t=d.a.encodeCurrencyValue(e,{noDecimal:!0});return"".concat(this.props.slider.bubbleTitle,"<br><span>").concat(t,"</span>")}getDefaultSteps(){var e={min:[this.props.slider.minimumPrice,2e4],"35%":[5e5,5e4],"90%":[2e6,1e5],max:[this.props.slider.maximumPrice]};return 3e5===this.props.slider.startingPrice&&(e["70%"]=[5e5,5e4],delete e["35%"]),e}componentWillUnmount(){this.slider.off("update"),this.slider.off("slide")}handleSliderSlide(e){this.setState({sliderCurrentValue:e}),this.addTipToTooltip(),this.removeHandleIcons()}handleSliderChange(e){_e.a.pushToDataLayer("gtm-event",window.DP.context.pageType,"Use_SavingsCalculator",Math.round(e))}renderAmount(){return d.a.encodeCurrencyValue(Wa(this.props.slider.province,this.state.sliderCurrentValue,this.props.slider.taxes,this.props.slider.fixedFeeAmount),{noDecimal:!0})}appendHandleIcons(){p()(".savings-calculator .noUi-handle").prepend(Ka),p()(".savings-calculator .noUi-handle").append(Ya)}removeHandleIcons(){p()(".".concat("savings-calculator__handle__icon-left")).remove(),p()(".".concat("savings-calculator__handle__icon-right")).remove()}render(){return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"savings-calculator js-savings-calculator"},a.a.createElement("div",{className:"savings-calculator__slider"},a.a.createElement("div",{ref:"slider"})),a.a.createElement("div",{className:"savings-calculator__results__label"},this.props.slider.resultsLabel),a.a.createElement("div",{className:"savings-calculator__results__amount"},this.renderAmount()),a.a.createElement("div",{className:"savings-calculator__disclaimer"},this.props.slider.disclaimer)))}}Xa.propTypes={slider:ve.PropTypes.shape({bubbleTitle:ve.PropTypes.string.isRequired,calculate:ve.PropTypes.string,disclaimer:ve.PropTypes.string.isRequired,fixedFeeAmount:ve.PropTypes.string,isGtmOn:ve.PropTypes.bool,locale:ve.PropTypes.string.isRequired,maximumPrice:ve.PropTypes.number.isRequired,minimumPrice:ve.PropTypes.number.isRequired,province:ve.PropTypes.string.isRequired,resultsLabel:ve.PropTypes.string.isRequired,startingPrice:ve.PropTypes.number.isRequired,taxes:ve.PropTypes.number.isRequired}).isRequired};var Za=Xa,Ja=(s(45),s(518),()=>Array.from(l.a.get("map-viewed-listing-ids")||[])),Qa=e=>{var t=new Set(Ja());t.add(e.id),l.a.set("map-viewed-listing-ids",Array.from(t))},er=e=>Ja().includes(e.id),tr=e=>[[e.min_latitude,e.min_longitude],[e.max_latitude,e.max_longitude]];var sr=class{search(e){return this.lastRequest&&this.lastRequest.abort(),new Promise((t,s)=>{this.lastRequest=(e=>{var t=window.DP.urls.proxyMapSearch,s=Le(e);return p.a.ajax({url:t,data:s})})(e).done(t).fail(s)})}};var ir=class{fetch(e,t={}){return this.lastRequest&&this.lastRequest.abort(),new Promise((s,i)=>{this.lastRequest=((e,t)=>{var s=Se()(window.DP.urls.proxyListing,e);return t&&t.light&&(s=Se()(window.DP.urls.proxyListingLight,e)),p.a.ajax({url:s,opts:t})})(e,t).done(s).fail(i)})}},ar=s(123),rr=s.n(ar),nr=/^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,or=(e,t)=>{var s=(e=>Se()(window.DP.urls.proxyStats,e))(e),i={type:t};return p.a.ajax({method:"POST",url:s,data:i,beforeSend:e=>{e.setRequestHeader("X-CSRF-TOKEN",p()('meta[name="csrf-token"]').attr("content"))}})},lr=e=>{l.a.setBucket("duproprio-");var t=window.DP.ip;if(!window.DP.is_dev_env){var s=l.a.get("ddf-analytics-uuid");null!==s&&nr.test(s)||(s=rr.a.v4(),l.a.set("ddf-analytics-uuid",s));var i={listingId:e,DestinationID:"17377",EventType:"view",UUID:s="".concat(s,"-").concat("17377"),IP:t};return p.a.ajax({method:"GET",url:"//analytics.crea.ca/LogEvents.svc/LogEvents",data:i,crossDomain:!0,dataType:"jsonp"})}},cr=s(10),pr=(e,t)=>!1!==t&&0!==t?e:e.replace(/\.svg/g,"-grayscale.svg"),dr=(e,t)=>Object.assign({},cr.MARKER_CLUSTER_OPTIONS,{animate:!1,chunkedLoading:!0,chunkInterval:500,chunkDelay:100,iconCreateFunction:s=>((e,t,s)=>{var i;if(s.getZoom()<cr.MAX_CLUSTER_ZOOM_LEVEL){var a=e.getChildCount().toString();(i=s.options.isGvlMode?Object.assign({},cr.MARKER_BIG_OPEN_HOUSE_CLUSTER_ICON_OPTIONS):Object.assign({},cr.MARKER_CLUSTER_ICON_OPTIONS)).html="".concat(mr(i),' <div class="map-cluster__label">').concat(a,"</div>"),i.className=Ee.a.build("map-cluster",{"long-label":a.length>2,"big-open-house":s.options.isGvlMode})}else if((i=s.options.isGvlMode?Object.assign({},cr.MARKER_BIG_OPEN_HOUSE_GROUP_CLUSTER_ICON_OPTIONS):Object.assign({},cr.MARKER_GROUP_ICON_OPTIONS)).html=mr(i),i.className=Ee.a.build("map-cluster",{group:!0}),!s.options.isGvlMode){var r=e.getAllChildMarkers();r.every(e=>er(e.options.listing))?i.html+=ur("viewed"):r.find(e=>e.options.listing.is_new)&&(i.html+=ur("new"))}return i.html=pr(i.html,t),delete i.iconUrl,new L.DivIcon(i)})(s,t,e),maxClusterRadius:e=>cr.MARKER_CLUSTER_MAX_RADIUS(e)}),hr=(e,t)=>{var s,i=e.isRental||e.is_rental;return s=t.options.isGvlMode?cr.BIG_OPEN_HOUSE_ICON_OPTIONS:!i&&e.is_builder&&e.group!==cr.GROUP_TERRAIN?cr.LISTING_BUILDER_ICON_OPTIONS:cr.ICONS_BY_GROUP[e.group]||cr.LISTING_HOUSE_ICON_OPTIONS,(s=Object.assign({},s)).html='<img src="'.concat(s.iconUrl,'" width="').concat(s.iconSize[0],'" height="').concat(s.iconSize[1],'" />'),delete s.iconUrl,t.options.isGvlMode||(er(e)?s.html+=ur("viewed"):e.is_new&&(s.html+=ur("new"))),s.html=pr(s.html,e.in_search),new L.DivIcon(s)},ur=(e,t)=>{var{className:s,iconUrl:i,iconSize:a}=cr["LISTING_".concat(e.toUpperCase(),"_FLAG_OPTIONS")],[r,n]=a;return'<img class="'.concat(t||s,'" src="').concat(i,'" width="').concat(r,'" height="').concat(n,'" />')},mr=e=>'<img src="'.concat(e.iconUrl,'" width="').concat(e.iconSize[0],'" height="').concat(e.iconSize[1],'" />'),gr=(e,t,s,i,a,r,n)=>{var o=((e,t,s,i)=>{var a="";switch(e.source){case cr.SOURCE_DDF:a=s;break;case cr.SOURCE_IDX_TREB:case cr.SOURCE_IDX_RAHB:case cr.SOURCE_IDX_RAE:case cr.SOURCE_IDX_CREB:case cr.SOURCE_IDX_TREB_SOLD:a=i;break;default:a=t}return a=a.replace(/\/$/,""),"".concat(a,"/").concat(e.photo_primary.uri)})(e,t,s,i),l=e.is_sold?e.price_sold.display:((e,t)=>{if(!e.price)return null;var s=e.price.display;return e.is_sold?s=e.hasOwnProperty("price_sold")?e.price_sold.display:null:0!==e.price.raw&&null!==e.price.raw||(s=t),s})(e,a),c='\n        <div class="map-popup__listing">\n            <div class="map-popup__photo'.concat(e.is_sold?" sold-tag-container":"",'">\n                <img class="map-popup__photo-image" src="').concat(o,'" alt="').concat(e.photo_primary.alternative_text,'}">\n                ').concat(e.is_sold?'<div class="sold-tag sold-tag--small">'.concat(r,"</div>"):"",'\n            </div>\n\n            <div class="map-popup__infos">\n                <div class="map-popup__infos-content">\n                    ').concat(e.is_sold?'<span class="map-popup__price-label">'.concat(n,"</span>"):"",'\n                    <div class="map-popup__price">\n                        ').concat(l||"","\n                        ").concat(er(e)?ur("viewed","map-popup__viewed-flag"):"","\n                    </div>\n                    ").concat((e=>{var t='<div class="map-popup__title">'.concat(e.type,"</div>");return"qc"!==window.DP.province&&(t=""),t})(e),'\n                    <div class="map-popup__address">').concat(e.address.street?e.address.street:e.address.city,"</div>\n                </div>\n            </div>\n        </div>\n    ");return p()(c).data("listing",e)[0]},_r=()=>'\n        <div class="map-popup__listing map-popup__listing--loading">\n            <div class="loading-dots">\n                <div class="loading-dots__dot"></div>\n                <div class="loading-dots__dot"></div>\n                <div class="loading-dots__dot"></div>\n            </div>\n        </div>\n    ';var br=class{constructor(e,t,{attribution:s,photoBaseUrl:i,photoBaseUrlDdf:a,photoBaseUrlIdx:r,initialContext:n,regions:o,priceOnRequest:l,soldLabel:c=null,soldPriceLabel:p=null}){if(this.map=new L.Map(e,Object.assign({},cr.MAP_OPTIONS,t)),this.mapSearch=new sr,this.listingFetcher=new ir,this.skipFirstListingFetchOnMapAjustment=!1,n&&(n.center&&n.zoomLevel&&(this.map.setView(n.center,n.zoomLevel),this.skipFirstListingFetchOnMapAjustment=!0),n.bounds)){var d=new L.LatLngBounds(n.bounds);this.map.setView(d.getCenter(),cr.DEFAULT_INITIAL_ZOOM_LEVEL)}this.mapInitializationComplete=!1,this.photoBaseUrl=i,this.photoBaseUrlDdf=a,this.photoBaseUrlIdx=r,this.priceOnRequest=l,this.hasTooManyListingsError=!1,this.isPopupBeingUsed=null,this.regions=o,this.soldLabel=c,this.soldPriceLabel=p,this.fetchedListings=[],this.trackedListingIds={},this.trackedListingIds[cr.VIEWS_CLICK_TYPE]=[],this.trackedListingIds[cr.VIEWS_MOUSEOVER_TYPE]=[],this.handleMapMoveEnd=Ne(this.handleMapMoveEnd.bind(this),cr.MAP_MOVE_DEBOUNCE_DELAY),this.updateLastSearchBounds=Ne(this.updateLastSearchBounds.bind(this),cr.UPDATE_BOUND_DEBOUNCE_DELAY),this.configureTileProvider(),this.configureAttributionControl(s)}configureTileProvider(){new L.TileLayer(cr.TILE_PROVIDER_URL,cr.TILE_PROVIDER_OPTIONS).addTo(this.map)}configureAttributionControl(e){this.attributionControl=new L.Control.Attribution(cr.ATTRIBUTION_CONTROL_OPTIONS),this.attributionControl.addAttribution(e),this.attributionControl.addTo(this.map),this.map.whenReady(()=>this.updateAttributionLink())}getBounds(){return this.map.getBounds()}bindPopupEvents(e,t){var s=p()(e._container);this.isPopupBeingUsed=t,s.on("mouseover",this.handlePopupMouseOver.bind(this)),s.on("mouseout",this.handlePopupMouseOut.bind(this)),s.on("click",".map-popup__listing",this.handlePopupListingClick.bind(this))}bindMarkerClusterEvents(e){e.on("mouseover",e=>this.handleMarkerMouseOver(e)),e.on("mouseout",()=>this.handleMarkerMouseOut()),e.on("click",e=>this.handleMarkerClick(e)),e.on("clusterclick",e=>this.handleClusterMouseClick(e)),e.on("clustermouseover",e=>this.handleClusterMouseOver(e)),e.on("clustermouseout",()=>this.handleClusterMouseOut())}bindRegionMarkerEvents(e){e.on("mouseover",e=>this.handleRegionMarkerMouseOver(e)),e.on("mouseout",()=>this.handleRegionMarkerMouseOut()),e.on("click",e=>this.handleRegionMarkerClick(e))}handleMapZoomEnd(){this.map.closePopup(),this.isPopupBeingUsed=null}handleMapClick(){this.map.closePopup(),this.isPopupBeingUsed=null}handleMapMoveEnd(){if(this.updateAttributionLink(),this.onMapMoveEnd(this.map),void 0!==this.forceScope||this.mapInitializationComplete&&!this.guessAsTooManySearchResults(this.initialSearchCriteria)){var e=this.determineScopeToFetch();if(null!==e){var t=Object.assign({},this.initialSearchCriteria,this.getPaddedBounds());t.search_scope=e,this.fetchListings(t)}}this.countVisibleInSearchListings()}handlePopupClosingDelayTimeout(){this.isPopupBeingUsed||this.map.closePopup()}handlePopupMouseOver(){this.isPopupBeingUsed="marker-over"}handlePopupMouseOut(){this.isPopupBeingUsed=null,this.enqueuePopupClosingCheck()}handlePopupListingClick(e){var t=p()(e.currentTarget).data("listing");t&&this.selectListing(t)}initOpenListingPopup(e){var{listing:t}=e.layer.options,s=Object.assign({},cr.POPUP_OPTIONS,{listing:t.id}),i=new L.Rrose(s).setContent(_r).setLatLng(e.latlng).openOn(this.map);this.bindPopupEvents(i,t.id),this.fetchedListings[t.id]?this.openListingPopup(this.fetchedListings[t.id],e,i,s):this.listingFetcher.fetch(t.id,{light:!0}).then(t=>{this.fetchedListings[t[0].id]=t[0],this.openListingPopup(t[0],e,i,s)}).catch(()=>{})}openListingPopup(e,t,s,i){if(this.isPopupBeingUsed){var a=gr(e,this.photoBaseUrl,this.photoBaseUrlDdf,this.photoBaseUrlIdx,this.priceOnRequest,this.soldLabel,this.soldPriceLabel);s=new L.Rrose(i).setContent(a).setLatLng(t.latlng).openOn(this.map),this.bindPopupEvents(s,e.id),e.source===cr.SOURCE_DP&&this.trackListingView(e.id,cr.VIEWS_MOUSEOVER_TYPE)}}openListingDrawer(e){var{listing:t}=e.layer.options;this.selectListing(t)}handleMarkerMouseOver(e){L.Browser.mobile||this.initOpenListingPopup(e)}handleMarkerMouseOut(){L.Browser.mobile||(this.enqueuePopupClosingCheck(),this.isPopupBeingUsed=null)}handleMarkerClick(e){L.Browser.mobile?this.isPopupBeingUsed===e.layer.options.listing.id?this.openListingDrawer(e):this.initOpenListingPopup(e):this.openListingDrawer(e),e.layer.options.listing.is_sold&&_e.a.pushDynamicEvent("sold-search-map-click-sold-listing","".concat(window.DP.context.pageType,"_Map"))}initCreateMultipleListingsClusterPopup(e){var t=e.layer.getAllChildMarkers().map(e=>e.options.listing),s=Object.assign({},cr.POPUP_OPTIONS,{listings:t}),i=new L.Rrose(s).setContent(_r).setLatLng(e.latlng).openOn(this.map),a=[],r=[];for(var n of(this.bindPopupEvents(i,"listings-marker"),t))this.fetchedListings[n.id]?r.push(this.fetchedListings[n.id]):a.push(n.id);a.length>0?this.listingFetcher.fetch(a,{light:!0}).then(t=>{for(var a of t)this.fetchedListings[a.id]=a;r=r.concat(t),this.createMultipleListingsClusterPopup(r,e,i,s)}).catch(()=>{}):this.createMultipleListingsClusterPopup(r,e,i,s)}createMultipleListingsClusterPopup(e,t,s,i){if(this.isPopupBeingUsed){var a,r,n,o,l,c,d,h,u=(a=e,r=this.photoBaseUrl,n=this.photoBaseUrlDdf,o=this.photoBaseUrlIdx,l=this.priceOnRequest,c=this.soldLabel,d=this.soldPriceLabel,h=p()('<div class="map-popup__listings"></div>'),a.forEach(e=>{h.append(gr(e,r,n,o,l,c,d))}),h[0]);s=new L.Rrose(i).setContent(u).setLatLng(t.latlng).openOn(this.map),this.bindPopupEvents(s,"listings-cluster");var m=e.filter(e=>e.source===cr.SOURCE_DP).map(e=>e.id);m.length>0&&this.trackListingView(m.join(","),cr.VIEWS_MOUSEOVER_TYPE)}}handleClusterMouseClick(e){this.map.getZoom()>=cr.MAX_ZOOM_LEVEL&&this.initCreateMultipleListingsClusterPopup(e)}handleClusterMouseOver(e){this.map.getZoom()<cr.MAX_CLUSTER_ZOOM_LEVEL||this.initCreateMultipleListingsClusterPopup(e)}handleClusterMouseOut(){this.enqueuePopupClosingCheck(),this.isPopupBeingUsed=null}handleRegionMarkerMouseOver(e){var{region:t}=e.target.options,s=(e=>{var t='<div class="map-popup__regions">\n        '.concat(e.name,"\n    </div>");return p()(t).data("listing",e)[0]})(t),i="region-".concat(t.id),a=new L.Rrose(cr.POPUP_REGIONS_OPTIONS).setContent(s).setLatLng(e.latlng).openOn(this.map);this.bindPopupEvents(a,i)}handleRegionMarkerMouseOut(){this.enqueuePopupClosingCheck()}handleRegionMarkerClick(e){var t=this.map.getZoom(),s=cr.REGION_ZOOM_LEVEL(e.target.options.region.id);t>=s&&(s=t+1),this.map.setView(e.latlng,s)}addMarkerAndCenter(e,t){var{latitude:s,longitude:i}=e,a=new L.LatLng(s,i),r=hr(e,this.map),n=new L.Marker(a,{icon:r,listing:e});n.setZIndexOffset(cr.IN_SEARCH_Z_INDEX),n.addTo(this.map),this.setPositionAndZoom(s,i,t)}setPositionAndZoom(e,t,s){var i=new L.LatLng(e,t);this.map.setView(i,s)}enqueuePopupClosingCheck(){this.popupClosingTimeout&&clearTimeout(this.popupClosingTimeout),this.popupClosingTimeout=setTimeout(this.handlePopupClosingDelayTimeout.bind(this),cr.POPUP_CLOSE_DELAY)}hasMetaSearchBounds(e){return"object"==typeof e&&e.hasOwnProperty("search_bounds")&&e.search_bounds.hasOwnProperty("max_longitude")&&e.search_bounds.hasOwnProperty("min_longitude")&&e.search_bounds.hasOwnProperty("max_latitude")&&e.search_bounds.hasOwnProperty("min_latitude")}assignMapBoundsBasedOnMeta(e){if(!this.mapInitializationComplete&&this.hasMetaSearchBounds(e)){var{max_latitude:t,max_longitude:s,min_latitude:i,min_longitude:a}=e.search_bounds,r=new L.LatLng(i,s),n=new L.LatLng(t,a),o=new L.latLngBounds(r,n);this.map.fitBounds(o),this.skipFirstListingFetchOnMapAjustment=!0}}createRegionsLayer(e=!1){if(!this.regionLayer){var t=[];this.regions.forEach(e=>{var{latitude:s,longitude:i}=e,a=new L.LatLng(s,i),r=this.map.options.isGvlMode?Object.assign({},cr.MARKER_BIG_OPEN_HOUSE_GROUP_CLUSTER_ICON_OPTIONS):Object.assign({},cr.MARKER_CLUSTER_ICON_OPTIONS);r.html="".concat(mr(r),' <div class="map-cluster__label"></div>'),r.className="map-cluster";var n=new L.DivIcon(r),o=new L.Marker(a,{icon:n,region:e});this.bindRegionMarkerEvents(o),t.push(o)}),this.regionLayer=new L.featureGroup(t)}this.regionLayer.addTo(this.map),e&&this.map.fitBounds(this.regionLayer.getBounds())}removeRegionMarkers(){this.regionLayer&&this.map.hasLayer(this.regionLayer)&&this.map.removeLayer(this.regionLayer)}addMarkers(e,t,s=!1){t.search_scope===cr.SCOPE_IN?(this.addInSearchMarkers(e,s),this.deactivateIsLoading()):t.search_scope===cr.SCOPE_OUT&&this.addOutSearchMarkers(e)}addInSearchMarkers(e,t=!1){var s=[],i=!1;this.inSearchMarkerClusterGroup?(this.inSearchMarkerClusterGroup.clearLayers(),i=!0):(this.inSearchMarkerClusterGroup=new L.MarkerClusterGroup(dr(this.map,!0)),this.bindMarkerClusterEvents(this.inSearchMarkerClusterGroup),this.inSearchMarkerClusterGroup.addTo(this.map)),i&&this.map.getZoom()<cr.REGION_ZOOM_LEVEL_DEFAULT||e.length>cr.MAX_IN_SEARCH_LISTING_COUNT?this.initHasTooManyMarkers():(this.hasTooManyListingsError=!1,e.forEach(e=>{var{latitude:t,longitude:i}=e,a=new L.LatLng(t,i),r=hr(e,this.map),n=new L.Marker(a,{icon:r,listing:e});n.setZIndexOffset(cr.IN_SEARCH_Z_INDEX),s.push(n)}),this.inSearchMarkerClusterGroup.addLayers(s),t&&this.inSearchMarkerClusterGroup.getBounds().isValid()&&this.inSearchMarkerClusterGroup.getLayers().length>0&&this.map.fitBounds(this.inSearchMarkerClusterGroup.getBounds()),this.updateLastSearchBounds(cr.SCOPE_IN),this.removeRegionMarkers(),this.handleMapMoveEnd(),this.countVisibleInSearchListings())}addOutSearchMarkers(e){var t=[];this.countVisibleInSearchListings()+e.length>cr.MAX_IN_SEARCH_LISTING_COUNT?this.outSearchMarkerClusterGroup&&this.outSearchMarkerClusterGroup.clearLayers():(this.outSearchMarkerClusterGroup?this.outSearchMarkerClusterGroup.clearLayers():(this.outSearchMarkerClusterGroup=new L.MarkerClusterGroup(dr(this.map,!1)),this.bindMarkerClusterEvents(this.outSearchMarkerClusterGroup),this.outSearchMarkerClusterGroup.addTo(this.map)),e.forEach(e=>{var{latitude:s,longitude:i}=e,a=new L.LatLng(s,i),r=hr(e,this.map),n=new L.Marker(a,{icon:r,listing:e});t.push(n)}),(this.skipFirstListingFetchOnMapAjustment||this.mapInitializationComplete||0===this.inSearchMarkerClusterGroup.getLayers().length)&&this.outSearchMarkerClusterGroup.addLayers(t),this.updateLastSearchBounds(cr.SCOPE_OUT),this.removeRegionMarkers())}initHasTooManyMarkers(e=!1){this.hasTooManyListingsError=!0,this.mapInitializationComplete=!0,this.lastInSearchBounds=null,this.deactivateIsLoading(),this.onMapMoveEnd(this.map),this.createRegionsLayer(e),this.countVisibleInSearchListings()}refresh(){this.map.invalidateSize(!1)}updateAttributionLink(){var e=this.attributionControl.getContainer().querySelector("a");e.setAttribute("target","_blank"),e.setAttribute("href","".concat(cr.TILE_ATTRIBUTION_BASE_URL))}selectListing(e){this.onListingSelect&&(L.Browser.mobile&&this.activateIsLoading(),e.source===cr.SOURCE_DP&&this.trackListingView(e.id,cr.VIEWS_CLICK_TYPE),this.listingFetcher.fetch(e.id).then(e=>{this.onListingSelect(e),this.refreshMapIcons(),L.Browser.mobile&&this.deactivateIsLoading(),this.isPopupBeingUsed=null}).catch(()=>{}))}refreshMapIcons(){this.map.eachLayer(e=>{e instanceof L.Marker&&e.options.listing&&e.setIcon(hr(e.options.listing,this.map)),e instanceof L.MarkerCluster&&e._updateIcon()})}bindMoveEnd(){this.map.on("moveend",this.handleMapMoveEnd.bind(this)),this.map.on("zoomend",this.handleMapZoomEnd.bind(this)),this.map.on("click",this.handleMapClick.bind(this))}getPaddedBounds(){var e=cr.BOUNDS_PADDING_RATIO(this.map.getZoom()),t=this.map.getBounds().pad(e);return{min_latitude:t.getSouth(),max_latitude:t.getNorth(),min_longitude:t.getWest(),max_longitude:t.getEast()}}fetchListings(e,t=!1){return e.search_scope===cr.SCOPE_IN&&this.activateIsLoading(),this.mapSearch.search(e).then(e=>{e.hasOwnProperty("data")&&e.data.length>0?this.addMarkers(e.data,e.meta,t):this.deactivateIsLoading(),this.mapInitializationComplete=!0},()=>{})}hasGeoCriterias(e){return e.hasOwnProperty(cr.SEARCH_CRITERIA_REGIONS)||e.hasOwnProperty(cr.SEARCH_CRITERIA_CITIES)}consideredWideSearch(e){return!this.hasGeoCriterias(e)&&!e.hasOwnProperty("is_builder")&&!e.hasOwnProperty("is_featured_home")&&!e.hasOwnProperty("is_open_house")&&!e.hasOwnProperty("has_virtual_tour")&&(!e.hasOwnProperty(cr.SEARCH_CRITERIA_TYPE)||e.hasOwnProperty(cr.SEARCH_CRITERIA_TYPE)&&e.type.length>1||e.hasOwnProperty(cr.SEARCH_CRITERIA_TYPE)&&(-1!==e.type.indexOf(cr.LISTING_TYPE_HOUSE)||-1!==e.type.indexOf(cr.LISTING_TYPE_CONDO)))}determineScopeToFetch(){var e=this.map.getBounds(),t=this.map.getZoom(),s=null;return void 0===this.forceScope||-1===this.forceScope.indexOf(cr.SCOPE_IN)&&-1===this.forceScope.indexOf(cr.SCOPE_OUT)||(s=this.forceScope),s&&s!==cr.SCOPE_IN||this.lastInSearchBounds&&this.lastInSearchBounds.contains(e)?s&&s!==cr.SCOPE_OUT||!(t>cr.REGION_ZOOM_LEVEL_DEFAULT)||!this.hasGeoCriterias(this.initialSearchCriteria)||this.lastOutSearchBounds&&this.lastOutSearchBounds.contains(e)||(s=cr.SCOPE_OUT):s=cr.SCOPE_IN,s}guessAsTooManySearchResults(e){return cr.USE_REGION_MARKERS_FOR_PROVINCE(window.DP.province)&&this.map.getZoom()<cr.REGION_ZOOM_LEVEL_DEFAULT&&(!this.inSearchMarkerClusterGroup||this.inSearchMarkerClusterGroup&&0===this.inSearchMarkerClusterGroup.getLayers().length)&&this.consideredWideSearch(e)}updateLastSearchBounds(e){var t=cr.BOUNDS_PADDING_RATIO(this.map.getZoom()),s=this.map.getBounds().pad(t);e===cr.SCOPE_IN?this.lastInSearchBounds=s:this.lastOutSearchBounds=s}countVisibleInSearchListings(){var e;if(this.hasTooManyListingsError)e=cr.MAX_IN_SEARCH_LISTING_COUNT+1;else if(this.inSearchMarkerClusterGroup){var t=this.map.getBounds();e=this.inSearchMarkerClusterGroup.getLayers().reduce((e,s)=>t.contains(s.getLatLng())?e+1:e,0)}return this.onVisibleInSearchListingCountChange(e),e}trackListingView(e,t){this.trackedListingIds[t].includes(e)||(this.trackedListingIds[t].push(e),or(e,t))}};class vr extends a.a.Component{constructor(e){super(e),this.state={showPopover:!1}}handleButtonClick(){this.setState({showPopover:!this.state.showPopover}),this.props.isSoldContext&&_e.a.pushDynamicEvent("sold-search-map-click-sold-legend","".concat(window.DP.context.pageType,"_Map"))}handlePopoverOuterClick(){this.setState({showPopover:!1})}render(){return a.a.createElement("div",{className:"map-legend"},this.renderButton(),this.renderPopover())}renderButton(){var e=Ee.a.build("map-legend__button",{active:this.state.showPopover});return a.a.createElement("button",{onClick:this.handleButtonClick.bind(this),className:e},this.props.buttonLabel)}renderPopover(){if(!this.state.showPopover)return null;var{itemLabels:e}=this.props;return a.a.createElement(St,{onOuterClick:this.handlePopoverOuterClick.bind(this)},a.a.createElement("div",{className:"map-legend__popover"},a.a.createElement("div",{className:"map-legend__popover-content"},Object.keys(e).map(t=>this.renderItem(e,t))),a.a.createElement("div",{className:"map-legend__popover-arrow-container"},a.a.createElement("div",{className:"map-legend__popover-arrow"}))))}renderItem(e,t){if(!e[t].show)return null;var s="purplebricks"===window.DP.theme?"purplebricks":"duproprio";return a.a.createElement("div",{className:"map-legend__popover-content-item",key:t},a.a.createElement(Pe.a,{className:"map-legend__popover-content-item-icon",src:"/build/img/svg/".concat(s,"/map/").concat(e[t].icon),cacheGetRequests:!0}),a.a.createElement("span",{className:"map-legend__popover-content-item-label"},e[t].label))}}vr.propTypes={buttonLabel:ve.PropTypes.string.isRequired,itemLabels:ve.PropTypes.array.isRequired,isSoldContext:ve.PropTypes.bool};var yr=vr,Tr=({listing:e,labels:t})=>{if(e.is_rental)return null;var{bedrooms:s,bathroomsAndHalfBaths:i,livingSpace:r,lotSize:n}=t;return a.a.createElement("div",{className:"map-drawer__characteristics"},((e,t)=>0===e.characteristics.main.bedrooms_display?null:a.a.createElement("span",{className:"map-drawer__characteristics__item"},a.a.createElement(Pe.a,{className:"map-drawer__characteristics__icon",src:"/build/img/svg/icn-characteristics-bedrooms.svg",cacheGetRequests:!0}),a.a.createElement("div",{className:"map-drawer__characteristics__popover"},t),e.characteristics.main.bedrooms_display))(e,s),((e,t)=>{if(0===e.characteristics.main.nb_bathrooms)return null;var s=[e.characteristics.main.nb_bathrooms];return 0!==e.characteristics.main.nb_half_bathrooms&&s.push(e.characteristics.main.nb_half_bathrooms),a.a.createElement("span",{className:"map-drawer__characteristics__item"},a.a.createElement(Pe.a,{className:"map-drawer__characteristics__icon",src:"/build/img/svg/icn-characteristics-bathrooms.svg",cacheGetRequests:!0}),a.a.createElement("div",{className:"map-drawer__characteristics__popover"},t),s.join(" + "))})(e,i),((e,t)=>e.characteristics.main.living_space?a.a.createElement("span",{className:"map-drawer__characteristics__item"},a.a.createElement(Pe.a,{className:"map-drawer__characteristics__icon",src:"/build/img/svg/icn-characteristics-building-dimensions.svg",cacheGetRequests:!0}),a.a.createElement("div",{className:"map-drawer__characteristics__popover"},t),a.a.createElement("span",{className:"map-drawer__characteristics-long-number-value"},e.characteristics.main.living_space.display_short)):null)(e,r),((e,t)=>e.characteristics.main.lot_size?a.a.createElement("span",{className:"map-drawer__characteristics__item"},a.a.createElement(Pe.a,{className:"map-drawer__characteristics__icon",src:"/build/img/svg/icn-characteristics-lot-dimensions.svg",cacheGetRequests:!0}),a.a.createElement("div",{className:"map-drawer__characteristics__popover"},t),a.a.createElement("span",{className:"map-drawer__characteristics-long-number-value"},e.characteristics.main.lot_size.display_short)):null)(e,n))};Tr.propTypes={listing:ve.PropTypes.object,labels:ve.PropTypes.object.isRequired};var fr=Tr,Pr={accessibility:!1,arrows:!1,lazyLoad:"ondemand",infinite:!1,slidesToShow:1,speed:200,zIndex:1};class Er extends a.a.Component{constructor(e){super(e),this.photoSize=Wi(),this.buildPhotos(e.photos),this.state={activePhotoIndex:0,listingId:e.listingId}}componentDidMount(){this.createSlider()}static getDerivedStateFromProps(e,t){var s=t;return e.listingId!==t.listingId&&(s.listingId=e.listingId,s.activePhotoIndex=0),s}componentDidUpdate(e){e.listingId!==this.props.listingId&&(this.buildPhotos(this.props.photos),this.createSlider())}handleNextButtonClick(){this.photosElement.slick("slickNext")}handlePreviousButtonClick(){this.photosElement.slick("slickPrev")}handleSliderAfterChange(e,t,s){this.setState({activePhotoIndex:s})}render(){var e=0!==this.state.activePhotoIndex,t=this.state.activePhotoIndex!==this.photos.length-1;return this.buildPhotos(this.props.photos),a.a.createElement("div",{className:"map-drawer__photo-viewer"},a.a.createElement(wr,{showPreviousButton:e,showNextButton:t,onPreviousButtonClick:this.handlePreviousButtonClick.bind(this),onNextButtonClick:this.handleNextButtonClick.bind(this)}),this.renderPhotos())}renderPhotos(){return a.a.createElement("div",{className:"map-drawer__photo-viewer-photos",key:"photoViewer:photos:".concat(this.props.listingId),ref:e=>this.photosElement=p()(e)},Array.from(this.photos).map((e,t)=>this.renderPhoto(e,t)))}renderPhoto(e,t){return a.a.createElement("div",{key:"drawerPhotoViewer:photo:".concat(t),className:"map-drawer__photo-viewer-slide"},this.renderAction(t),a.a.createElement("img",{"data-lazy":e.url,alt:e.alternative_text}))}renderAction(e){return this.photos.length<=3||e<this.photos.length-1?null:a.a.createElement("div",{className:"map-drawer__photo-viewer-action"},a.a.createElement("a",{className:"map-drawer__photo-viewer-action-link",href:this.props.url},this.viewAllPhotosLabel))}createSlider(){Hi()(this.photosElement,Pr),this.photosElement.on("afterChange",this.handleSliderAfterChange.bind(this))}buildPhotos(e){var t,s,i,a=this.props.photoBaseUrl.replace(/\/$/,"");this.photos=(t=e,s=t.find(e=>e.is_primary),i=t.filter(e=>!e.is_primary).slice(0,3),[s].concat(i)).map(e=>({alternative_text:e.alternative_text,url:"".concat(a,"/").concat(e.formats[this.photoSize])})),this.viewAllPhotosLabel=Se()(this.props.viewAllPhotosLabel,e.length)}}var wr=({onPreviousButtonClick:e,onNextButtonClick:t,showPreviousButton:s,showNextButton:i})=>{var r=s?a.a.createElement("div",{onClick:e,className:"map-drawer__photo-viewer-navigation-button map-drawer__photo-viewer-navigation-button--prev"},a.a.createElement(Pe.a,{className:"map-drawer__photo-viewer-navigation-button-icon",src:"/build/img/svg/icn-arrow-large-left.svg",cacheGetRequests:!0})):null,n=i?a.a.createElement("div",{onClick:t,className:"map-drawer__photo-viewer-navigation-button map-drawer__photo-viewer-navigation-button--next"},a.a.createElement(Pe.a,{className:"map-drawer__photo-viewer-navigation-button-icon",src:"/build/img/svg/icn-arrow-large-right.svg",cacheGetRequests:!0})):null;return a.a.createElement("div",{className:"map-drawer__photo-viewer-navigation"},r,n)};wr.propTypes={showPreviousButton:ve.PropTypes.bool.isRequired,showNextButton:ve.PropTypes.bool.isRequired,onPreviousButtonClick:ve.PropTypes.func.isRequired,onNextButtonClick:ve.PropTypes.func.isRequired},Er.propTypes={listingId:ve.PropTypes.string.isRequired,photos:ve.PropTypes.arrayOf(ve.PropTypes.shape({formats:ve.PropTypes.object.isRequired,is_primary:ve.PropTypes.bool.isRequired,alternative_text:ve.PropTypes.string.isRequired})).isRequired,viewAllPhotosLabel:ve.PropTypes.string.isRequired,photoBaseUrl:ve.PropTypes.string.isRequired,url:ve.PropTypes.string.isRequired};var Cr=Er,Sr=(e,t,s=null)=>{var i=(e=>Se()(window.DP.urls.proxyListingFavourite,e))(t);return p.a.ajax({method:e,url:i,data:s,statusCode:{401:()=>{var i="PUT"===e&&s.hasOwnProperty("note")?"add-note":"add-favorite";((e,t)=>{var s=window.DP.urls.login,i=window.location.href.replace(window.location.hash,""),a="".concat(i,"#listing-").concat(e),r="do=".concat(t,"&code=").concat(e,"&listing=").concat(e,"&url-back=").concat(encodeURIComponent(a));window.location.href="".concat(s,"?").concat(r)})(t,i)}},beforeSend:e=>{e.setRequestHeader("X-CSRF-TOKEN",p()('meta[name="csrf-token"]').attr("content"))}})},Rr=e=>Sr("POST",e,{note:""}),Nr=e=>Sr("DELETE",e),kr=(e,t)=>Sr("PUT",e,{note:t}),Lr=e=>({type:"TOGGLE_LISTING_FAVOURITE",listingId:e}),Or=(e,t)=>({type:"UPDATE_LISTING_FAVOURITE_NOTE",listingId:e,note:t});class qr extends a.a.Component{constructor(e){super(e),this.handleCreateFavourite=Ne(this.handleCreateFavourite.bind(this),400),this.handleRemoveFavourite=Ne(this.handleRemoveFavourite.bind(this),400),this.state={disabled:!1,hover:!1}}handleClick(e){e.preventDefault(),this.props.dispatch(Lr(this.props.listingId)),this.props.active?this.handleRemoveFavourite():(this.handleCreateFavourite(),oa(this.props.listingId,"add_to_favourites")),this.setState({hover:!1})}handleCreateFavourite(){Rr(this.props.listingId).catch(this.handleFavouriteFailed.bind(this)),_e.a.pushDynamicEvent("listing-clickfavourite-add",window.DP.context.pageType)}handleRemoveFavourite(){Nr(this.props.listingId).catch(this.handleFavouriteFailed.bind(this)),_e.a.pushDynamicEvent("listing-clickfavourite-remove",window.DP.context.pageType)}handleFavouriteFailed(){this.setState({disabled:!0}),this.props.dispatch(Lr(this.props.listingId))}handleMouseEnter(){this.setState({hover:!0})}handleMouseLeave(){this.setState({hover:!1})}render(){var e,t,s=this.props.active,i=this.state.hover,r=this.state.disabled,n=this.props.boxShadow,o=s?this.props.labelRemoveFromFavourites:this.props.labelAddToFavourites,l=Ee.a.build("favourite-toggle-button",{active:s,hover:i,disabled:r,withBoxShadow:n,["at".concat(this.props.location)]:!0}),c="gtm-listing-link-favorite";return"SearchResultsListings"===this.props.location&&(c="gtm-search-results-link-favorite"),a.a.createElement("button",{className:"".concat(l," ").concat(c),onClick:this.handleClick.bind(this),onMouseEnter:this.handleMouseEnter.bind(this),onMouseLeave:this.handleMouseLeave.bind(this),"aria-label":"".concat(o)},a.a.createElement(Pe.a,{className:"favourite-toggle-button__icon",src:(e=this.props.boxShadow,t="/build/img/svg/icn-heart","".concat(t,e?"-shadow.svg":".svg")),cacheGetRequests:!0}))}}qr.propTypes={dispatch:ve.PropTypes.func.isRequired,favouriteListingIds:ve.PropTypes.arrayOf(ve.PropTypes.string).isRequired,listingId:ve.PropTypes.string.isRequired,active:ve.PropTypes.bool,boxShadow:ve.PropTypes.bool,location:ve.PropTypes.string.isRequired,labelAddToFavourites:ve.PropTypes.string.isRequired,labelRemoveFromFavourites:ve.PropTypes.string.isRequired};var xr=qr=Object(u.b)(({listingsFavourites:e},{listingId:t})=>{var{favouriteListingIds:s}=e,i=s.includes(t);return{favouriteListingIds:s,active:i}})(qr),Mr=m.createProviderWrappedComponent(e=>a.a.createElement(xr,e)),Dr=(e,t,s)=>{var i="",a="fr"===window.DP.lang?0:1,r=t.getDate(),n=t.getMonth(),o=t.getFullYear(),l=[["janvier","fÃ©vrier","mars","avril","mai","juin","juillet","aoÃ»t","septembre","octobre","novembre","dÃ©cembre"],["January","February","March","April","May","June","July","August","September","October","November","December"]];switch(e){case"day_number":i=r;break;case"month":i=[["janv.","fÃ©vr.","mars","avr.","mai","juin","juill.","aoÃ»t","sept.","oct.","nov.","dÃ©c."],["Jan.","Feb.","March","Apr.","May","June","July","Aug.","Sept.","Oct.","Nov.","Dec."]][a][n];break;case"year":i=o;break;case"hour":i=s;break;case"full_date":i="fr"===window.DP.lang?r.toString().concat(" ",l[a][n]," ",o):l[a][n].concat(" ",Ir(r)," ",o)}return i},Ar=e=>(e<10?0:"").toString().concat(e.toString()),Ir=e=>{var t=e.toString();return e+(t=["th","st","nd","rd","th","th","th","th","th","th"][t.slice(-1)])},Br=e=>{var t=e,s=(t=t.concat("Z")).split(/[^0-9]/);return new Date(s[0],s[1]-1,s[2],s[3],s[4],s[5])},Fr={formatDate:(e,t,s=":")=>{if(!e)return null;var i="",a=Br(e),r=Ar(a.getHours()),n=Ar(a.getMinutes());if("fr"===window.DP.lang)i="".concat(r).concat(s).concat(n);else{var o=r>=12?"pm":"am",l=r%12;i="".concat(l=l||12,":").concat(n," ").concat(o)}return Dr(t,a,i)},reformatDate:Br},jr=["AB","ON"],Vr=({listing:e,onCloseButtonClick:t,photoBaseUrl:s,photoBaseUrlDdf:i,photoBaseUrlIdx:r,titleLabel:n,viewLabel:o,characteristicLabels:l,viewAllPhotosLabel:c,queryString:p,openHouseLabel:d,isNewHomes:h,availabilityLabel:u,availabilityNow:m,soldLabel:g,soldPriceLabel:_})=>{var b=Se()("/listing/%s%s",e.id,p),v=Ee.a.build("map-drawer",{newHomes:h}),y=Ur(e.source,s,i,r);return a.a.createElement("div",{className:v},a.a.createElement("div",{className:"map-drawer__header"},a.a.createElement("div",{className:"map-drawer__header-title"},n),a.a.createElement("div",{onClick:t,className:"map-drawer__header-close"},a.a.createElement(Pe.a,{className:"map-drawer__header-close-button",src:"/build/img/svg/icn-close.svg",cacheGetRequests:!0}))),a.a.createElement("div",{className:e.is_sold?"map-drawer__photo sold-tag-container":"map-drawer__photo"},a.a.createElement(Cr,{photos:e.photos,listingId:e.id,viewAllPhotosLabel:c,url:b,photoBaseUrl:y}),e.price_precision?a.a.createElement("div",{className:"map-drawer__precision"},e.price_precision):null,e.open_house&&e.open_house.next?a.a.createElement(Hr,{next:e.open_house.next,openHouseLabel:d,showBigOpenHouse:e.show_big_open_house}):null,e.is_sold?a.a.createElement($r,{soldLabel:g}):null,e.is_sold||-1!==jr.indexOf(e.address.province)?null:a.a.createElement("div",{className:"map-drawer__favourite-button"},a.a.createElement(Mr,{listingId:e.id,location:"SearchMapDrawer",boxShadow:!0}))),"ab"===window.DP.province?a.a.createElement(Gr,{brokerName:e.broker_name,className:"map-drawer__brokerage map-drawer__brokerage--alberta"}):null,a.a.createElement(zr,{listing:e,soldPriceLabel:_}),e.is_sold?null:a.a.createElement(Wr,{availabilityValue:e.characteristics.main.availability,availabilityLabel:u,availabilityNow:m}),a.a.createElement("div",{className:"map-drawer__address"},a.a.createElement("div",{className:"map-drawer__address-city"},e.address.city),a.a.createElement("div",{className:"map-drawer__address-street"},e.address.street)),e.broker_name?a.a.createElement(Gr,{brokerName:e.broker_name,className:"map-drawer__brokerage"}):null,a.a.createElement(fr,{listing:e,labels:l}),a.a.createElement("a",{className:"map-drawer__view-button",href:b,onClick:()=>{e.is_sold&&_e.a.pushDynamicEvent("sold-search-map-click-sold-preview-listing","".concat(window.DP.context.pageType,"_Map"))}},a.a.createElement("span",{className:"map-drawer__view-button-label"},o),a.a.createElement(Pe.a,{className:"map-drawer__view-button-icon",src:"/build/img/svg/icn-arrow-right.svg",cacheGetRequests:!0})))},Ur=(e,t,s,i)=>{var a="";switch(e){case"ddf":a=s;break;case"idx_creb":case"idx_rae":case"idx_rahb":case"idx_treb_sold":case"idx_treb":a=i;break;default:a=t}return a},Hr=({next:e,openHouseLabel:t,showBigOpenHouse:s})=>a.a.createElement("div",{className:"open-house-tag open-house-tag--map"},a.a.createElement("div",{className:"open-house-tag__date"},e),a.a.createElement("div",{className:"open-house-tag__label"},t),s?a.a.createElement(Pe.a,{className:"big-open-house-balloons",src:"/build/img/svg/big-open-house-balloons.svg",cacheGetRequests:!0}):null),$r=({soldLabel:e})=>a.a.createElement("div",{className:"sold-tag sold-tag--drawer"},e),Gr=({brokerName:e})=>a.a.createElement("div",{className:"map-drawer__brokerage"},a.a.createElement("div",{className:"map-drawer__brokerage-name"},e)),zr=({listing:e,soldPriceLabel:t})=>a.a.createElement("div",{className:"map-drawer__infos"},a.a.createElement("div",{className:"map-drawer__title"},e.is_sold?t:e.title.display_long),e.price?a.a.createElement("div",{className:"map-drawer__price"},e.price.display):null,e.price_sold?a.a.createElement("div",{className:"map-drawer__price"},e.price_sold.display):null),Wr=({availabilityValue:e,availabilityLabel:t,availabilityNow:s})=>{if(void 0===e)return null;var i=new Date,r=e.concat("T00:00:00"),n=Fr.reformatDate(r);return e=i.getTime()>n.getTime()?s:Fr.formatDate(r,"full_date"),a.a.createElement("div",{className:"map-drawer__availability"},a.a.createElement("div",{className:"map-drawer__availability-label"},t),"Â ",a.a.createElement("div",{className:"map-drawer__availability-value"},e))};Vr.propTypes={onCloseButtonClick:ve.PropTypes.func.isRequired,photoBaseUrl:ve.PropTypes.string.isRequired,photoBaseUrlDdf:ve.PropTypes.string.isRequired,photoBaseUrlIdx:ve.PropTypes.string.isRequired,titleLabel:ve.PropTypes.string.isRequired,viewLabel:ve.PropTypes.string.isRequired,soldLabel:ve.PropTypes.string.isRequired,soldPriceLabel:ve.PropTypes.string.isRequired,viewAllPhotosLabel:ve.PropTypes.string.isRequired,openHouseLabel:ve.PropTypes.string.isRequired,characteristicLabels:ve.PropTypes.object.isRequired,queryString:ve.PropTypes.string.isRequired,listing:ve.PropTypes.shape({id:ve.PropTypes.string.isRequired,type:ve.PropTypes.string.isRequired,photos:ve.PropTypes.array.isRequired,price_precision:ve.PropTypes.string,price:ve.PropTypes.shape({display:ve.PropTypes.string}),show_big_open_house:ve.PropTypes.bool.isRequired,address:ve.PropTypes.shape({street:ve.PropTypes.string,city:ve.PropTypes.string}),source:ve.PropTypes.string.isRequired,broker_name:ve.PropTypes.string.isRequired,title:ve.PropTypes.shape({display_short:ve.PropTypes.string.isRequired,display_long:ve.PropTypes.string.isRequired}).isRequired,characteristics:ve.PropTypes.shape({main:ve.PropTypes.shape({availability:ve.PropTypes.string})})}).isRequired,isNewHomes:ve.PropTypes.bool.isRequired,availabilityLabel:ve.PropTypes.string.isRequired,availabilityNow:ve.PropTypes.string.isRequired},Hr.propTypes={next:ve.PropTypes.string.isRequired,openHouseLabel:ve.PropTypes.string.isRequired,showBigOpenHouse:ve.PropTypes.bool.isRequired,bigOpenHouse:ve.PropTypes.object},$r.propTypes={soldLabel:ve.PropTypes.string.isRequired},Gr.propTypes={brokerName:ve.PropTypes.string.isRequired,className:ve.PropTypes.string.isRequired},Wr.propTypes={availabilityLabel:ve.PropTypes.string.isRequired,availabilityNow:ve.PropTypes.string.isRequired,availabilityValue:ve.PropTypes.string},zr.propTypes={listing:ve.PropTypes.shape({id:ve.PropTypes.string.isRequired,type:ve.PropTypes.string.isRequired,photos:ve.PropTypes.array.isRequired,price_precision:ve.PropTypes.string,price:ve.PropTypes.shape({display:ve.PropTypes.string}),show_big_open_house:ve.PropTypes.bool.isRequired,address:ve.PropTypes.shape({street:ve.PropTypes.string,city:ve.PropTypes.string}),source:ve.PropTypes.string.isRequired,broker_name:ve.PropTypes.string.isRequired,title:ve.PropTypes.shape({display_short:ve.PropTypes.string.isRequired,display_long:ve.PropTypes.string.isRequired}).isRequired,characteristics:ve.PropTypes.shape({main:ve.PropTypes.shape({availability:ve.PropTypes.string})})}).isRequired,soldPriceLabel:ve.PropTypes.string.isRequired};var Kr=Vr;function Yr(){return(Yr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e}).apply(this,arguments)}class Xr extends a.a.Component{constructor(e){super(e);var t=window.innerWidth<=768;this.state={activeListing:null,mobile:t}}componentDidMount(){var{photoBaseUrl:e,photoBaseUrlDdf:t,photoBaseUrlIdx:s,searchCriteria:i,regions:a,priceOnRequest:r,listing:n}=this.props,{latitude:o,longitude:l}=n,c={maxBounds:tr(i),scrollWheelZoom:!0,center:new L.LatLng(o,l)};this.map=new br(this.refs.map,c,{attribution:this.props.attribution,photoBaseUrl:e,photoBaseUrlDdf:t,photoBaseUrlIdx:s,regions:a,priceOnRequest:r}),this.map.onListingSelect=this.handleListingSelect.bind(this),this.map.onVisibleInSearchListingCountChange=()=>{},this.map.activateIsLoading=()=>{},this.map.deactivateIsLoading=()=>{},this.map.onMapMoveEnd=()=>{},this.map.forceScope=cr.SCOPE_OUT,this.map.mapInitializationComplete=!0,this.map.initialSearchCriteria=i,this.map.addMarkerAndCenter(this.props.listing,15),this.props.activeListingTab!==this.props.listing.tabName||this.state.mobile||this.map.handleMapMoveEnd()}componentDidUpdate({activeListingTab:e},t){e!==this.props.activeListingTab&&this.props.activeListingTab===this.props.listing.tabName&&(setTimeout(()=>this.map.refresh(),0),this.state.mobile||this.map.bindMoveEnd())}handleDrawerCloseButtonClick(){this.setState({activeListing:null})}handleListingSelect(e){this.setState({activeListing:e})}render(){return a.a.createElement("div",{className:"listing-map"},a.a.createElement("div",{ref:"map",className:"listing-map__map"}),this.renderLegend(),this.renderDrawer())}renderLegend(){return this.state.mobile?null:a.a.createElement("div",{className:"listing-map__legend"},a.a.createElement(yr,{buttonLabel:this.props.legend.buttonLabel,itemLabels:this.props.legend.itemLabels}))}renderDrawer(){return!this.state.activeListing||this.state.mobile?null:a.a.createElement("div",{className:"listing-map__drawer"},a.a.createElement(Kr,Yr({},this.props.drawer,{listing:this.state.activeListing,queryString:"",onCloseButtonClick:this.handleDrawerCloseButtonClick.bind(this),photoBaseUrl:this.props.photoBaseUrl,photoBaseUrlDdf:this.props.photoBaseUrlDdf,photoBaseUrlIdx:this.props.photoBaseUrlIdx})))}}Xr.propTypes={attribution:ve.PropTypes.string,photoBaseUrl:ve.PropTypes.string.isRequired,photoBaseUrlDdf:ve.PropTypes.string.isRequired,photoBaseUrlIdx:ve.PropTypes.string.isRequired,listing:ve.PropTypes.shape({latitude:ve.PropTypes.number.isRequired,longitude:ve.PropTypes.number.isRequired,tabName:ve.PropTypes.string.isRequired,isRental:ve.PropTypes.bool}),legend:ve.PropTypes.shape({buttonLabel:ve.PropTypes.string.isRequired,itemLabels:ve.PropTypes.array.isRequired}).isRequired,drawer:ve.PropTypes.shape({titleLabel:ve.PropTypes.string.isRequired,viewLabel:ve.PropTypes.string.isRequired,viewAllPhotosLabel:ve.PropTypes.string.isRequired,openHouseLabel:ve.PropTypes.string.isRequired,characteristicLabels:ve.PropTypes.object.isRequired,isNewHomes:ve.PropTypes.bool.isRequired}).isRequired,searchCriteria:ve.PropTypes.shape({province:ve.PropTypes.number.isRequired}).isRequired,activeListingTab:ve.PropTypes.string,priceOnRequest:ve.PropTypes.string.isRequired,regions:ve.PropTypes.array.isRequired};var Zr=Xr=Object(u.b)(({listingTabs:e})=>{var{activeTabName:t}=e;return{activeListingTab:t}})(Xr),Jr=m.createProviderWrappedComponent(e=>a.a.createElement(Zr,e)),Qr=e=>({type:"SET_SEARCH_MAP_INITIAL_LISTINGS_FETCHED",fetched:e});function en(){return(en=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e}).apply(this,arguments)}class tn extends a.a.Component{constructor(e){super(e);var t=window.innerWidth<=768;this.state={activeListing:null,queryString:"",isLoading:!1,hideAlert:!1,mobile:t,zoom:null}}componentDidMount(){var{attribution:e,photoBaseUrl:t,photoBaseUrlDdf:s,photoBaseUrlIdx:i,initialContext:a,searchCriteria:r,regions:n,priceOnRequest:o,soldLabel:l,soldPriceLabel:c,isBlurred:p}=this.props,d={maxBounds:tr(r),scrollWheelZoom:!0,isGvlMode:void 0!==r.gvl};if(this.map=new br(this.refs.map,d,{attribution:e,photoBaseUrl:t,photoBaseUrlDdf:s,photoBaseUrlIdx:i,initialContext:a,regions:n,priceOnRequest:o,soldLabel:l,soldPriceLabel:c}),d.isGvlMode&&this.state.mobile){ke().then(e=>{this.map.setPositionAndZoom(e.coords.latitude,e.coords.longitude,12)}).catch(()=>{this.props.dispatch({type:"SHOW_WARNING_MESSAGE"}),this.setState({fetchingNearMe:!1})})}if(!p||!r.is_sold)if(this.map.onListingSelect=this.handleListingSelect.bind(this),this.map.onVisibleInSearchListingCountChange=this.handleVisibleInSearchListingCountChange.bind(this),this.map.onMapMoveEnd=this.handleMapMoveEnd.bind(this),this.map.activateIsLoading=this.handleActivateIsLoading.bind(this),this.map.deactivateIsLoading=this.handleDeactivateIsLoading.bind(this),this.map.initialSearchCriteria=((e,t,{center:s})=>s?Object.assign({},e,t.getPaddedBounds()):e)(r,this.map,a),this.map.guessAsTooManySearchResults(this.map.initialSearchCriteria))this.props.dispatch(Qr(!0)),this.map.initHasTooManyMarkers(!0),this.map.bindMoveEnd();else{var h=Object.assign({},this.map.initialSearchCriteria);h.search_scope=this.map.determineScopeToFetch(),this.map.fetchListings(h,a.fitInSearchBounds).then(()=>{this.props.dispatch(Qr(!0)),this.map.bindMoveEnd()})}}componentDidUpdate(e,{activeListing:t}){this.state.activeListing&&t!==this.state.activeListing&&Qa(this.state.activeListing)}handleDrawerCloseButtonClick(){this.setState({activeListing:null}),this.props.searchCriteria.is_sold&&_e.a.pushDynamicEvent("sold-search-map-click-preview-listing","".concat(window.DP.context.pageType,"_Map"))}handleListingSelect(e){this.setState({activeListing:e})}handleVisibleInSearchListingCountChange(e){this.props.visibleInSearchListingCount!==e&&this.props.dispatch((e=>({type:"SET_SEARCH_MAP_VISIBLE_IN_SEARCH_LISTING_COUNT",count:e}))(e))}handleMapMoveEnd(e){var t=e.getCenter(),s="?position=".concat(t.lat,",").concat(t.lng,"&zoom=").concat(e.getZoom());this.setState({queryString:s}),this.setState({zoom:e.getZoom()}),window.history.pushState(null,null,s)}handleActivateIsLoading(){this.setState({isLoading:!0})}handleDeactivateIsLoading(){this.setState({isLoading:!1}),this.setState({hideAlert:!1})}handleCloseClick(){this.setState({hideAlert:!0})}handleNavigationClick(){var e=this.state.zoom>13?this.state.zoom:13;ke().then(t=>{this.map.setPositionAndZoom(t.coords.latitude,t.coords.longitude,e)}).catch(()=>{this.props.dispatch({type:"SHOW_WARNING_MESSAGE"}),this.setState({fetchingNearMe:!1})})}render(){return a.a.createElement("div",{className:"search-map"},a.a.createElement("div",{className:"search-map__container"},a.a.createElement("div",{className:"search-map__viewport"},a.a.createElement("div",{ref:"map",className:"search-map__map"}),this.renderNavigation(),a.a.createElement("div",{className:"search-map__legend"},a.a.createElement(yr,{buttonLabel:this.props.legend.buttonLabel,itemLabels:this.props.legend.itemLabels,isSoldContext:!!this.props.searchCriteria.is_sold})),this.renderDrawer(),this.renderNoResults(),this.renderLoading(),this.renderLoginGate())))}renderNavigation(){return a.a.createElement("div",{className:"map-navigation"},a.a.createElement("button",{className:"map-navigation__button",onClick:this.handleNavigationClick.bind(this)},a.a.createElement(Pe.a,{className:"map-navigation__button-icon",src:"/build/img/svg/icn-navigation.svg",cacheGetRequests:!0})),a.a.createElement("span",{className:"map-navigation__tooltip"},this.props.navigationTooltip))}renderDrawer(){return this.state.isLoading||!this.state.activeListing?null:(p()(".search-survey").addClass("hidden-mobile"),a.a.createElement("div",{className:"search-map__drawer"},a.a.createElement(Kr,en({},this.props.drawer,{listing:this.state.activeListing,queryString:this.state.queryString,onCloseButtonClick:this.handleDrawerCloseButtonClick.bind(this),photoBaseUrl:this.props.photoBaseUrl,photoBaseUrlDdf:this.props.photoBaseUrlDdf,photoBaseUrlIdx:this.props.photoBaseUrlIdx}))))}renderNoResults(){if(this.state.isLoading||this.state.hideAlert||!this.props.initialListingsFetched||null===this.props.visibleInSearchListingCount||this.props.visibleInSearchListingCount>0)return null;var e=Ee.a.build("search-map__alert",{narrow:this.state.activeListing});return a.a.createElement("div",{className:e},a.a.createElement("div",{className:"search-map__alert-content"},a.a.createElement("div",{className:"search-map__alert-close-button",onClick:this.handleCloseClick.bind(this)},a.a.createElement(Pe.a,{className:"email-alerts-form__close-icon",src:"/build/img/svg/icn-close.svg",cacheGetRequests:!0})),a.a.createElement("div",{className:"search-map__alert-title"},this.props.noResults.titleLabel),a.a.createElement("div",{className:"search-map__alert-message"},this.props.noResults.messageLabel)))}renderLoading(){return this.state.isLoading?a.a.createElement("div",{className:"search-map__loading"},this.props.loadingResults.titleLabel):null}renderLoginGate(){return this.props.isBlurred&&this.props.searchCriteria.is_sold?a.a.createElement("div",{className:"search-map__login"},a.a.createElement("p",{dangerouslySetInnerHTML:{__html:this.props.loginWall.line1}}),a.a.createElement("p",null,a.a.createElement("a",{href:this.props.loginWall.loginUrl,className:"button button--auto listing-login-wall__button",dangerouslySetInnerHTML:{__html:this.props.loginWall.buttonLabel},onClick:()=>_e.a.pushDynamicEvent("sold-search-map-click-sold-map-login",window.DP.context.pageType+"_Map")})),a.a.createElement("p",{dangerouslySetInnerHTML:{__html:this.props.loginWall.line2},onClick:()=>_e.a.pushDynamicEvent("sold-search-map-click-sold-map-register",window.DP.context.pageType+"_Map")})):null}}tn.propTypes={attribution:ve.PropTypes.string.isRequired,photoBaseUrl:ve.PropTypes.string.isRequired,photoBaseUrlDdf:ve.PropTypes.string.isRequired,photoBaseUrlIdx:ve.PropTypes.string.isRequired,soldLabel:ve.PropTypes.string.isRequired,soldPriceLabel:ve.PropTypes.string.isRequired,noResults:ve.PropTypes.shape({titleLabel:ve.PropTypes.string.isRequired,messageLabel:ve.PropTypes.string.isRequired}),loadingResults:ve.PropTypes.shape({titleLabel:ve.PropTypes.string.isRequired}),drawer:ve.PropTypes.shape({titleLabel:ve.PropTypes.string.isRequired,viewLabel:ve.PropTypes.string.isRequired,viewAllPhotosLabel:ve.PropTypes.string.isRequired,openHouseLabel:ve.PropTypes.string.isRequired,characteristicLabels:ve.PropTypes.object,isNewHomes:ve.PropTypes.bool.isRequired}).isRequired,legend:ve.PropTypes.shape({buttonLabel:ve.PropTypes.string.isRequired,itemLabels:ve.PropTypes.array.isRequired,isSoldContext:ve.PropTypes.bool}).isRequired,initialContext:ve.PropTypes.shape({fitInSearchBounds:ve.PropTypes.bool.isRequired,center:ve.PropTypes.arrayOf(ve.PropTypes.number),bounds:ve.PropTypes.arrayOf(ve.PropTypes.arrayOf(ve.PropTypes.number)),zoomLevel:ve.PropTypes.number}),searchCriteria:ve.PropTypes.object.isRequired,initialListingsFetched:ve.PropTypes.bool.isRequired,visibleInSearchListingCount:ve.PropTypes.number,dispatch:ve.PropTypes.func.isRequired,priceOnRequest:ve.PropTypes.string.isRequired,regions:ve.PropTypes.array.isRequired,isBlurred:ve.PropTypes.bool.isRequired,loginWall:ve.PropTypes.shape({line1:ve.PropTypes.string.isRequired,line2:ve.PropTypes.string.isRequired,buttonLabel:ve.PropTypes.string.isRequired,loginUrl:ve.PropTypes.string.isRequired}).isRequired,navigationTooltip:ve.PropTypes.string.isRequired};var sn=tn=Object(u.b)(({searchMap:e})=>{var{initialListingsFetched:t,visibleInSearchListingCount:s}=e;return{initialListingsFetched:t,visibleInSearchListingCount:s}})(tn),an=m.createProviderWrappedComponent(e=>a.a.createElement(sn,e));class rn extends a.a.Component{constructor(e){super(e),this.state={streetViewUrl:!1,isNotFound:!1,newWindow:null}}handleClick(){this.state.isNotFound?this.errorNotFound():(_e.a.pushDynamicEvent("listing-clickmapgooglestreet","Listing"),this.state.newWindow&&!this.state.newWindow.closed||(this.state.newWindow=window.open("","_blank")),this.state.streetViewUrl?this.openStreetView():this.loadGoogleMapsApiScript())}handleStreetViewResponse(e,t){if(t===google.maps.StreetViewStatus.OK){var s=e.location.latLng,i="".concat("https://www.google.ca/maps","?cbll=").concat(s.lat(),",").concat(s.lng(),"&layer=c&cbp=12,20.09,,0,5&panoid=").concat(e.location.pano);this.setState({streetViewUrl:i}),this.openStreetView()}else this.setState({isNotFound:!0}),this.errorNotFound()}render(){return a.a.createElement("button",{onClick:this.handleClick.bind(this),className:"gtm-listing-map-link-google-street-view listing-street-view-button__button"},a.a.createElement("span",{className:"listing-street-view-button__button-content"},a.a.createElement(Pe.a,{className:"listing-street-view-button__button-icon",src:"/build/img/svg/icn-street-view.svg",cacheGetRequests:!0}),this.props.buttonLabel))}loadGoogleMapsApiScript(){var e=document.createElement("script");e.src=Se()("https://maps.googleapis.com/maps/api/js?key=%s&callback=onGoogleMapsScriptsInitialize",this.props.googleMapsApiKey),document.body.appendChild(e),window.onGoogleMapsScriptsInitialize=()=>this.initializeStreetViewCheck()}initializeStreetViewCheck(){var e=new google.maps.LatLng(this.props.latitude,this.props.longitude);(new google.maps.StreetViewService).getPanoramaByLocation(e,100,this.handleStreetViewResponse.bind(this))}openStreetView(){this.state.newWindow.location=this.state.streetViewUrl,this.state.newWindow.focus()}errorNotFound(){this.state.newWindow&&!this.state.newWindow.closed&&this.state.newWindow.close(),alert(this.props.notFoundMessage)}}rn.propTypes={latitude:ve.PropTypes.number.isRequired,longitude:ve.PropTypes.number.isRequired,googleMapsApiKey:ve.PropTypes.string.isRequired,buttonLabel:ve.PropTypes.string.isRequired,notFoundMessage:ve.PropTypes.string.isRequired};var nn=rn,on=(e,t=!1)=>({type:"ACTIVATE_LISTING_TAB",name:e,scrollToTab:!!t});class ln extends a.a.Component{constructor(e){super(e),this.state={gtmPartnerEventPushed:!1},this.useNewCalculator="on"===window.DP.province||"mb"===window.DP.province||"qc"===window.DP.province}componentDidMount(){window.onhashchange=this.onHashChange.bind(this),this.hashtagNavigation(),window.location.hash?(this.showActiveTabContent(),this.isHashInTabs()&&this.scrollToTabs()):p()(".".concat("listing-tab-content","--").concat(this.props.activeTabName)).addClass("listing-tab-content--active"),(p()(".".concat("listing-tab__item--cogeco")).is(":visible")||p()(".".concat("listing-tab__item--cogeco_EPICO")).is(":visible")||p()(".".concat("listing-tab__item--bell")).is(":visible")||p()(".".concat("listing-tab__item--bell_FTTH")).is(":visible")||p()(".".concat("listing-tab__item--bell_FTTN")).is(":visible"))&&this.props.items.map(({partnerTab:e,isRental:t})=>this.handleGtmEventPush(e,t)),p()(".".concat("toggleable-content")).find("h3 a").on("click",this.toggleLegalNote.bind(this)),this.handleListingViewDdf()}isHashInTabs(){var e=window.location.hash.substring(1);return e&&this.props.items.some(t=>t.name===e)}handleItemClick(e){this.scrollToTabs(),window.location.replace("#".concat(e)),this.props.dispatch(on(e))}handleListingViewDdf(){var e=this.props.listing;if(void 0!==e&&void 0!==e.code&&void 0!==e.source&&"ddf"===e.source.toLowerCase()){var t=e.code.replace("d","");lr(t)}}componentDidUpdate({activeTabName:e},t){e!==this.props.activeTabName&&this.showActiveTabContent({activeTabName:e}),this.state.gtmPartnerEventPushed===t.gtmPartnerEventPushed&&this.scrollToTabs()}handleGtmEventPush(e,t){if(this.state.gtmPartnerEventPushed)return null;e&&("cogeco"===e?t?_e.a.pushToDataLayer("gtm-event","Partnership_Cogeco","PartnershipTab_Available_Rental","undefined"):_e.a.pushToDataLayer("gtm-event","Partnership_Cogeco","PartnershipTab_Available","undefined"):"cogeco_EPICO"===e?t?_e.a.pushToDataLayer("gtm-event","Partnership_Cogeco","PartnershipTab_Available_Rental","EPICO"):_e.a.pushToDataLayer("gtm-event","Partnership_Cogeco","PartnershipTab_Available","EPICO"):"bell_FTTN"===e?_e.a.pushToDataLayer("gtm-event","Partnership_Bell","PartnershipTab_Available","FTTN"):"bell_FTTH"===e?_e.a.pushToDataLayer("gtm-event","Partnership_Bell","PartnershipTab_Available","FTTH"):"bell"===e&&_e.a.pushToDataLayer("gtm-event","Partnership_Bell","PartnershipTab_Available",""),this.setState({gtmPartnerEventPushed:!0}))}handlePushDynamicEvent(e){var t;switch(e){case"cogeco":t="Partnership_Cogeco";break;case"cogeco_EPICO":t="Partnership_Cogeco",window.DP.isRental&&(e="".concat(e,"_rental"));break;case"bell":t="Partnership_Bell";break;default:t="Listing"}if(_e.a.pushDynamicEvent("listing-clicktab-".concat(e),t),"price-history"===e){var s=this.props.listing.isSold?"sold":"sell";_e.a.pushDynamicEvent("".concat(s,"-price-history-listing-tab"),window.DP.context.pageType)}}render(){return a.a.createElement("nav",{ref:"tabs",className:"listing-tab"},a.a.createElement("ul",{className:"listing-tab__list"},this.props.items.map(({name:e,label:t,labelShort:s,partnerTab:i})=>this.renderItem(e,t,s,i))))}renderItem(e,t,s,i){if(e!==this.props.listing.hashtagMap||!this.props.listing.hideTabMap){var r=Ee.a.build("listing-tab__item",{highlighted:e===this.props.activeTabName}),n=i?"".concat("listing-tab__item","--").concat(i):"".concat("listing-tab__item","--").concat(e);return a.a.createElement("li",{key:"listingTabs:item:".concat(e),onClick:this.handleItemClick.bind(this,e),className:"".concat(r," ").concat(n)},a.a.createElement("a",{href:"#".concat(e),onClick:this.handlePushDynamicEvent.bind(this,e),className:"listing-tab__link"},this.renderCogeco(t,s)))}}renderCogeco(e,t){return a.a.createElement("div",null,a.a.createElement("span",{className:"listing-tab__link-label"},e),a.a.createElement("span",{className:"listing-tab__link-label-short"},t))}showActiveTabContent(){p()(".".concat("listing-tab-content")).removeClass("listing-tab-content--active"),p()(".".concat("listing-tab-content","--").concat(this.props.activeTabName)).addClass("listing-tab-content--active")}scrollToTabs(){var e,t=p()(this.refs.tabs).offset().top;e=p()(".".concat("mobile-header")).length?p()(".".concat("mobile-header")).height():p()(".".concat("header--fixed")).height()+p()(".".concat("listing-fixed-header")).height(),window.scrollTo(0,t-e)}refreshAds(e){if(window.DP.configSwitch.adsSystem&&!this.props.listing.soldSharedListing){this.resetAds();var t=this;googletag.cmd.push((function(){var s=t.getAvailableAdsList(e);s.length>0&&(googletag.pubads().refresh(s),activeAds=activeAds.concat(s))}))}}resetAds(){if(window.DP.configSwitch.adsSystem&&!this.props.listing.soldSharedListing){var e=this;googletag.cmd.push((function(){var t=e.getAllAdsList();t.length>0&&(googletag.pubads().clear(t),activeAds=p()(activeAds).not(t).get())}))}}getAvailableAdsList(e){return this.isInBuyTab(e)?this.refreshAdsBuyTab():this.isInCostTab(e)?this.refreshAdsCostTab():this.isInMapTab(e)?this.refreshAdsMapTab():this.isInPartnerTab(e)?this.refreshAdsPartnerTab():this.refreshAdsDescriptionTab()}getAllAdsList(){var e=[];return e=(e=(e=(e=(e=e.concat(this.refreshAdsDescriptionTab())).concat(this.refreshAdsBuyTab())).concat(this.refreshAdsCostTab())).concat(this.refreshAdsMapTab())).concat(this.refreshAdsPartnerTab())}isInBuyTab(e){return"acheter"===e||"buy"===e}isInCostTab(e){return"costs"===e||"couts"===e}isInMapTab(e){return"carte"===e||"map"===e}isInPartnerTab(e){return"cogeco"===e||"cogeco_EPICO"===e||"bell"===e||"bell_FTTN"===e||"bell_FTTH"===e}refreshAdsBuyTab(){return[listingBuyBigboxTop,listingBuyBigboxBottom]}refreshAdsCostTab(){var e=[listingCostBigboxTop,listingCostBigboxBottom];return"undefined"==typeof listingCostsMortgageCalculator||this.useNewCalculator||e.push(listingCostsMortgageCalculator,listingCostsLinkBottom),"undefined"!=typeof listingCostsNewMortgageCalculator&&this.useNewCalculator&&e.push(listingCostsNewMortgageCalculator),e}refreshAdsMapTab(){return this.props.listing.hideTabMap?null:[listingMapLeaderboardBottom]}refreshAdsPartnerTab(){var e=[];return"undefined"!=typeof listingPartnerBigboxTop&&e.push(listingPartnerBigboxTop),"undefined"!=typeof listingPartnerBigboxBottom&&e.push(listingPartnerBigboxBottom),"undefined"!=typeof listingPartnerCatfish&&e.push(listingPartnerCatfish),"undefined"!=typeof listingPartnerTab&&e.push(listingPartnerTab),e}refreshAdsDescriptionTab(){var e=[];return e.push(listingDescriptionBigboxTop,listingDescriptionBigboxBottom),"undefined"==typeof listingDescriptionMortgageCalculator||this.useNewCalculator||e.push(listingDescriptionMortgageCalculator,listingDescriptionLinkBottom),"undefined"!=typeof listingDescriptionNewMortgageCalculator&&this.useNewCalculator&&e.push(listingDescriptionNewMortgageCalculator),e}toggleLegalNote(e){e.preventDefault(),p()(".".concat("toggleable-content")).toggleClass("opened")}onHashChange(){this.hashtagNavigation()}hashtagNavigation(){var e=window.location.hash.substring(1);p()(".".concat("listing-tab-content")).hasClass("".concat("listing-tab-content","--").concat(e))&&window.location.hash||(e=p()(".".concat("listing-tab__item")).first().find("a").attr("href").substring(1)),e&&e!==this.props.activeTabName&&this.props.dispatch(on(e)),this.refreshAds(e)}}ln.propTypes={dispatch:ve.PropTypes.func.isRequired,activeTabName:ve.PropTypes.string.isRequired,items:ve.PropTypes.arrayOf(ve.PropTypes.shape({name:ve.PropTypes.string,label:ve.PropTypes.string,labelShort:ve.PropTypes.string,partnerTab:ve.PropTypes.string,isRental:ve.PropTypes.bool})).isRequired,listing:ve.PropTypes.shape({code:ve.PropTypes.string.isRequired,source:ve.PropTypes.string.isRequired,hideTabMap:ve.PropTypes.bool.isRequired,hashtagMap:ve.PropTypes.string.isRequired,soldSharedListing:ve.PropTypes.bool.isRequired,isSold:ve.PropTypes.bool}).isRequired,scrollToTab:ve.PropTypes.bool.isRequired};var cn=ln=Object(u.b)(({listingTabs:e})=>{var{activeTabName:t,scrollToTab:s}=e;return{activeTabName:t,scrollToTab:s}})(ln),pn=m.createProviderWrappedComponent(e=>a.a.createElement(cn,e)),dn=e=>{var t=window.DP.urls.proxySellerContact;return p.a.ajax({method:"POST",url:t,data:e,beforeSend:e=>{e.setRequestHeader("X-CSRF-TOKEN",p()('meta[name="csrf-token"]').attr("content"))}})},hn=e=>{var t=window.DP.urls.proxyContact;return p.a.ajax({method:"POST",url:t,data:e,beforeSend:e=>{e.setRequestHeader("X-CSRF-TOKEN",p()('meta[name="csrf-token"]').attr("content"))}})},un=e=>{var t=window.DP.urls.proxyTroubleReachingOwner;return p.a.ajax({method:"POST",url:t,data:e,beforeSend:e=>{e.setRequestHeader("X-CSRF-TOKEN",p()('meta[name="csrf-token"]').attr("content"))}})},mn=window.DP.context.route;class gn extends a.a.Component{constructor(e){super(e),this.state={departmentValue:-1!==mn.indexOf("rental::")?"rental":"customer_service",emailValue:"",messageValue:"",displayedMessage:"",hasSucceed:!1,hasFailed:!1,isSubmitting:!1}}handleCloseClick(){this.resetState(),this.props.dispatch({type:"HIDE_CONTACT_FORM"})}handleButtonClick(){this.resetState(),this.setState({isSubmitting:!0});var e=this.state.emailValue,t=this.state.messageValue,s=this.state.departmentValue;hn({fromEmail:e,message:t,department:s}).then(e=>{this.props.gtmCategory&&this.props.gtmAction&&_e.a.pushToDataLayer("gtm-event",this.props.gtmCategory,this.props.gtmAction,"undefined"),this.props.gtmSubmitCallName&&_e.a.pushDynamicEvent(this.props.gtmSubmitCallName,window.DP.context.pageType),this.setState({displayedMessage:e.message,hasSucceed:!0,isSubmitting:!1,messageValue:"",emailValue:""})}).catch(e=>{this.setState({displayedMessage:e.responseJSON.message,errorField:e.responseJSON.field,isSubmitting:!1,hasFailed:!0})})}handleEmailValueChange(e){this.setState({emailValue:e.target.value})}handleMessageValueChange(e){this.setState({messageValue:e.target.value})}resetState(){this.setState({hasSucceed:!1,hasFailed:!1,displayedMessage:"",errorField:null})}render(){if(!this.props.isVisible)return null;var e=Ee.a.build("modal",{submitting:this.state.isSubmitting});return a.a.createElement("div",{className:e},a.a.createElement("div",{className:"modal__content contact-form"},this.renderCloseButton(),a.a.createElement("div",{className:"contact-form__title"},this.props.formTitle),this.state.displayedMessage?this.renderMessage():null,this.renderEmailField(),this.renderMessageField(),this.renderSubmitButton()))}renderCloseButton(){return a.a.createElement("div",{className:"modal__close-button",onClick:this.handleCloseClick.bind(this)},a.a.createElement(Pe.a,{className:"modal__close-button-icon",src:"/build/img/svg/icn-close.svg",cacheGetRequests:!0}))}renderEmailField(){var e=Ee.a.build("contact-form__group",{invalid:"from"===this.state.errorField});return a.a.createElement("div",{className:e},a.a.createElement("label",{className:"contact-form__label"},this.props.emailLabel,a.a.createElement("input",{className:"contact-form__field",placeholder:this.props.emailPlaceholder,value:this.state.emailValue,onChange:this.handleEmailValueChange.bind(this)})))}renderMessageField(){var e=Ee.a.build("contact-form__group",{invalid:"message"===this.state.errorField});return a.a.createElement("div",{className:e},a.a.createElement("label",{className:"contact-form__label"},this.props.messageLabel,a.a.createElement("textarea",{className:"contact-form__field contact-form__field--message",placeholder:this.props.messagePlaceholder,value:this.state.messageValue,rows:"8",onChange:this.handleMessageValueChange.bind(this)})))}renderSubmitButton(){var e=null,t="button button--full-width button--arrow";return e=this.state.isSubmitting?a.a.createElement("button",{className:t},a.a.createElement("div",{className:"button__content"},a.a.createElement(we.a,null))):a.a.createElement("button",{onClick:this.handleButtonClick.bind(this),className:t},this.props.buttonLabel),a.a.createElement("div",{className:"contact-form__group"},e)}renderMessage(){var e=Ee.a.build("contact-form__message",{isError:this.state.hasFailed,isSuccess:this.state.hasSucceed});return a.a.createElement("div",{className:e},this.state.displayedMessage)}}gn.propTypes={dispatch:ve.PropTypes.func.isRequired,isVisible:ve.PropTypes.bool,buttonLabel:ve.PropTypes.string.isRequired,emailLabel:ve.PropTypes.string.isRequired,emailPlaceholder:ve.PropTypes.string.isRequired,messageLabel:ve.PropTypes.string.isRequired,messagePlaceholder:ve.PropTypes.string.isRequired,formTitle:ve.PropTypes.string.isRequired,gtmCategory:ve.PropTypes.string,gtmAction:ve.PropTypes.string,gtmSubmitCallName:ve.PropTypes.string};var _n=gn=Object(u.b)(({contactForm:e})=>{var{isVisible:t,gtmCategory:s,gtmAction:i,gtmSubmitCallName:a}=e;return{isVisible:t,gtmCategory:s,gtmAction:i,gtmSubmitCallName:a}})(gn),bn=m.createProviderWrappedComponent(e=>a.a.createElement(_n,e)),vn=s(32),yn=s.n(vn);class Tn extends a.a.Component{constructor(e){super(e),this.state={nameValue:"",emailValue:"",phoneValue:"",messageValue:"",departmentValue:this.props.departmentOptions[0].value,displayedMessage:"",errorField:null,hasSucceed:!1,hasFailed:!1,isSubmitting:!1}}handleButtonClick(){this.resetState(),this.setState({isSubmitting:!0});var{emailValue:e,messageValue:t,nameValue:s,phoneValue:i,departmentValue:a}=this.state;hn({fromEmail:e,message:t,name:s,phone:i,department:a}).then(e=>{this.handleSuccessfulFormGtmPush(),this.setState({displayedMessage:e.message,hasSucceed:!0,isSubmitting:!1,messageValue:"",emailValue:""})}).catch(e=>{this.setState({errorField:e.responseJSON.field,displayedMessage:e.responseJSON.message,isSubmitting:!1,hasFailed:!0})})}handleEmailValueChange(e){this.setState({emailValue:e.target.value})}handleMessageValueChange(e){this.setState({messageValue:e.target.value})}handlePhoneValueChange(e){this.setState({phoneValue:e.target.value})}handleNameValueChange(e){this.setState({nameValue:e.target.value})}handleDepartmentValueChange(e){this.setState({departmentValue:e.value}),window.Dropdown("hide")}resetState(){this.setState({hasSucceed:!1,hasFailed:!1,displayedMessage:"",errorField:null})}render(){var e=Ee.a.build("contact-us-form",{submitting:this.state.isSubmitting});return a.a.createElement("div",{className:e},a.a.createElement("div",{className:"contact-us-form__content"},a.a.createElement("h2",{className:"contact-us-form__title"},this.props.formTitle),this.state.displayedMessage?this.renderMessage():null,a.a.createElement("div",{className:"contact-us-form__columns"},a.a.createElement("div",{className:"contact-us-form__column"},this.renderDepartmentField(),this.renderNameField(),this.renderPhoneField(),this.renderEmailField()),a.a.createElement("div",{className:"contact-us-form__column"},this.renderMessageField())),a.a.createElement("div",{className:"contact-us-form__actions"},this.renderSubmitButton())))}renderNameField(){return this.renderField({name:"name",value:this.state.nameValue,label:this.props.nameLabel,placeholder:this.props.namePlaceholder,required:!1,changeCallback:this.handleNameValueChange})}renderPhoneField(){var e=Ee.a.build("contact-us-form__field",{invalid:"phone"===this.state.errorField});return a.a.createElement("div",{className:e},a.a.createElement("div",{className:"contact-us-form__field-header"},a.a.createElement("label",{className:"contact-us-form__field-label",htmlFor:"contact-us-phone"},this.props.phoneLabel)),a.a.createElement(yn.a,{mask:"(999) 999-9999",id:"contact-us-phone",className:"contact-us-form__field-input",placeholder:this.props.phonePlaceholder,onChange:this.handlePhoneValueChange.bind(this)}))}renderDepartmentField(){var e=Ee.a.build("contact-us-form__field",{invalid:"department"===this.state.errorField});return a.a.createElement("div",{className:e},a.a.createElement("div",{className:"contact-us-form__field-header"},a.a.createElement("label",{className:"contact-us-form__field-label"},this.props.departmentLabel),a.a.createElement("span",{className:"contact-us-form__field-required"},this.props.requiredLabel)),a.a.createElement(qa.a,{dropdownId:"contact-us-department-dropdown",options:this.props.departmentOptions,selected:this.state.departmentValue,onSelect:this.handleDepartmentValueChange.bind(this)}))}renderEmailField(){return this.renderField({name:"from",value:this.state.emailValue,label:this.props.emailLabel,placeholder:this.props.emailPlaceholder,required:!0,changeCallback:this.handleEmailValueChange})}renderMessageField(){var e=Ee.a.build("contact-us-form__field",{invalid:"message"===this.state.errorField});return a.a.createElement("div",{className:e},a.a.createElement("div",{className:"contact-us-form__field-header"},a.a.createElement("label",{className:"contact-us-form__field-label",htmlFor:"contact-us-message"},this.props.messageLabel),a.a.createElement("span",{className:"contact-us-form__field-required"},this.props.requiredLabel)),a.a.createElement("textarea",{className:"contact-us-form__field-textarea",id:"contact-us-message",value:this.state.messageValue,placeholder:this.props.messagePlaceholder,onChange:this.handleMessageValueChange.bind(this)}))}renderSubmitButton(){var e="button button--full-width button--arrow";return this.state.isSubmitting?a.a.createElement("button",{className:e},a.a.createElement("div",{className:"button__content"},a.a.createElement(we.a,null))):a.a.createElement("button",{onClick:this.handleButtonClick.bind(this),className:e},this.props.buttonLabel)}renderField({name:e,value:t,label:s,placeholder:i,required:r,changeCallback:n}){var o=Ee.a.build("contact-us-form__field",{invalid:this.state.errorField===e}),l="contact-us-".concat(e);return a.a.createElement("div",{className:o},a.a.createElement("div",{className:"contact-us-form__field-header"},a.a.createElement("label",{className:"contact-us-form__field-label",htmlFor:l},s),r?a.a.createElement("span",{className:"contact-us-form__field-required"},this.props.requiredLabel):""),a.a.createElement("input",{id:l,className:"contact-us-form__field-input",placeholder:i,value:t,onChange:n.bind(this)}))}renderMessage(){var e=Ee.a.build("contact-us-form__message",{isError:this.state.hasFailed,isSuccess:this.state.hasSucceed});return a.a.createElement("div",{className:e},this.state.displayedMessage)}handleSuccessfulFormGtmPush(){this.props.gtmPushClass?_e.a.pushToDataLayer("gtm-event","ContactUsPage","Click_Email","Email_Submit"):_e.a.pushToDataLayer("gtm-event","ContactUs","Send_ContactForm","undefined")}}Tn.propTypes={emailLabel:ve.PropTypes.string.isRequired,emailPlaceholder:ve.PropTypes.string.isRequired,messageLabel:ve.PropTypes.string.isRequired,messagePlaceholder:ve.PropTypes.string.isRequired,nameLabel:ve.PropTypes.string.isRequired,namePlaceholder:ve.PropTypes.string.isRequired,phoneLabel:ve.PropTypes.string.isRequired,phonePlaceholder:ve.PropTypes.string.isRequired,departmentLabel:ve.PropTypes.string.isRequired,requiredLabel:ve.PropTypes.string.isRequired,buttonLabel:ve.PropTypes.string.isRequired,formTitle:ve.PropTypes.string.isRequired,gtmPushClass:ve.PropTypes.string,departmentOptions:ve.PropTypes.arrayOf(ve.PropTypes.shape({label:ve.PropTypes.string.isRequired,value:ve.PropTypes.string.isRequired})).isRequired};var fn=Tn,Pn=s(195),En=s(2);function wn(){var e=Sn(["\n    position: fixed;\n    display: flex;\n    top: 0;\n    left: 0;\n    z-index: 10000;\n    align-items: center;\n    justify-content: center;\n    width: 100vw;\n\n    .children-container {\n        position: relative;\n    }\n"]);return wn=function(){return e},e}function Cn(){var e=Sn(["\n    position: fixed;\n    z-index: 10000;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(0, 0, 0, 0.75);\n"]);return Cn=function(){return e},e}function Sn(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var Rn=En.default.div(Cn()),Nn=En.default.div(wn()),kn=document.querySelector("html"),Ln=({children:e,showModal:t})=>{var[s,r]=Object(i.useState)(0!==t);Object(i.useEffect)(()=>r(0!==t),[t]),Object(i.useEffect)(()=>{kn.style.overflow=s?"hidden":"auto"},[s]);return s?a.a.createElement(a.a.Fragment,null,a.a.createElement(Rn,null),a.a.createElement(Nn,null,a.a.createElement("div",{className:"children-container"},a.a.createElement("div",{className:"close",onClick:()=>{r(!1)}},a.a.createElement(Pe.a,{className:"close-button-icon",src:"/build/img/svg/icn-close-thin.svg",cacheGetRequests:!0})),e))):null};Ln.propTypes={children:ve.PropTypes.object,modalVisible:ve.PropTypes.bool};var On=Ln,qn=s(87);class xn extends a.a.Component{constructor(e){super(e),this.state={firstnameValue:"",lastnameValue:"",phoneValue:"",displayMessage:"",hasSucceed:!1,hasFailed:!1,isSubmitting:!1,buttonLabel:this.props.buttonLabel,bestTimeCallValue:this.renderDefaultToCallMeValue()}}handleButtonClick(){this.resetState(),this.setState({isSubmitting:!0});var e=this.props.leadSource,t=this.state.firstnameValue,s=this.state.lastnameValue,i=this.state.phoneValue.replace(/\D/g,""),a=this.state.bestTimeCallValue,r=this.props.gtmId?"-".concat(this.props.gtmId):"",n="sell-call-me-sell-cta-submit".concat(r);qn.a.sendCallbackRequest({firstname:t,lastname:s,phone:i,source:e,bestTimeCall:a,from:"pricing"}).then(e=>{this.setState({displayMessage:e.message,hasSucceed:!0,isSubmitting:!1,firstnameValue:"",lastnameValue:"",phoneValue:"",bestTimeCallValue:this.renderDefaultToCallMeValue()}),_e.a.pushDynamicEvent(n,window.DP.context.pageType)}).catch(e=>{this.setState({displayMessage:e.responseJSON.message,errorField:e.responseJSON.field,isSubmitting:!1,hasFailed:!0})})}resetState(){this.setState({hasSucceed:!1,hasFailed:!1,displayMessage:"",errorField:null})}handleFirstnameValueChange(e){this.setState({firstnameValue:e.target.value})}handleLastnameValueChange(e){this.setState({lastnameValue:e.target.value})}handlePhoneValueChange(e){this.setState({phoneValue:e.target.value})}handlebestTimeCallValueChange(e){this.setState({bestTimeCallValue:e.value}),window.Dropdown("hide")}renderDefaultToCallMeValue(){return this.props.bestTimeCallValues[0].value}renderFirstnameField(){var e=Ee.a.build("call-me-form-sell__group",{invalid:"firstname"===this.state.errorField,filled:this.state.firstnameValue});return a.a.createElement("div",{className:e},a.a.createElement("label",{className:"call-me-form-sell__label"},a.a.createElement("input",{className:"call-me-form-sell__field","data-cy":"call-me-firstName",maxLength:"80",onChange:this.handleFirstnameValueChange.bind(this),value:this.state.firstnameValue}),a.a.createElement("span",null,this.props.firstnameLabel)))}renderLastnameField(){var e=Ee.a.build("call-me-form-sell__group",{invalid:"lastname"===this.state.errorField,filled:this.state.lastnameValue});return a.a.createElement("div",{className:e},a.a.createElement("label",{className:"call-me-form-sell__label"},a.a.createElement("input",{className:"call-me-form-sell__field","data-cy":"call-me-lastName",maxLength:"80",onChange:this.handleLastnameValueChange.bind(this),value:this.state.lastnameValue}),a.a.createElement("span",null,this.props.lastnameLabel)))}renderPhoneField(){var e=Ee.a.build("call-me-form-sell__group",{invalid:"phone"===this.state.errorField,filled:this.state.phoneValue});return a.a.createElement("div",{className:e},a.a.createElement("label",{className:"call-me-form-sell__label"},a.a.createElement(yn.a,{className:"call-me-form-sell__field","data-cy":"call-me-phone",mask:"(999) 999-9999",onChange:this.handlePhoneValueChange.bind(this),type:"tel",value:this.state.phoneValue}),a.a.createElement("span",null,this.props.phoneLabel)))}renderBestTimeCallDropdown(){var e=Ee.a.build("call-me-form-sell__group",{invalid:"best_time_call"===this.state.errorField,filled:"label"!==this.state.bestTimeCallValue});return a.a.createElement("div",{className:e,"data-cy":"call-me-bestTime"},a.a.createElement(qa.a,{dropdownId:"best-time-call-dropdown",onSelect:this.handlebestTimeCallValueChange.bind(this),options:this.props.bestTimeCallValues,selected:this.state.bestTimeCallValue}))}renderSubmitButton(){var e;return e=this.state.isSubmitting?a.a.createElement("button",{className:"button button--full-width"},a.a.createElement("div",{className:"call-me-form-sell__button-content"},a.a.createElement(we.a,null))):a.a.createElement("button",{onClick:this.handleButtonClick.bind(this),className:"button button--full-width button--arrow","data-cy":"call-me-submit"},this.state.buttonLabel),a.a.createElement("div",{className:"call-me-form-sell__group call-me-form-sell__group--button"},e)}renderErrorMessage(){return a.a.createElement("div",{className:"call-me-form-sell__message call-me-form-sell__message--is-error","data-cy":"call-me-errorMsg"},this.state.displayMessage)}renderSuccessMessage(){return a.a.createElement(a.a.Fragment,null,a.a.createElement("p",{className:"thanks"},this.props.thanks),a.a.createElement("p",null,this.props.requestReceived[0]),a.a.createElement("p",null,this.props.requestReceived[1]))}renderForm(){return a.a.createElement("div",{className:"call-me-form-sell"},a.a.createElement("div",{className:"call-me-form-sell__column"},this.renderFirstnameField(),this.renderLastnameField()),a.a.createElement("div",{className:"call-me-form-sell__column"},this.renderPhoneField(),this.renderBestTimeCallDropdown()),this.state.hasFailed?this.renderErrorMessage():null,this.renderSubmitButton(),a.a.createElement("p",{className:"required"},this.props.required))}render(){return a.a.createElement(a.a.Fragment,null,this.state.hasSucceed?this.renderSuccessMessage():this.renderForm())}}xn.propTypes={bestTimeCallValues:ve.PropTypes.arrayOf(ve.PropTypes.shape({label:ve.PropTypes.string.isRequired,value:ve.PropTypes.string.isRequired})),buttonLabel:ve.PropTypes.string.isRequired,gtmId:ve.PropTypes.string,firstnameLabel:ve.PropTypes.string.isRequired,lastnameLabel:ve.PropTypes.string.isRequired,leadSource:ve.PropTypes.string.isRequired,phoneLabel:ve.PropTypes.string.isRequired,requestReceived:ve.PropTypes.array.isRequired,required:ve.PropTypes.string,thanks:ve.PropTypes.string.isRequired};var Mn=xn;function Dn(){return(Dn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e}).apply(this,arguments)}function An(){var e=Bn(["\n    display: inline-block;\n    padding: 10px 20px;\n    text-align: center;\n    background-color: #58bf26;\n    color: #fff;\n    font-size: 16px;\n    font-weight: 700;\n    border-radius: 8px;\n\n"]);return An=function(){return e},e}function In(){var e=Bn(["\n    .modal-content {\n        position: relative;\n        top: 10vh;\n        overflow: auto;\n        padding: 50px;\n        max-width: 560px;\n        width: 70vw;\n        background: #fff;\n        text-align: center;\n\n        @media(max-width: 640px) {\n            top: 0;\n            padding: 50px 25px;\n            height: 100vh;\n            width: 100vw;\n            max-width: none;\n        }\n    }\n\n    .close {\n        position: absolute;\n        top: calc(10vh + 15px);\n        right: 15px;\n        cursor: pointer;\n        z-index: 1;\n\n        @media(max-width: 640px) {\n            top: 15px;\n        }\n\n        .close-button-icon {\n            display: block;\n        }\n\n        svg {\n            width: 20px;\n            height: 20px;\n            transition: fill 0.2s ease;\n            fill: #b9b9b9;\n        }\n    }\n\n    .call-us,\n    .call-you,\n    .thanks {\n        font-size: 18px;\n        font-weight: 600;\n    }\n\n    .call-you {\n        margin-bottom: 30px;\n    }\n\n    .phone {\n        margin-top: 10px;\n        color: #00c6ff;\n        font-size: 24px;\n        font-weight: 700;\n        text-decoration: none;\n    }\n\n    .required {\n        margin-top: 10px;\n        font-size: 13px;\n    }\n\n    .or {\n        position: relative;\n        margin: 28px 0;\n        color: #ddd;\n\n        p {\n            position: relative;\n            display: inline-block;\n            z-index: 2;\n            padding: 0 20px;\n            background-color: #fff;\n            font-weight: 700;\n        }\n\n        hr {\n            position: absolute;\n            top: 1px;\n            z-index: 1;\n            height: 1px;\n            width: 100%;\n            border: none;\n            background-color: #ddd;\n        }\n    }\n"]);return In=function(){return e},e}function Bn(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var Fn=En.default.div(In()),jn=En.default.button(An()),Vn=0,Un=e=>{var[t,s]=Object(i.useState)(Vn),r="sell-visibility-cta-link-".concat(e.gtmId),n="sell-call-me-sell-phone-link-".concat(e.gtmId);return a.a.createElement(Fn,null,a.a.createElement(jn,{onClick:()=>{s(++Vn),"no-commission"===e.gtmID&&_e.a.pushDynamicEvent("sell-hero-cta-link",window.DP.context.pageType),_e.a.pushDynamicEvent(r,window.DP.context.pageType)}},e.ctaButton),a.a.createElement(On,{showModal:t},a.a.createElement("div",{className:"modal-content"},a.a.createElement("p",{className:"call-us"},e.callUs),a.a.createElement("a",{href:e.phoneNumberLink,onClick:()=>{_e.a.pushDynamicEvent(n,window.DP.context.pageType)},className:"phone"},e.phoneNumber),a.a.createElement("div",{className:"or"},a.a.createElement("p",null,e.or),a.a.createElement("hr",null)),a.a.createElement("p",{className:"call-you"},e.callYou),a.a.createElement(Mn,Dn({gtmId:e.gtmId},e)))))};Un.propTypes={ctaButton:ve.PropTypes.string,callUs:ve.PropTypes.string,callYou:ve.PropTypes.string,gtmId:ve.PropTypes.string,phoneNumber:ve.PropTypes.string,phoneNumberLink:ve.PropTypes.string,or:ve.PropTypes.string};var Hn=Un,$n=e=>{var t=window.DP.urls.login;window.location.href="".concat(t,"?").concat(e)},Gn=e=>({type:"SHOW_LISTING_INFORMATIONS_FORM",modalType:e});class zn extends a.a.Component{constructor(e){super(e),this.state={messageValue:"",displayedMessage:"",hasSucceed:!1,hasFailed:!1,isSubmitting:!1}}handleCloseClick(){this.resetState(),this.props.dispatch({type:"HIDE_SELLER_CONTACT_FORM"})}handleClickWarning(){window.DP.store.dispatch(Gn("warning")),this.handleCloseClick()}handleButtonClick(){var e=this.props.property.listingId,t=this.state.messageValue;this.resetState(),this.setState({isSubmitting:!0}),dn({listingId:e,message:t}).then(t=>{this.setState({displayedMessage:t.message,hasSucceed:!0,isSubmitting:!1,messageValue:""}),this.props.property.listingOfferAssist?(_e.a.pushToDataLayer("gtm-event","Listing_OAS","Contact_Submit","undefined"),_e.a.pushDynamicEvent("listing-oa-click-showing-send","Listing")):"basic"===this.props.property.listingGtmType&&_e.a.pushDynamicEvent("listing-basic-click-showing-send","Listing"),oa(e,"send_email_to_client")}).catch(t=>{401===t.status&&$n("do=contact-owner-list&code=".concat(e,"&url-back=").concat(encodeURIComponent(window.location.href))),this.setState({displayedMessage:t.responseJSON.message,isSubmitting:!1,hasFailed:!0})})}handleMessageValueChange(e){this.setState({messageValue:e.target.value})}resetState(){this.setState({hasSucceed:!1,hasFailed:!1,displayedMessage:""})}render(){if(!this.props.isVisible)return null;var e=Ee.a.build("seller-contact-form",{submitting:this.state.isSubmitting});return a.a.createElement("div",{className:e},a.a.createElement("div",{className:"seller-contact-form__content"},this.renderCloseButton(),a.a.createElement("div",{className:"seller-contact-form__title"},this.props.formTitle),this.state.displayedMessage?this.renderMessage({isSuccess:this.state.hasSucceed,isError:this.state.hasFailed,displayedMessage:this.state.displayedMessage}):null,a.a.createElement("div",{className:"seller-contact-form__info"},this.renderForm(),this.renderProperty()),this.renderSecurityWarning(),this.renderSubmitButton()))}renderForm(){return a.a.createElement("div",{className:"seller-contact-form__info-form"},this.renderMessageField(),a.a.createElement("div",{className:"seller-contact-form__disclaimer"},this.props.disclaimerText))}renderSecurityWarning(){if(window.DP.isRental)return a.a.createElement("div",{className:"seller-contact-form__disclaimer"},a.a.createElement("div",{className:"seller-contact-form__disclaimer-title"},a.a.createElement(Pe.a,{src:"/build/img/svg/icn-exclamation-mark.svg",cacheGetRequests:!0}),a.a.createElement("span",null,this.props.warningTitle)),a.a.createElement("div",{className:"seller-contact-form__disclaimer-content"},this.props.warningNote,a.a.createElement("span",{className:"seller-contact-form__disclaimer-link",onClick:this.handleClickWarning.bind(this)},this.props.warningLinkLabel)))}renderProperty(){return a.a.createElement("div",{className:"seller-contact-form__info-property"},a.a.createElement("div",{className:"seller-contact-form__info-property-photo"},a.a.createElement("img",{className:"seller-contact-form__info-property-photo-item",src:this.props.property.photoUrl})),a.a.createElement("div",{className:"seller-contact-form__property-info"},a.a.createElement("div",{className:"seller-contact-form__property-info-price"},this.props.property.price),a.a.createElement("div",{className:"seller-contact-form__property-info-city"},this.props.property.city)))}renderCloseButton(){return a.a.createElement("div",{className:"seller-contact-form__close-button",onClick:this.handleCloseClick.bind(this)},a.a.createElement(Pe.a,{className:"seller-contact-form__close-button-icon",src:"/build/img/svg/icn-close.svg",cacheGetRequests:!0}))}renderMessageField(){var e=Ee.a.build("seller-contact-form__group",{invalid:!1});return a.a.createElement("div",{className:e},a.a.createElement("label",{className:"seller-contact-form__label"},this.props.messageLabel),a.a.createElement("textarea",{rows:"8",value:this.state.messageValue,placeholder:this.props.messagePlaceholder,onChange:this.handleMessageValueChange.bind(this),className:"seller-contact-form__field"}))}renderSubmitButton(){var e=null,t="button button--full-width button--arrow";return e=this.state.isSubmitting?a.a.createElement("button",{className:t},a.a.createElement("div",{className:"button__content"},a.a.createElement(we.a,null))):a.a.createElement("button",{onClick:this.handleButtonClick.bind(this),className:t},this.props.buttonLabel),a.a.createElement("div",{className:"seller-contact-form__group"},e)}renderMessage({isError:e,isSuccess:t,displayedMessage:s}){var i=Ee.a.build("seller-contact-form__message",{isError:e,isSuccess:t});return a.a.createElement("div",{className:i},s)}}zn.propTypes={dispatch:ve.PropTypes.func.isRequired,isVisible:ve.PropTypes.bool,buttonLabel:ve.PropTypes.string.isRequired,disclaimerText:ve.PropTypes.string.isRequired,messageLabel:ve.PropTypes.string.isRequired,messagePlaceholder:ve.PropTypes.string.isRequired,formTitle:ve.PropTypes.string.isRequired,property:ve.PropTypes.shape({listingId:ve.PropTypes.string.isRequired,photoUrl:ve.PropTypes.string.isRequired,city:ve.PropTypes.string.isRequired,price:ve.PropTypes.string,listingOfferAssist:ve.PropTypes.bool,listingGtmType:ve.PropTypes.string}).isRequired,warningLinkLabel:ve.PropTypes.string.isRequired,warningTitle:ve.PropTypes.string.isRequired,warningNote:ve.PropTypes.string.isRequired};var Wn=zn=Object(u.b)(({sellerContactForm:e})=>{var{isVisible:t}=e;return{isVisible:t}})(zn),Kn=m.createProviderWrappedComponent(e=>a.a.createElement(Wn,e)),Yn=e=>{var t=window.DP.urls.proxyPostLead;return p.a.ajax({method:"POST",url:t,data:e,beforeSend:e=>{e.setRequestHeader("X-CSRF-TOKEN",p()('meta[name="csrf-token"]').attr("content"))}})};class Xn extends a.a.Component{constructor(e){super(e),this.state={firstnameValue:"",lastnameValue:"",emailValue:"",phoneNumberValue:"",interestValue:"",sellValue:"",messageValue:"",displayedMessage:"",errorField:null,hasSucceed:!1,hasFailed:!1,isSubmitting:!1}}handleCloseClick(){this.resetState(),this.props.dispatch({type:"HIDE_LISTING_CONTACT_FORM"})}handleFormSubmit(e){e.preventDefault(),this.resetState(),this.setState({isSubmitting:!0}),this.ignoreMessage()&&this.setState({messageValue:""}),"component-right-side"===this.props.version?this.handleSubmitLead():this.handleSubmitMessage()}handleSubmitMessage(){var{firstnameValue:e,lastnameValue:t,emailValue:s,phoneNumberValue:i,interestValue:a,sellValue:r}=this.state,n=this.renderInputMessageWithListingUrl(),o=this.props.department,l=this.props.listingCity,c=this.props.listingPrice;hn({firstname:e,lastname:t,fromEmail:s,phone:i,interest:a,sell:r,message:n,department:o,listingCity:l,listingPrice:c}).then(e=>{var t="book_showing"===a?"listing-ddf-contact-showing":"listing-ddf-contact-information";this.pushGtmDataLayer(t),this.setSuccessStateFromResponse(e)}).catch(e=>{this.setErrorStateFromResponse(e)})}handleSubmitLead(){var{listingCity:e,listingPrice:t}=this.props,{firstnameValue:s,lastnameValue:i,emailValue:a,phoneNumberValue:r,interestValue:n,sellValue:o}=this.state,l=this.renderInputMessageWithListingUrl(),c=this.getLeadSource();Yn({email:a,interest:n,message:l,firstname:s,lastname:i,phone:r.replace(/\D/g,""),sell:o,source:c,sourceDescription:c,listingCity:e,listingPrice:t}).then(e=>{var t="book_showing"===n?"listing-lead-contact-showing":"listing-lead-contact-information";this.pushGtmDataLayer(t),this.setSuccessStateFromResponse(e)}).catch(e=>{this.setErrorStateFromResponse(e)})}handleEmailValueChange(e){this.setState({emailValue:e.target.value})}handleMessageValueChange(e){this.setState({messageValue:e.target.value})}handlePhoneNumberValueChange(e){this.setState({phoneNumberValue:e.target.value})}handleFirstnameValueChange(e){this.setState({firstnameValue:e.target.value})}handleLastnameValueChange(e){this.setState({lastnameValue:e.target.value})}handleInterestValueChange(e){this.setState({interestValue:e.value}),window.Dropdown("hide")}handleSellValueChange(e){this.setState({sellValue:e.value}),this.setSellLabel(e.value),window.Dropdown("hide")}pushGtmDataLayer(e){var{gtmCategory:t}=this.props;_e.a.pushDynamicEvent(e,t)}setSellLabel(e){switch(e){case"sell_yes":this.sellLabel="yes";break;default:this.sellLabel="no"}this.setState({sellLabel:this.sellLabel})}setErrorStateFromResponse(e){this.setState({errorField:e.responseJSON.field,displayedMessage:e.responseJSON.message,isSubmitting:!1,hasFailed:!0})}setSuccessStateFromResponse(e){this.setState({displayedMessage:e.message,hasSucceed:!0,isSubmitting:!1,firstnameValue:"",lastnameValue:"",emailValue:"",phoneNumberValue:"",interestValue:"",sellValue:"",messageValue:""})}ignoreMessage(){return("more_information"!==this.state.interestValue||""===this.state.interestValue)&&(this.props.isDDFListing||this.props.isIDXListing||"component-right-side"===this.props.version)}getLeadSource(){return this.props.isDDFListing||this.props.isIDXListing?"DDF form":"Listing form"}resetState(){this.setState({hasSucceed:!1,hasFailed:!1,displayedMessage:"",errorField:null})}render(){if("component-right-side"!==this.props.version&&"Content"===this.props.origin&&!this.props.isVisible)return null;var e=Ee.a.build("listing-contact-form",{submitting:this.state.isSubmitting}),t=Ee.a.build("listing-contact-form__content",{"component-right-side":"component-right-side"===this.props.version});return a.a.createElement("div",{className:t},a.a.createElement("form",{className:e},this.renderCloseButton(),a.a.createElement("div",{className:"listing-contact-form__title"},this.props.formTitle),this.state.displayedMessage?this.renderMessage():null,this.renderFirstnameField(),this.renderLastnameField(),this.renderEmailField(),this.renderPhoneField(),this.renderInterestField(),this.renderSellField(),this.renderMessageField(),this.renderSubmitButton()))}renderFirstnameField(){return this.renderField({name:"firstname",value:this.state.firstnameValue,label:this.props.firstnameLabel,placeholder:this.props.firstnamePlaceholder,required:!0,changeCallback:this.handleFirstnameValueChange})}renderLastnameField(){return this.renderField({name:"lastname",value:this.state.lastnameValue,label:this.props.lastnameLabel,placeholder:this.props.lastnamePlaceholder,required:!0,changeCallback:this.handleLastnameValueChange})}renderEmailField(){return this.renderField({name:"from",value:this.state.emailValue,label:this.props.emailLabel,placeholder:this.props.emailPlaceholder,required:!0,changeCallback:this.handleEmailValueChange})}renderPhoneField(){return this.renderField({name:"phone",value:this.state.phoneNumberValue,label:this.props.phoneNumberLabel,placeholder:this.props.phoneNumberPlaceholder,required:!0,changeCallback:this.handlePhoneNumberValueChange})}renderInterestField(){var e=Ee.a.build("listing-contact-form__field",{invalid:"interest"===this.state.errorField});return a.a.createElement("label",{className:e},a.a.createElement("div",{className:"listing-contact-form__label"},this.props.interestLabel),a.a.createElement("span",{className:"listing-contact-form__field-required"},this.props.requiredLabel),a.a.createElement(qa.a,{dropdownId:"listing_contact-interest-dropdown",options:this.props.interestOptions,placeholder:this.props.interestPlaceholder,selected:this.state.interestValue,onSelect:this.handleInterestValueChange.bind(this)}))}renderSellField(){var e=Ee.a.build("listing-contact-form__field",{invalid:"sell"===this.state.errorField});return a.a.createElement("label",{className:e},a.a.createElement("div",{className:"listing-contact-form__label"},this.props.sellLabel),a.a.createElement("span",{className:"listing-contact-form__field-required"},this.props.requiredLabel),a.a.createElement(qa.a,{dropdownId:"listing_contact-sell-dropdown",options:this.props.sellOptions,placeholder:this.props.sellPlaceholder,selected:this.state.sellValue,onSelect:this.handleSellValueChange.bind(this)}))}renderMessageField(){if(this.ignoreMessage())return null;var e=Ee.a.build("listing-contact-form__field",{invalid:"message"===this.state.errorField});return a.a.createElement("label",{className:e},a.a.createElement("div",{className:"listing-contact-form__label"},this.props.messageLabel),a.a.createElement("span",{className:"listing-contact-form__field-required"},this.props.requiredLabel),a.a.createElement("textarea",{className:"listing-contact-form__input",id:"contact-us-message",name:"message",value:this.state.messageValue,rows:"6",placeholder:this.props.messagePlaceholder,onChange:this.handleMessageValueChange.bind(this)}))}renderField({name:e,value:t,label:s,placeholder:i,required:r,changeCallback:n}){var o=Ee.a.build("listing-contact-form__field",{invalid:this.state.errorField===e}),l="listing-contact-form-".concat(e);return a.a.createElement("label",{className:o},a.a.createElement("div",{className:"listing-contact-form__label"},s),r?a.a.createElement("span",{className:"listing-contact-form__field-required"},this.props.requiredLabel):"",a.a.createElement("input",{id:l,name:e,value:t,className:"listing-contact-form__input",placeholder:i,onChange:n.bind(this)}))}renderSubmitButton(){return this.state.isSubmitting?a.a.createElement("button",{className:"button button--full button--arrow"},a.a.createElement("div",{className:"button__content"},a.a.createElement(we.a,null))):a.a.createElement("button",{className:"button button--full button--arrow",type:"submit",onClick:this.handleFormSubmit.bind(this)},this.props.submit)}renderMessage(){var e=Ee.a.build("listing-contact-form__message",{isError:this.state.hasFailed,isSuccess:this.state.hasSucceed});return a.a.createElement("div",{className:e},this.state.displayedMessage)}renderInputMessageWithListingUrl(){return this.state.messageValue||this.ignoreMessage()?"".concat(this.state.messageValue,"\n\n        ").concat(this.props.listingUrl):this.state.messageValue}renderCloseButton(){return a.a.createElement("div",{className:"listing-contact-form__close-button",onClick:this.handleCloseClick.bind(this)},a.a.createElement(Pe.a,{className:"listing-contact-form__close-button-icon",src:"/build/img/svg/icn-close.svg",cacheGetRequests:!0}))}}Xn.propTypes={dispatch:ve.PropTypes.func.isRequired,isVisible:ve.PropTypes.bool,origin:ve.PropTypes.string.isRequired,firstnameLabel:ve.PropTypes.string.isRequired,firstnamePlaceholder:ve.PropTypes.string.isRequired,lastnameLabel:ve.PropTypes.string.isRequired,lastnamePlaceholder:ve.PropTypes.string.isRequired,emailLabel:ve.PropTypes.string.isRequired,emailPlaceholder:ve.PropTypes.string.isRequired,phoneNumberLabel:ve.PropTypes.string.isRequired,phoneNumberPlaceholder:ve.PropTypes.string.isRequired,interestLabel:ve.PropTypes.string.isRequired,interestPlaceholder:ve.PropTypes.string.isRequired,interestOptions:ve.PropTypes.arrayOf(ve.PropTypes.shape({label:ve.PropTypes.string.isRequired,value:ve.PropTypes.string.isRequired})).isRequired,sellLabel:ve.PropTypes.string.isRequired,sellPlaceholder:ve.PropTypes.string.isRequired,sellOptions:ve.PropTypes.arrayOf(ve.PropTypes.shape({label:ve.PropTypes.string.isRequired,value:ve.PropTypes.string.isRequired})).isRequired,messageLabel:ve.PropTypes.string.isRequired,messagePlaceholder:ve.PropTypes.string.isRequired,department:ve.PropTypes.string.isRequired,listingUrl:ve.PropTypes.string.isRequired,listingCity:ve.PropTypes.string.isRequired,listingPrice:ve.PropTypes.number.isRequired,formTitle:ve.PropTypes.string.isRequired,submit:ve.PropTypes.string.isRequired,requiredLabel:ve.PropTypes.string.isRequired,gtmCategory:ve.PropTypes.string,gtmAction:ve.PropTypes.string,isDDFListing:ve.PropTypes.bool,isIDXListing:ve.PropTypes.bool,version:ve.PropTypes.string};var Zn=Xn=Object(u.b)(({listingContactForm:e})=>{var{isVisible:t}=e;return{isVisible:t}})(Xn),Jn=m.createProviderWrappedComponent(e=>a.a.createElement(Zn,e)),Qn=e=>{var t=()=>{_e.a.pushDynamicEvent("right-side-".concat(e.id,"-oa-email"),window.DP.context.pageType)},s=()=>{_e.a.pushDynamicEvent("right-side-".concat(e.id,"-oa-phone-number"),window.DP.context.pageType)};return a.a.createElement("div",{className:"listing-contact__action--submit--content"},a.a.createElement("p",{className:"listing-contact__action--submit__title"},e.labels.sections.offer_assist.title),e.labels.sections.offer_assist.phone.value?a.a.createElement("div",{className:"listing-contact__action--submit--phone"},a.a.createElement(Pe.a,{src:"/build/img/svg/icn-contact-phone.svg",cacheGetRequests:!0}),a.a.createElement("div",null,a.a.createElement("span",{className:"listing-contact__action--submit--phone__title"},e.labels.sections.offer_assist.phone.label),a.a.createElement("span",null,a.a.createElement("a",{className:"listing-contact__action--submit--phone__value",href:e.labels.sections.offer_assist.phone.link,onClick:s},e.labels.sections.offer_assist.phone.value)))):null,e.labels.sections.offer_assist.fax.value?a.a.createElement("div",{className:"listing-contact__action--submit--fax"},a.a.createElement(Pe.a,{src:"/build/img/svg/icn-contact-fax.svg",cacheGetRequests:!0}),a.a.createElement("div",null,a.a.createElement("span",{className:"listing-contact__action--submit--fax__title"},e.labels.sections.offer_assist.fax.label),a.a.createElement("span",null,e.labels.sections.offer_assist.fax.value))):null,e.labels.sections.offer_assist.email.value?a.a.createElement("div",{className:"listing-contact__action--submit--mail"},a.a.createElement(Pe.a,{src:"/build/img/svg/icn-contact-mail.svg",cacheGetRequests:!0}),a.a.createElement("div",null,a.a.createElement("span",{className:"listing-contact__action--submit--mail__title"},e.labels.sections.offer_assist.email.label),a.a.createElement("span",null,a.a.createElement("a",{className:"listing-contact__action--submit--mail__value",href:"mailto:".concat(e.labels.sections.offer_assist.email.value),onClick:t},e.labels.sections.offer_assist.email.value)))):null)};Qn.propTypes={id:ve.PropTypes.string.isRequired,labels:ve.PropTypes.object.isRequired};var eo=Qn;class to extends a.a.Component{componentDidMount(){window.location=location.pathname+"/contact-seller"}render(){return a.a.createElement("span",null)}}var so=to,io=e=>a.a.createElement("div",{className:"listing-contact__action--submit--content"},a.a.createElement("p",null,a.a.createElement("a",{className:"link link--arrow",href:e.url,onClick:()=>{_e.a.pushDynamicEvent("right-side-showing-book-online",window.DP.context.pageType)},target:"_self"},e.link)));io.propTypes={link:ve.PropTypes.string.isRequired,url:ve.PropTypes.string.isRequired};var ao=io,ro=e=>a.a.createElement("div",{className:"listing-contact__action--submit--content"},a.a.createElement("p",null,e.text));ro.propTypes={text:ve.PropTypes.string.isRequired};var no=ro,oo=e=>a.a.createElement("div",{className:"link link--arrow",onClick:()=>{e.handleSwitchUser(e.id)}},e.title);oo.propTypes={handleSwitchUser:ve.PropTypes.func.isRequired,id:ve.PropTypes.string.isRequired,title:ve.PropTypes.string.isRequired};var lo=oo,co=e=>a.a.createElement("div",{className:"listing-contact__action--book--content"},a.a.createElement("p",{className:"listing-contact__action--content__text"},e.labels.sections.user_choice.intro),a.a.createElement(lo,{handleSwitchUser:e.handleSwitchUser,id:"buyer",title:e.labels.sections.user_choice.buyer}),a.a.createElement(lo,{handleSwitchUser:e.handleSwitchUser,id:"agent",title:e.labels.sections.user_choice.agent}));co.propTypes={handleSwitchUser:ve.PropTypes.func.isRequired,labels:ve.PropTypes.object.isRequired};var po=co,ho=e=>a.a.createElement("div",{className:"link link--arrow",onClick:()=>{e.handleSelectRequest(e.status)}}," ",e.response);ho.propTypes={response:ve.PropTypes.string.isRequired,status:ve.PropTypes.bool.isRequired,handleSelectRequest:ve.PropTypes.func.isRequired};var uo=ho,mo=e=>a.a.createElement("div",{className:"listing-contact__action--book--content"},a.a.createElement("p",{className:"listing-contact__action--content__text"},e.labels.sections.work_with_agent.intro),a.a.createElement(uo,{handleSelectRequest:e.handleSelectRequest,status:!0,response:e.labels.sections.work_with_agent.yes}),a.a.createElement(uo,{handleSelectRequest:e.handleSelectRequest,status:!1,response:e.labels.sections.work_with_agent.no}));mo.propTypes={labels:ve.PropTypes.object.isRequired,handleSelectRequest:ve.PropTypes.func.isRequired};var go=mo;class _o extends a.a.Component{constructor(e){super(e),this.state={user:"",userWorkWithAgent:""}}switchUser(e){this.setState({user:e}),this.pushGtmEvent(e)}handleSelectRequest(e){this.setState({userWorkWithAgent:e});var t=e?"yes":"no";this.pushGtmEvent(t)}pushGtmEvent(e){var{id:t}=this.props;_e.a.pushDynamicEvent("right-side-".concat(t,"-click-").concat(e),window.DP.context.pageType)}renderContactForm(){var{listingContactFormProps:e,origin:t}=this.props;return a.a.createElement("div",{className:"listing-contact__content__form"},a.a.createElement(Jn,{department:e.department,emailLabel:e.emailLabel,emailPlaceholder:e.emailPlaceholder,formTitle:e.formTitle,gtmAction:e.gtmAction,gtmCategory:e.gtmCategory,interestLabel:e.interestLabel,interestOptions:e.interestOptions,interestPlaceholder:e.interestPlaceholder,isDDFListing:e.isDDFListing,isIDXListing:e.isIDXListing,isVisible:e.isVisible,listingCity:e.listingCity,listingPrice:e.listingPrice,listingUrl:e.listingUrl,messageLabel:e.messageLabel,messagePlaceholder:e.messagePlaceholder,firstnameLabel:e.firstnameLabel,firstnamePlaceholder:e.firstnamePlaceholder,lastnameLabel:e.lastnameLabel,lastnamePlaceholder:e.lastnamePlaceholder,phoneNumberLabel:e.phoneNumberLabel,phoneNumberPlaceholder:e.phoneNumberPlaceholder,requiredLabel:e.requiredLabel,sellLabel:e.sellLabel,sellOptions:e.sellOptions,sellPlaceholder:e.sellPlaceholder,submit:e.submit,origin:t,version:"component-right-side"}))}renderContent(){var{user:e}=this.state,{id:t,labels:s,listing:i}=this.props;if(!e)return a.a.createElement(po,{handleSwitchUser:e=>this.switchUser(e),labels:s});if(i.is_ddf_idx||i.has_showing_service&&"offer"!==t)switch(this.state.userWorkWithAgent){case!0:return a.a.createElement(no,{text:this.props.labels.sections.work_with_agent.contact});case!1:break;default:if(this.hideIdxDdfForm())return a.a.createElement(no,{text:s.submit_offer.ddf_idx});if("buyer"===e)return a.a.createElement(go,{handleSelectRequest:this.handleSelectRequest.bind(this),labels:s})}switch(t){case"showing":return this.renderContentShowing();case"offer":return this.renderContentOffer();case"contact":default:return this.renderContentContact()}}renderContentContact(){var{id:e,labels:t,listing:s}=this.props,{user:i}=this.state;return s.is_ddf_idx?"buyer"===i?this.renderContactForm():a.a.createElement(no,{text:t.submit_offer.ddf_idx}):s.has_showing_service?"buyer"===i?this.renderContactForm():a.a.createElement(eo,{id:e,labels:t}):s.has_offer_assist?"buyer"===i?a.a.createElement(so,null):a.a.createElement(eo,{id:e,labels:t}):a.a.createElement(so,null)}renderContentOffer(){var{id:e,labels:t,listing:s}=this.props,{user:i}=this.state;return s.is_ddf_idx?"buyer"===i?this.renderContactForm():a.a.createElement(no,{text:t.submit_offer.ddf_idx}):s.has_offer_assist||s.has_showing_service?a.a.createElement(eo,{id:e,labels:t}):a.a.createElement(so,null)}renderContentShowing(){var{labels:e,listing:t}=this.props,{user:s}=this.state;return t.is_ddf_idx?"buyer"===s?this.renderContactForm():a.a.createElement(no,{text:e.book_showing.ddf_idx}):t.has_showing_service?"buyer"===s?this.renderContactForm():(_e.a.pushDynamicEvent("book-online-button-view",window.DP.context.pageType),a.a.createElement(ao,{link:e.book_showing.online.link,url:e.book_showing.online.url})):a.a.createElement(so,null)}hideIdxDdfForm(){var{ddfMinimalPrice:e,listingPrice:t,isDDFListing:s,isIDXListing:i}=this.props.listingContactFormProps,{user:a}=this.state;return(s||i)&&"buyer"===a&&t<e}render(){return a.a.createElement("div",{className:"listing-contact__panel__body"},this.renderContent())}}_o.propTypes={id:ve.PropTypes.string.isRequired,labels:ve.PropTypes.object.isRequired,listing:ve.PropTypes.object.isRequired,listingContactFormProps:ve.PropTypes.object.isRequired,origin:ve.PropTypes.string.isRequired};var bo=_o,vo=e=>{var t=e.active,s=Ee.a.build("button--plus",{active:t}),i=["button"].concat(s);return a.a.createElement("div",{className:i.join(" "),onClick:()=>{e.handleSwitchPanel(e.id)}},e.title,a.a.createElement("span",null))};vo.propTypes={active:ve.PropTypes.bool.isRequired,handleSwitchPanel:ve.PropTypes.func.isRequired,id:ve.PropTypes.string.isRequired,title:ve.PropTypes.string.isRequired};var yo=vo,To=e=>a.a.createElement("div",{className:"listing-contact__action-submit"},a.a.createElement(yo,e),e.active?a.a.createElement(bo,{id:e.id,labels:e.labels,listing:e.listing,listingContactFormProps:e.listingContactFormProps,origin:e.origin}):null);To.propTypes={active:ve.PropTypes.bool.isRequired,handleSwitchPanel:ve.PropTypes.func.isRequired,id:ve.PropTypes.string.isRequired,labels:ve.PropTypes.object.isRequired,listing:ve.PropTypes.object.isRequired,listingContactFormProps:ve.PropTypes.object.isRequired,origin:ve.PropTypes.string.isRequired,title:ve.PropTypes.string.isRequired};var fo=To;function Po(){return(Po=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e}).apply(this,arguments)}class Eo extends a.a.Component{constructor(e){super(e),this.state={activePanel:""}}isPanelActive(e){return e===this.state.activePanel}switchPanel(e){e===this.state.activePanel&&(e=""),this.setState({activePanel:e}),""!==e&&_e.a.pushDynamicEvent("right-side-".concat(e,"-view"),window.DP.context.pageType)}render(){var{labels:e}=this.props;return a.a.createElement("div",{className:"listing-contact__actions"},a.a.createElement(fo,Po({active:this.isPanelActive("showing"),handleSwitchPanel:e=>this.switchPanel(e),id:"showing",title:e.book_showing.title},this.props)),a.a.createElement(fo,Po({active:this.isPanelActive("offer"),handleSwitchPanel:e=>this.switchPanel(e),id:"offer",title:e.submit_offer.title},this.props)),a.a.createElement(fo,Po({active:this.isPanelActive("contact"),handleSwitchPanel:e=>this.switchPanel(e),id:"contact",title:e.contact.title},this.props)))}}Eo.propTypes={labels:ve.PropTypes.object.isRequired,listing:ve.PropTypes.object.isRequired,listingContactFormProps:ve.PropTypes.object.isRequired};var wo=Eo,Co=e=>{var t=e.scope;return a.a.createElement("div",{className:"listing-mortgage-calculator__ad js-mortgage-data__new-form-".concat(t.toLowerCase()),"data-category":"Listing","data-action":"View_".concat(t,"-MortgageCalculator")},a.a.createElement("p",{dangerouslySetInnerHTML:{__html:e.adZone}}))};Co.propTypes={adZone:ve.PropTypes.string.isRequired,scope:ve.PropTypes.string.isRequired};var So=Co,Ro=e=>a.a.createElement("div",{className:"listing-mortgage-calculator__form__tooltip"},a.a.createElement("span",{className:"listing-mortgage-calculator__form__tooltip__icon"},"i"),a.a.createElement("p",{className:"listing-mortgage-calculator__form__tooltip__content"},e.text));Ro.propTypes={active:ve.PropTypes.bool.isRequired,text:ve.PropTypes.string.isRequired};var No=Ro,ko=a.a.Fragment;class Lo extends a.a.Component{constructor(e){super(e),this.state={helpShow:!1}}handleShowHideHelp(){var{helpShow:e}=this.state;this.setState({helpShow:!e})}render(){var{children:e,help:t,label:s,typeInput:i}=this.props,{helpShow:r}=this.state,n=void 0!==i?"listing-mortgage-calculator__form__field--input":"";return a.a.createElement(ko,null,a.a.createElement("div",{className:"listing-mortgage-calculator__form__field ".concat(n)},a.a.createElement("label",null,s),a.a.createElement(No,{active:r,text:t,onClick:()=>this.handleShowHideHelp()}),e))}}Lo.propTypes={children:ve.PropTypes.object.isRequired,help:ve.PropTypes.string.isRequired,label:ve.PropTypes.string.isRequired,typeInput:ve.PropTypes.string};var Oo=Lo,qo=a.a.Fragment;class xo extends a.a.Component{constructor(e){super(e)}componentDidMount(){setTimeout(()=>{var e={start:[this.getSliderStartingPrice()],connect:"lower",range:this.getSliderDefaultSteps(),format:{to:Number,from:Number}};this.slider=qt.a.create(this.refs.slider,e),this.slider.on("slide",this.handleSliderSlide.bind(this)),window.DP.configSwitch.Gtm&&this.slider.on("change",this.handleSliderChange.bind(this))})}componentWillUnmount(){this.slider.off("update"),this.slider.off("slide")}getSliderStartingPrice(){var e=this.props.value,t=d.a.decodeValue(e);return"interest"!==this.props.id?Math.round(t/this.getSliderStep())*this.getSliderStep():e.toString().replace(",",".")}getSliderMaximumPrice(){switch(this.props.id){case"downPayment":return 5e5;case"interest":return 10;default:return 3e6}}getSliderStep(){switch(this.props.id){case"price":return 5e4;case"downPayment":return 1e4;default:return.1}}getGtmLabelBasedOnId(){switch(this.props.id){case"downPayment":return"DownPayment";case"interest":return"InterestRate";default:case"price":return"PurchasePrice"}}getGtmActionScope(){switch(this.props.scope){case"Costs":return"Cost";default:case"Description":return"Description"}}getSliderDefaultSteps(){var e={min:[0,this.getSliderStep()],max:[this.getSliderMaximumPrice()]};return"price"===this.props.id?(e["45%"]=[5e5,this.getSliderStep()],e["90%"]=[2e6,this.getSliderStep()]):"downPayment"===this.props.id&&(e["45%"]=[25e4,this.getSliderStep()]),e}encodeCurrencyValueDisplay(){var{id:e,value:t}=this.props,s="en"!==window.DP.lang;return"price"===e||"downPayment"===e?d.a.encodeCurrencyValue(t,{noDecimal:!0,noDollarSign:s}):t.toString().replace(",",".")}onInputChange(e){var t="price"===this.props.id||"downPayment"===this.props.id?d.a.decodeValue(e.target.value):e.target.value;this.props.onChange(this.props.id,t.toString()),this.slider.set(t),this.renderMonthlyMortgageCostsTableCell()}handleSliderSlide(e){var t=e[0],s="interest"===this.props.id?t.toFixed(2):t;this.onSliderChange(this.props.id,s)}handleSliderChange(){var e="Use_".concat(this.getGtmActionScope(),"-MortgageCalculator");_e.a.pushToDataLayer("gtm-event",window.DP.context.pageType,e,this.getGtmLabelBasedOnId())}onSliderChange(e,t){this.renderMonthlyMortgageCostsTableCell(),this.props.onChange(e,t.toString())}renderInputType(){return"interest"===this.props.id?"number":"text"}renderMonthlyMortgageCostsTableCell(){if("qc"===window.DP.province)return null;setTimeout(()=>{new ys.a(p()(".listing-mortgage-calculator__content")).calculate(p()(".mortgage-data__table__row__monthly-mortgage"))})}renderSlider(){return a.a.createElement("div",{className:"savings-calculator__slider"},a.a.createElement("div",{ref:"slider"}))}render(){return a.a.createElement(qo,null,a.a.createElement("input",{id:this.props.id,name:this.props.id,value:this.encodeCurrencyValueDisplay(),onChange:this.onInputChange.bind(this),type:this.renderInputType(),className:"listing-mortgage-calculator__form__input"}),this.renderSlider())}}xo.propTypes={id:ve.PropTypes.string.isRequired,onChange:ve.PropTypes.func.isRequired,value:ve.PropTypes.string.isRequired,scope:ve.PropTypes.string.isRequired};var Mo=xo,Do=a.a.Fragment;class Ao extends a.a.Component{onChange(e){this.props.onChange(this.props.id,e.value);var t="Click_".concat(this.getGtmActionScope(),"-MortgageCalculator");_e.a.pushToDataLayer("gtm-event",window.DP.context.pageType,t,this.getGtmLabelBasedOnId())}getGtmLabelBasedOnId(){switch(this.props.id){case"amortization":return"Amortization";case"term":return"Term";default:case"frequency":return"PaymentFrequency"}}getGtmActionScope(){switch(this.props.scope){case"Costs":return"Cost";default:case"Description":return"Description"}}render(){var{id:e,options:t,value:s}=this.props;return a.a.createElement(Do,null,a.a.createElement(qa.a,{onSelect:e=>this.onChange(e),dropdownId:e,selected:s,options:t}))}}Ao.propTypes={id:ve.PropTypes.string.isRequired,onChange:ve.PropTypes.func.isRequired,options:ve.PropTypes.arrayOf(ve.PropTypes.shape({label:ve.PropTypes.string.isRequired,value:ve.PropTypes.string.isRequired})).isRequired,value:ve.PropTypes.string.isRequired,scope:ve.PropTypes.string.isRequired};var Io=Ao,Bo=a.a.Fragment,Fo=e=>a.a.createElement(Bo,null,a.a.createElement("div",{className:"listing-mortgage-calculator__form"},a.a.createElement(Oo,{help:e.labels.fields.price.help,label:e.labels.fields.price.label,typeInput:"input"},a.a.createElement(Mo,{id:"price",onChange:e.onChange,value:e.price,scope:e.scope})),a.a.createElement(Oo,{help:e.labels.fields.downPayment.help,label:e.labels.fields.downPayment.label,typeInput:"input"},a.a.createElement(Mo,{id:"downPayment",onChange:e.onChange,value:e.downPayment,scope:e.scope})),a.a.createElement(Oo,{help:e.labels.fields.interest.help,label:e.labels.fields.interest.label,typeInput:"input"},a.a.createElement(Mo,{id:"interest",onChange:e.onChange,value:e.interest,scope:e.scope})),a.a.createElement(Oo,{help:e.labels.fields.amortization.help,label:e.labels.fields.amortization.label},a.a.createElement(Io,{id:"amortization",onChange:e.onChange,options:e.labels.fields.amortization.options,value:e.amortization,scope:e.scope})),a.a.createElement(Oo,{help:e.labels.fields.term.help,label:e.labels.fields.term.label},a.a.createElement(Io,{id:"term",onChange:e.onChange,options:e.labels.fields.term.options,value:e.term,scope:e.scope})),a.a.createElement(Oo,{help:e.labels.fields.frequency.help,label:e.labels.fields.frequency.label},a.a.createElement(Io,{id:"frequency",onChange:e.onChange,options:e.labels.fields.frequency.options,value:e.frequency,scope:e.scope}))));Fo.propTypes={amortization:ve.PropTypes.string.isRequired,downPayment:ve.PropTypes.string.isRequired,frequency:ve.PropTypes.string.isRequired,interest:ve.PropTypes.string.isRequired,labels:ve.PropTypes.object.isRequired,onChange:ve.PropTypes.func.isRequired,price:ve.PropTypes.string.isRequired,scope:ve.PropTypes.string.isRequired,term:ve.PropTypes.string.isRequired};var jo=Fo,Vo=s(413),Uo=s.n(Vo),Ho=s(102);class $o extends a.a.Component{constructor(e){super(e),this.state={triggerCountUpOnce:"Costs"===this.props.scope},this.triggerCountUp=this.handleScrollToItem.bind(this),this.startAmount=[],this.loadCounter=0}componentDidMount(){window.addEventListener("scroll",this.triggerCountUp)}handleScrollToItem(){this.state.triggerCountUpOnce||Ho.a.hasScrolledIntoView(".js-trigger-countup-".concat(this.props.scope,"-1"))&&(this.setState({triggerCountUpOnce:!0}),window.removeEventListener("scroll",this.triggerCountUp))}renderResults(){var e="en"===window.DP.lang,t=e?/(\$)/g:/(\s\$)/g;if(this.state.triggerCountUpOnce){this.loadCounter<=1&&this.loadCounter++;var s=this.props.amount,i=s.replace(/[\d\s\^$.,]+/g,"Â ").substr(1),r=Number(s.replace(/[^0-9.]+/g,"")),n=",",o=".",l="<sup>$</sup>",c=" ".concat(i);e||(r=Number(s.replace(/[^0-9,]+/g,"").split(",").join(".")),n=" ",o=",",l="",c="<sup>$</sup> ".concat(i));var d="qc"===window.DP.province?"0":r,h=a.a.createElement(Uo.a,{start:this.startAmount[this.props.resultKey],end:r,delay:0,duration:1.3,separator:n,decimals:0,decimal:o,prefix:l,suffix:c,onEnd:()=>this.startAmount[this.props.resultKey]=r},({countUpRef:e})=>a.a.createElement("div",null,a.a.createElement("span",{ref:e})));return this.loadCounter>1?a.a.createElement("div",{className:"listing-mortgage-calculator__result__amount","data-amount":d,dangerouslySetInnerHTML:{__html:s.replace(t,"<sup>$</sup>")}}):("qc"!==window.DP.province&&setTimeout(()=>{new ys.a(p()(".listing-mortgage-calculator__content")).calculate(p()(".mortgage-data__table__row__monthly-mortgage"))}),a.a.createElement("div",{className:"listing-mortgage-calculator__result__amount","data-amount":d},h))}}render(){return a.a.createElement("div",{className:"listing-mortgage-calculator__result js-trigger-countup-".concat(this.props.scope,"-").concat(this.props.resultKey)},a.a.createElement("div",{className:"listing-mortgage-calculator__result__label"},this.props.label),this.renderResults())}}$o.propTypes={amount:ve.PropTypes.string.isRequired,label:ve.PropTypes.string.isRequired,resultKey:ve.PropTypes.string.isRequired,scope:ve.PropTypes.string.isRequired};var Go=$o;class zo extends a.a.Component{constructor(e){super(e),this.state={showDisclaimer:!1},this.handleToggleDisclaimer=this.handleToggleDisclaimer.bind(this)}handleToggleDisclaimer(e){e.preventDefault(),this.setState({showDisclaimer:!this.state.showDisclaimer})}renderSpecialDisclaimer(){if(""!==this.props.specialDisclaimer)return a.a.createElement("p",{className:"listing-mortgage-calculator__disclaimer-information"},this.props.disclaimer.special[this.props.specialDisclaimer])}render(){var e=Ee.a.build("listing-mortgage-calculator__disclaimer",{open:this.state.showDisclaimer});return a.a.createElement("div",{className:e},this.renderSpecialDisclaimer(),a.a.createElement("h3",{className:"listing-mortgage-calculator__disclaimer-title"},a.a.createElement("a",{href:"#",className:"listing-mortgage-calculator__disclaimer-link",onClick:this.handleToggleDisclaimer},this.props.disclaimer.title)),a.a.createElement("p",{className:"listing-mortgage-calculator__disclaimer-content"},this.props.disclaimer.text))}}zo.propTypes={disclaimer:ve.PropTypes.object.isRequired,specialDisclaimer:ve.PropTypes.string.isRequired};var Wo=zo;function Ko(e,t){if(null==e)return{};var s,i,a=function(e,t){if(null==e)return{};var s,i,a={},r=Object.keys(e);for(i=0;i<r.length;i++)s=r[i],t.indexOf(s)>=0||(a[s]=e[s]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)s=r[i],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}var Yo=a.a.Fragment,Xo=e=>{var{adZone:t,amount:s,disclaimer:i,payments:r,specialDisclaimer:n}=e,o=Ko(e,["adZone","amount","disclaimer","payments","specialDisclaimer"]);return a.a.createElement(Yo,null,a.a.createElement("div",{className:"listing-mortgage-calculator__content"},a.a.createElement(jo,o),a.a.createElement(Go,{amount:s,label:o.labels.amount,resultKey:"1",scope:o.scope}),a.a.createElement(Go,{amount:r,label:o.labels.payments,resultKey:"2",scope:o.scope}),a.a.createElement(So,{adZone:t,scope:o.scope}),a.a.createElement(Wo,{disclaimer:i,specialDisclaimer:n})))};Xo.propTypes={adZone:ve.PropTypes.string.isRequired,amortization:ve.PropTypes.string.isRequired,amount:ve.PropTypes.string.isRequired,disclaimer:ve.PropTypes.object.isRequired,downPayment:ve.PropTypes.string.isRequired,frequency:ve.PropTypes.string.isRequired,interest:ve.PropTypes.string.isRequired,labels:ve.PropTypes.object.isRequired,onChange:ve.PropTypes.func.isRequired,payments:ve.PropTypes.string.isRequired,price:ve.PropTypes.string.isRequired,scope:ve.PropTypes.string.isRequired,term:ve.PropTypes.string.isRequired,specialDisclaimer:ve.PropTypes.string.isRequired};var Zo=Xo,Jo=a.a.Fragment,Qo=e=>{var t="ab"===window.DP.province,s=()=>{switch(e.scope){case"Costs":return e.logoUrl.cost;default:case"Description":return e.logoUrl.description}};return a.a.createElement(Jo,null,a.a.createElement("div",{className:"listing-box__title listing-mortgage-calculator__header"},t||e.isPurpleBricks&&!e.isAdToggleSwitchOn?a.a.createElement("h3",{className:"listing-mortgage-calculator__header__title"},e.title.alternate):a.a.createElement(Jo,null,a.a.createElement("h3",{className:"listing-mortgage-calculator__header__title--short"},e.title.short),a.a.createElement("h3",{className:"listing-mortgage-calculator__header__title--long"},e.title.long)),t||e.isPurpleBricks&&!e.isAdToggleSwitchOn?null:a.a.createElement("a",{href:s(),target:"_blank",className:"listing-mortgage-calculator__logo-link"},a.a.createElement("img",{src:e.logoPath,alt:"",className:"listing-mortgage-calculator__logo"}))))};Qo.propTypes={isAdToggleSwitchOn:ve.PropTypes.bool,isPurpleBricks:ve.PropTypes.bool,logoPath:ve.PropTypes.string.isRequired,logoUrl:ve.PropTypes.object.isRequired,title:ve.PropTypes.object.isRequired,scope:ve.PropTypes.string.isRequired};var el=Qo,tl=(e,t)=>({type:"SET_MORTGAGE_CALCULATOR_VALUE",id:e,value:t=((e,t)=>"price"===e||"downPayment"===e?parseInt(t,10)>0?t:"":"interest"===e?parseFloat(t)>=0?t:"":t)(e,t)});class sl extends a.a.Component{componentDidMount(){this.props.dispatch(tl("price",this.props.priceDefault)),this.props.dispatch(tl("downPayment",this.props.downPaymentDefault))}handleInputChange(e,t){this.props.dispatch(tl(e,t)),window.Dropdown("hide")}getFrequencyLabel(){var{frequency:e,labels:t}=this.props,s=t.fields.frequency.options;if(s){var i=s.filter((function(t){return t.value===e}));if(i)return i[0].label}return""}addFrequencyLabelToPayments(e){var t=this.getFrequencyLabel();return"".concat(e," ").concat(t)}renderPositiveNumbersOnly(e){return d.a.decodeValue(e)<0?this.renderFormatCurrencyValue("0",!1):e}renderFormatCurrencyValue(e,t){return d.a.encodeCurrencyValue(e,{noDecimal:t})}render(){var{adZone:e,amortization:t,downPayment:s,frequency:i,interest:r,isAdToggleSwitchOn:n,isPurpleBricks:o,labels:l,price:c,scope:p,term:d,specialDisclaimer:h}=this.props,u=re.a.calculateLoanAmount(c,s),m=this.renderPositiveNumbersOnly(this.renderFormatCurrencyValue(u,!0)),g=this.renderPositiveNumbersOnly(this.renderFormatCurrencyValue(re.a.calculatePayments(i,u,r,t),!0));return a.a.createElement("div",{className:"listing-box listing-mortgage-calculator"},a.a.createElement(el,{isAdToggleSwitchOn:n,isPurpleBricks:o,logoPath:l.logoPath,logoUrl:l.logoUrl,title:l.title,scope:p}),a.a.createElement(Zo,{adZone:e,amortization:t,amount:m,disclaimer:l.disclaimer,downPayment:s,frequency:i,interest:r,labels:l,onChange:(e,t)=>this.handleInputChange(e,t),payments:this.addFrequencyLabelToPayments(g),price:c,scope:p,term:d,specialDisclaimer:h}))}}sl.propTypes={specialDisclaimer:ve.PropTypes.string.isRequired,adZone:ve.PropTypes.string.isRequired,amortization:ve.PropTypes.string.isRequired,dispatch:ve.PropTypes.func.isRequired,downPayment:ve.PropTypes.string.isRequired,downPaymentDefault:ve.PropTypes.string.isRequired,frequency:ve.PropTypes.string.isRequired,interest:ve.PropTypes.string.isRequired,labels:ve.PropTypes.object.isRequired,price:ve.PropTypes.string.isRequired,priceDefault:ve.PropTypes.string.isRequired,scope:ve.PropTypes.string.isRequired,term:ve.PropTypes.string.isRequired,isAdToggleSwitchOn:ve.PropTypes.bool,isPurpleBricks:ve.PropTypes.bool},sl=Object(u.b)(({mortgageCalculator:e})=>{var{amortization:t,downPayment:s,frequency:i,interest:a,price:r,term:n}=e;return{amortization:t,downPayment:s,frequency:i,interest:a,price:r,term:n}})(sl);var il=m.createProviderWrappedComponent(e=>a.a.createElement(sl,e)),al=window.DP.context.route,rl="highway-subscribe-callbuyer";class nl extends a.a.Component{constructor(e){super(e),this.modalContent=a.a.createRef(),this.documentClick=this.handleDocumentClick.bind(this),this.state={departmentValue:-1!==al.indexOf("rental::")?"rental":"customer_service",emailValue:"",firstnameValue:"",lastnameValue:"",phoneValue:"",displayedMessage:"",hasSucceed:!1,hasFailed:!1,isSubmitting:!1,formTitle:this.props.formTitle,formText:this.props.formText,buttonLabel:this.props.buttonLabel,whenPlanningToSellValue:this.renderDefaultPlanningToSellValue()}}componentDidMount(){this.renderTextsBasedOnContext(),document.addEventListener("click",this.documentClick)}componentWillUnmount(){document.removeEventListener("click",this.documentClick)}handleCloseClick(){this.resetState(),this.props.dispatch({type:"HIDE_CALLBACK_FORM"})}handleDocumentClick(e){var t,s;!(null===(t=this.modalContent)||void 0===t||null===(s=t.current)||void 0===s?void 0:s.contains(e.target))&&e.target.classList.contains("js-modal-callback-form")&&this.handleCloseClick()}handleButtonClick(){this.resetState(),this.setState({isSubmitting:!0});var e=this.props.leadSource,t=this.state.emailValue,s=this.state.firstnameValue,i=this.state.lastnameValue,a=this.state.phoneValue.replace(/\D/g,""),r=this.state.whenPlanningToSellValue;qn.a.sendCallbackRequest({fromEmail:t,firstname:s,lastname:i,phone:a,source:e,whenPlanningToSell:r}).then(e=>{this.setState({displayedMessage:e.message,hasSucceed:!0,isSubmitting:!1,emailValue:"",firstnameValue:"",lastnameValue:"",phoneValue:"",whenPlanningToSellValue:this.renderDefaultPlanningToSellValue()}),_e.a.pushDynamicEvent(this.props.origin,"CallMeBackPage")}).catch(e=>{this.setState({displayedMessage:e.responseJSON.message,errorField:e.responseJSON.field,isSubmitting:!1,hasFailed:!0})})}handleEmailValueChange(e){this.setState({emailValue:e.target.value})}handleFirstnameValueChange(e){this.setState({firstnameValue:e.target.value})}handleLastnameValueChange(e){this.setState({lastnameValue:e.target.value})}handlePhoneValueChange(e){this.setState({phoneValue:e.target.value})}handleWhenPlanningToSellValueValueChange(e){this.setState({whenPlanningToSellValue:e.value}),window.Dropdown("hide")}resetState(){this.setState({hasSucceed:!1,hasFailed:!1,displayedMessage:"",errorField:null})}renderTextsBasedOnContext(){switch(this.props.origin){case"highway-subscribe-callhome":this.setState({formTitle:this.props.formTitleHome,formText:this.props.formTextHome,buttonLabel:this.props.buttonLabelHome});break;case"highway-subscribe-callseller":this.setState({formTitle:this.props.formTitleSell,formText:this.props.formTextSell,buttonLabel:this.props.buttonLabelSell});break;case rl:this.setState({formTitle:this.props.formTitleBuy,formText:this.props.formTextBuy,buttonLabel:this.props.buttonLabelBuy})}}renderDefaultPlanningToSellValue(){return this.props.origin===rl?null:this.props.whenPlanningToSellValues[0].value}render(){if(!this.props.isVisible)return null;var e=Ee.a.build("modal",{submitting:this.state.isSubmitting});return a.a.createElement("div",{className:"".concat(e," js-modal-callback-form"),onClick:this.handleDocumentClick.bind(this)},a.a.createElement("div",{className:"modal__content modal__content--big callback-form",ref:this.modalContent},this.renderCloseButton(),a.a.createElement("div",{className:"callback-form__title",dangerouslySetInnerHTML:{__html:this.state.formTitle}}),a.a.createElement("div",{className:"callback-form__text",dangerouslySetInnerHTML:{__html:this.state.formText}}),this.state.displayedMessage?this.renderMessage():null,a.a.createElement("div",{className:"callback-form__column"},this.renderFirstnameField(),this.renderLastnameField(),this.renderPhoneField(),this.renderEmailField(),this.renderWhenPlanningToSellDropdown(),this.renderSubmitButton())))}renderCloseButton(){return a.a.createElement("div",{className:"modal__close-button",onClick:this.handleCloseClick.bind(this)},a.a.createElement(Pe.a,{className:"modal__close-button-icon",src:"/build/img/svg/icn-close.svg",cacheGetRequests:!0}))}renderFirstnameField(){var e=Ee.a.build("callback-form__group",{invalid:"from"===this.state.errorField});return a.a.createElement("div",{className:e},a.a.createElement("label",null,a.a.createElement("span",{className:"callback-form__label"},this.props.firstnameLabel),a.a.createElement("input",{className:"callback-form__field",placeholder:this.props.firstnamePlaceholder,value:this.state.firstnameValue,maxLength:"80",onChange:this.handleFirstnameValueChange.bind(this)})))}renderLastnameField(){var e=Ee.a.build("callback-form__group",{invalid:"from"===this.state.errorField});return a.a.createElement("div",{className:e},a.a.createElement("label",null,a.a.createElement("span",{className:"callback-form__label"},this.props.lastnameLabel),a.a.createElement("input",{className:"callback-form__field",placeholder:this.props.lastnamePlaceholder,value:this.state.lastnameValue,maxLength:"80",onChange:this.handleLastnameValueChange.bind(this)})))}renderPhoneField(){var e=Ee.a.build("callback-form__group",{invalid:"from"===this.state.errorField});return a.a.createElement("div",{className:e},a.a.createElement("label",null,a.a.createElement("span",{className:"callback-form__label"},this.props.phoneLabel),a.a.createElement(yn.a,{type:"tel",mask:"(999) 999-9999",className:"callback-form__field",value:this.state.phoneValue,placeholder:this.props.phonePlaceholder,onChange:this.handlePhoneValueChange.bind(this)})))}renderEmailField(){var e=Ee.a.build("callback-form__group",{invalid:"from"===this.state.errorField});return a.a.createElement("div",{className:e},a.a.createElement("label",null,a.a.createElement("span",{className:"callback-form__label"},this.props.emailLabel),a.a.createElement("input",{className:"callback-form__field",placeholder:this.props.emailPlaceholder,value:this.state.emailValue,type:"email",maxLength:"80",onChange:this.handleEmailValueChange.bind(this)})))}renderWhenPlanningToSellDropdown(){if(this.props.origin===rl)return null;var e=Ee.a.build("callback-form__group",{invalid:"from"===this.state.errorField});return a.a.createElement("div",{className:e},a.a.createElement("label",null,a.a.createElement("span",{className:"callback-form__label"},this.props.whenPlanningToSellValues[0].label),a.a.createElement(qa.a,{dropdownId:"when-planning-to-sell-dropdown",options:this.props.whenPlanningToSellValues,selected:this.state.whenPlanningToSellValue,onSelect:this.handleWhenPlanningToSellValueValueChange.bind(this)})))}renderSubmitButton(){var e=null;return e=this.state.isSubmitting?a.a.createElement("button",{className:"button button--small button--arrow"},a.a.createElement("div",{className:"callback-form__button-content"},a.a.createElement(we.a,null))):a.a.createElement("button",{onClick:this.handleButtonClick.bind(this),className:"button button--small button--arrow"},this.state.buttonLabel),a.a.createElement("div",{className:"callback-form__group"},e)}renderMessage(){var e=Ee.a.build("callback-form__message",{isError:this.state.hasFailed,isSuccess:this.state.hasSucceed});return this.state.hasSucceed&&this.props.gtmCategory&&this.props.gtmAction&&_e.a.pushToDataLayer("gtm-event",this.props.gtmCategory,this.props.gtmAction,"undefined"),a.a.createElement("div",{className:e},this.state.displayedMessage)}}nl.propTypes={leadSource:ve.PropTypes.string.isRequired,dispatch:ve.PropTypes.func.isRequired,isVisible:ve.PropTypes.bool,buttonLabel:ve.PropTypes.string.isRequired,emailLabel:ve.PropTypes.string.isRequired,emailPlaceholder:ve.PropTypes.string.isRequired,firstnameLabel:ve.PropTypes.string.isRequired,firstnamePlaceholder:ve.PropTypes.string.isRequired,lastnameLabel:ve.PropTypes.string.isRequired,lastnamePlaceholder:ve.PropTypes.string.isRequired,phoneLabel:ve.PropTypes.string.isRequired,phonePlaceholder:ve.PropTypes.string.isRequired,formTitle:ve.PropTypes.string.isRequired,formText:ve.PropTypes.string.isRequired,formTitleHome:ve.PropTypes.string.isRequired,formTextHome:ve.PropTypes.string.isRequired,buttonLabelHome:ve.PropTypes.string.isRequired,formTitleSell:ve.PropTypes.string.isRequired,formTextSell:ve.PropTypes.string.isRequired,buttonLabelSell:ve.PropTypes.string.isRequired,formTitleBuy:ve.PropTypes.string.isRequired,formTextBuy:ve.PropTypes.string.isRequired,buttonLabelBuy:ve.PropTypes.string.isRequired,gtmCategory:ve.PropTypes.string,gtmAction:ve.PropTypes.string,origin:ve.PropTypes.string,whenPlanningToSellValues:ve.PropTypes.arrayOf(ve.PropTypes.shape({label:ve.PropTypes.string.isRequired,value:ve.PropTypes.string.isRequired}))};var ol=nl=Object(u.b)(({callbackForm:e})=>{var{isVisible:t,gtmCategory:s,gtmAction:i}=e;return{isVisible:t,gtmCategory:s,gtmAction:i}})(nl),ll=m.createProviderWrappedComponent(e=>a.a.createElement(ol,e)),cl=window.DP.isRental;class pl extends a.a.Component{constructor(e){super(e),this.state={nameValue:e.nameValue,emailValue:e.emailValue,phoneValue:"",problemTypeValue:this.renderDefaultProblemTypeValue(),messageValue:"",displayedMessage:"",errorField:null,hasSucceed:!1,hasFailed:!1,isSubmitting:!1,showField:e.isPurplebricks||cl}}handleCloseClick(){this.resetState(),this.props.dispatch({type:"HIDE_LISTING_INFORMATIONS_FORM"})}handleButtonClick(){this.resetState(),this.setState({isSubmitting:!0});var e=this.props.property.listingId,t=this.props.modalType,{nameValue:s,emailValue:i,phoneValue:a,problemTypeValue:r,messageValue:n}=this.state;un({listingId:e,name:s,email:i,phone:a,problemtype:r,message:n,modaltype:t,IS_RENTAL:cl}).then(e=>{this.setState({displayedMessage:e.message,hasSucceed:!0,isSubmitting:!1,nameValue:"",emailValue:"",phoneValue:"",messageValue:""})}).catch(e=>{this.setState({errorField:e.responseJSON.field,displayedMessage:e.responseJSON.message,isSubmitting:!1,hasFailed:!0})})}handleNameValueChange(e){this.setState({nameValue:e.target.value})}handleEmailValueChange(e){this.setState({emailValue:e.target.value})}handlePhoneValueChange(e){this.setState({phoneValue:e.target.value})}handleProblemTypeValueChange(e){this.setState({problemTypeValue:e.value}),window.Dropdown("hide")}handleMessageValueChange(e){this.setState({messageValue:e.target.value})}resetState(){this.setState({problemTypeValue:this.renderDefaultProblemTypeValue(),hasSucceed:!1,hasFailed:!1,displayedMessage:"",errorField:null})}render(){if(!this.props.isVisible)return null;var e=Ee.a.build("listing-information-form",{submitting:this.state.isSubmitting});return a.a.createElement("div",{className:e},a.a.createElement("div",{className:"listing-information-form__content"},this.renderCloseButton(),this.renderFormTitle(),a.a.createElement("div",{className:"listing-information-form__subtitle"},this.props.formSubtitle),this.state.displayedMessage?this.renderMessage({isSuccess:this.state.hasSucceed,isError:this.state.hasFailed,displayedMessage:this.state.displayedMessage}):null,a.a.createElement("div",{className:"listing-information-form__info"},this.renderForm()),this.renderSubmitButton()))}renderDefaultProblemTypeValue(){return"warning"!==this.props.modalType?this.props.problemTypeOptions[0].value:this.props.problemTypeOptionsWarning[0].value}renderForm(){return a.a.createElement("div",{className:"listing-information-form__info-form"},this.renderNameField(),this.renderEmailField(),this.renderPhoneField(),this.renderProblemType(),this.renderMessageField())}renderFormTitle(){var e="warning"!==this.props.modalType?this.props.formTitle:this.props.formTitleWarning;return a.a.createElement("div",{className:"listing-information-form__title"},e)}renderCloseButton(){return a.a.createElement("div",{className:"listing-information-form__close-button",onClick:this.handleCloseClick.bind(this)},a.a.createElement(Pe.a,{className:"listing-information-form__close-button-icon",src:"/build/img/svg/icn-close.svg",cacheGetRequests:!0}))}renderNameField(){return this.state.showField?this.renderField({name:"name",value:this.state.nameValue,label:this.props.nameLabel,placeholder:this.props.namePlaceholder,required:!1,changeCallback:this.handleNameValueChange}):null}renderEmailField(){return this.state.showField?this.renderField({name:"fromEmail",value:this.state.emailValue,label:this.props.emailLabel,placeholder:this.props.emailPlaceholder,required:!1,changeCallback:this.handleEmailValueChange}):null}renderPhoneField(){return this.state.showField?this.renderField({name:"phone",value:this.state.phoneValue,label:this.props.phoneLabel,placeholder:this.props.phonePlaceholder,required:!1,changeCallback:this.handlePhoneValueChange,mask:"(999) 999-9999"}):null}renderProblemType(){var e=Ee.a.build("listing-information-form__field",{invalid:"problem"===this.state.errorField});return a.a.createElement("div",{className:e},a.a.createElement("div",{className:"listing-information-form__dropdown-header"},a.a.createElement("label",{className:"listing-information-form__field-label"},this.props.problemSelectLabel),a.a.createElement("span",{className:"listing-information-form__dropdown-required"},this.props.requiredLabel)),a.a.createElement(qa.a,{dropdownId:"information-problemtype-dropdown",options:this.renderProblemTypeOptions(),selected:this.state.problemTypeValue,onSelect:this.handleProblemTypeValueChange.bind(this)}))}renderProblemTypeOptions(){return"warning"!==this.props.modalType?this.props.problemTypeOptions:this.props.problemTypeOptionsWarning}renderMessageField(){return this.props.isWithMessage?a.a.createElement("div",{className:"listing-information-form__field"},a.a.createElement("div",{className:"listing-information-form__field-header"},a.a.createElement("label",{className:"listing-information-form__field-label",htmlFor:"listing-information-message"},this.props.messageLabel)),a.a.createElement("textarea",{id:"listing-information-message",rows:"8",value:this.state.messageValue,placeholder:this.props.messagePlaceholder,onChange:this.handleMessageValueChange.bind(this),className:"listing-information-form__field-textarea"})):null}renderSubmitButton(){var e=null,t="button button--full-width button--arrow";return e=this.state.isSubmitting?a.a.createElement("button",{className:t},a.a.createElement("div",{className:"button__content"},a.a.createElement(we.a,null))):a.a.createElement("button",{onClick:this.handleButtonClick.bind(this),className:t},this.props.buttonLabel),a.a.createElement("div",{className:"listing-information-form__group"},e)}renderField({name:e,value:t,label:s,placeholder:i,required:r,changeCallback:n,mask:o=""}){var l="listing-information-".concat(e);return a.a.createElement("div",{className:"listing-information-form__field"},a.a.createElement("div",{className:"listing-information-form__field-header"},a.a.createElement("label",{className:"listing-information-form__field-label",htmlFor:l},s),r?a.a.createElement("span",{className:"listing-information-form__field-required"},this.props.requiredLabel):""),a.a.createElement(yn.a,{id:l,mask:o,className:"listing-information-form__field-input",placeholder:i,value:t,onChange:n.bind(this)}))}renderMessage({isError:e,isSuccess:t,displayedMessage:s}){var i=Ee.a.build("listing-information-form__message",{isError:e,isSuccess:t});return a.a.createElement("div",{className:i},s)}}pl.propTypes={dispatch:ve.PropTypes.func.isRequired,isVisible:ve.PropTypes.bool,isPurplebricks:ve.PropTypes.bool.isRequired,isWithMessage:ve.PropTypes.bool.isRequired,formTitle:ve.PropTypes.string.isRequired,formTitleWarning:ve.PropTypes.string.isRequired,formSubtitle:ve.PropTypes.string.isRequired,requiredLabel:ve.PropTypes.string.isRequired,nameLabel:ve.PropTypes.string.isRequired,namePlaceholder:ve.PropTypes.string.isRequired,nameValue:ve.PropTypes.string,emailLabel:ve.PropTypes.string.isRequired,emailPlaceholder:ve.PropTypes.string.isRequired,emailValue:ve.PropTypes.string,phoneLabel:ve.PropTypes.string.isRequired,phonePlaceholder:ve.PropTypes.string.isRequired,problemSelectLabel:ve.PropTypes.string.isRequired,messageLabel:ve.PropTypes.string.isRequired,messagePlaceholder:ve.PropTypes.string.isRequired,buttonLabel:ve.PropTypes.string.isRequired,property:ve.PropTypes.shape({listingId:ve.PropTypes.string.isRequired}).isRequired,problemTypeOptions:ve.PropTypes.arrayOf(ve.PropTypes.shape({label:ve.PropTypes.string.isRequired,value:ve.PropTypes.string.isRequired})).isRequired,problemTypeOptionsWarning:ve.PropTypes.arrayOf(ve.PropTypes.shape({label:ve.PropTypes.string.isRequired,value:ve.PropTypes.string.isRequired})).isRequired,modalType:ve.PropTypes.string.isRequired};var dl=pl=Object(u.b)(({listingTroubleReachingForm:e})=>{var{isVisible:t,modalType:s}=e;return{isVisible:t,modalType:s}})(pl),hl=m.createProviderWrappedComponent(e=>a.a.createElement(dl,e)),ul=/\{(\d+)\}(.+)/,ml=/\[([\d\*,]+)\](.+)/,gl=(e,t)=>{var s=((e,t)=>e.find(({value:e})=>"number"==typeof e?e===t:((e,t)=>{var[s,i]=e;return t>=s&&t<=i})(e,t)))(e.split("|").map((e,t)=>{var s=e.match(ul);if(s)return{value:parseInt(s[1],10),string:s[2]};var i,a=e.match(ml);return a?{value:(i=a[1],i.split(",").map(e=>"*"===e?1/0:parseInt(e,10))),string:a[2]}:{value:t+1,string:e}}),t);return s?s.string:""};class _l extends a.a.Component{render(){if(!this.props.initialListingsFetched||this.props.visibleInSearchListingCount>cr.MAX_IN_SEARCH_LISTING_COUNT)return null;var e=gl(this.props.listingsFound,this.props.visibleInSearchListingCount);return 0===this.props.visibleInSearchListingCount||null===this.props.visibleInSearchListingCount||void 0===this.props.visibleInSearchListingCount?a.a.createElement("div",{className:"search-map-listing-count"},gl(this.props.listingsFound,0)):a.a.createElement("div",{className:"search-map-listing-count"},a.a.createElement("span",{className:"search-results-listings-header__properties-found__number"},this.props.visibleInSearchListingCount),a.a.createElement("span",null," ".concat(e)))}}_l.propTypes={visibleInSearchListingCount:ve.PropTypes.number,initialListingsFetched:ve.PropTypes.bool.isRequired,listingsFound:ve.PropTypes.string.isRequired};var bl=_l=Object(u.b)(({searchMap:e})=>{var{visibleInSearchListingCount:t,initialListingsFetched:s}=e;return{visibleInSearchListingCount:t,initialListingsFetched:s}})(_l),vl=m.createProviderWrappedComponent(e=>a.a.createElement(bl,e)),yl=({searchBar:e,location:t,title:s})=>{var{searchTerms:r,searchTypes:n,searchSubTypes:o,searchRooms:l,searchBathrooms:c,searchPriceRange:p}=e,h=0===Ft(e),u=Ee.a.build("search-results-params",{["at-".concat(t)]:!0,empty:h}),[m,g]=Object(i.useState)(!1),[_,b]=Object(i.useState)(!1),[v,y]=Object(i.useState)(!1),T=!m&&!_&&!v,f=({title:e})=>!(!e||0===(null==e?void 0:e.length))&&a.a.createElement("div",{className:"search-results-params_title"},e),P=({terms:e})=>0!==(null==e?void 0:e.length)&&(g(!0),e.map(({uniqueId:e,name:t})=>a.a.createElement("li",{key:"term:".concat(e),className:"search-results-params__criteria"},t)).shift()),E=({optionType:e,searchBar:t})=>{var s=e.map(e=>C(e,t)).filter(Boolean);return 0!==s.length&&s.shift()},w=({selectedSubType:e,searchBar:t})=>(!e||!_)&&e.map(e=>S(e,t)),C=(e,t)=>{var{searchSubTypes:s}=t,i=jt(s.options,e.id);return jt(s.selected,e.id)===i&&(b(!0),a.a.createElement("li",{className:"search-results-params__criteria",key:"searchTypesPopoverOption:".concat(e.id)},e.name))},S=(e,t)=>{var{searchSubTypes:s}=t,i=jt(s.options,e.typeId),r=jt(s.selected,e.typeId);if(0===r||r!==i)return a.a.createElement("li",{className:"search-results-params__criteria",key:"searchSubTypesPopoverOption:".concat(e.typeId).concat(e.id)},e.name)},R=({selectedRange:e,noMinimumLabel:t,noMaximumLabel:s})=>{var i,r;if(!e[0]&&!e[1])return null;y(!0);var n=(null===(i=e[0])||void 0===i?void 0:i.value)?d.a.encodeCurrencyValue(e[0].value,{noDecimal:!0}):t,o=(null===(r=e[1])||void 0===r?void 0:r.value)?d.a.encodeCurrencyValue(e[1].value,{noDecimal:!0}):s,l="".concat(n," â€” ").concat(o);return a.a.createElement("li",{className:"search-results-params__criteria"},l)},N=({searchSubTypes:e,searchBar:t})=>{if(T)return!1;var s=e.selected.map(e=>O(e,t));return("0"!==t.searchBathrooms.selected||"0"!==t.searchRooms.selected||-1!==s.indexOf(!1))&&a.a.createElement("li",{className:"search-results-params__criteria"},"...")},k=({searchRooms:e})=>{if("0"===e.selected||!T)return null;var t="1~1"!==e.selected?e.title:e.titleSingle;return a.a.createElement("li",{className:"search-results-params__criteria"},q(e)," ",t.toLowerCase())},L=({searchBathrooms:e})=>{if("0"===e.selected||!T)return null;var t="1~1"!==e.selected?e.title:e.titleSingle;return a.a.createElement("li",{className:"search-results-params__criteria"},q(e)," ",t.toLowerCase())},O=(e,t)=>{var{searchSubTypes:s}=t,i=jt(s.options,e.typeId),a=jt(s.selected,e.typeId);return 0!==a&&a===i},q=e=>e.options.find(t=>t.value===e.selected).label;return a.a.createElement("div",{className:u},a.a.createElement(f,{title:s}),a.a.createElement("ul",{className:"search-results-params__list"},a.a.createElement(P,{terms:r}),a.a.createElement(E,{optionType:n.options,searchBar:e}),a.a.createElement(w,{selectedSubType:o.selected,searchBar:e}),a.a.createElement(k,{searchRooms:l}),a.a.createElement(L,{searchBathrooms:c}),a.a.createElement(R,{selectedRange:p.selected,noMinimumLabel:p.noMinimumLabel,noMaximumLabel:p.noMaximumLabel}),a.a.createElement(N,{searchSubTypes:o,searchBar:e})))};yl.propTypes={searchBathrooms:ve.PropTypes.object,searchRooms:ve.PropTypes.object,searchSubTypes:ve.PropTypes.object,searchBar:ve.PropTypes.object.isRequired,selectedCount:ve.PropTypes.string,selectedLabel:ve.PropTypes.string,selectedRange:ve.PropTypes.arrayOf(ve.PropTypes.object),location:ve.PropTypes.string.isRequired,noMaximumLabel:ve.PropTypes.string,noMinimumLabel:ve.PropTypes.string,title:ve.PropTypes.string};var Tl=yl,fl=e=>{var t=window.DP.urls.proxyEmailAlert;return p.a.ajax({method:"POST",url:t,data:e,beforeSend:e=>{e.setRequestHeader("X-CSRF-TOKEN",p()('meta[name="csrf-token"]').attr("content"))}})},Pl=()=>window.DP.auth.check,El=s(66),wl=s.n(El),Cl=()=>(wl.a.setBucket("popup_"),wl.a.get("free-evaluation-seen")),Sl=()=>{l.a.setBucket("popup_");var e=l.a.get("free-evaluation-count");return e||0},Rl=s(47),Nl=({isChecked:e,hasError:t=!1,name:s,onChange:i,type:r="checkbox"})=>a.a.createElement("label",null,a.a.createElement(yn.a,{checked:e,className:"checkbox-field","data-cy":"input-".concat(s),name:s,onChange:i,stroke:"#d4d4d4",type:r}),e&&a.a.createElement(Rl.a,{"data-cy":"isChecked",dimension:"30px",name:"checked-yes",padding:"0",stroke:"#58bf26"})||a.a.createElement(Rl.a,{"data-cy":t?"isNotCheckedError":"isNotChecked",dimension:"30px",name:"checked-no",padding:"0",stroke:t?"#58bf26":"#d4d4d4"}));Nl.propTypes={isChecked:ve.PropTypes.bool,hasError:ve.PropTypes.bool,name:ve.PropTypes.string.isRequired,onChange:ve.PropTypes.func,type:ve.PropTypes.string};var kl=Nl;class Ll extends a.a.Component{constructor(e){super(e),this.state={searchHash:e.searchHash,emailValue:e.emailValue,displayedMessage:"",errorField:null,hasSucceed:!1,hasFailed:!1,isSubmitting:!1,version:e.version,id:e.id,hasConsentedToConditions:!1}}componentDidMount(){this.openModalOnFirstLoad()}openModalOnFirstLoad(){l.a.setBucket("email_alert"),!this.props.canOpenOnFirstLoad||l.a.get("has_been_shown")||"qc"!==window.DP.province&&window.DP.configSwitch.freeEvaluationPopup&&Sl()<3&&!Cl()||(l.a.setBucket("service_conditions"),this.props.canDisplayTermsOfUsePopup&&!l.a.get("_have_been_agreed_upon_v2")||setTimeout(()=>{this.props.webinarOnly?this.webinarPopupVisible()||this.handleVisiblePopin():!this.infosessionsPopupVisible()&&this.infosessionsPopupSeenOnce()&&this.handleVisiblePopin()},7e3))}handleVisiblePopin(){this.setState({version:"modal",id:"popup"}),l.a.setBucket("email_alert"),l.a.set("has_been_shown",!0),_e.a.pushToDataLayer("gtm-event","SearchResults_EmailAlertWidget","View_PopUp","undefined"),_e.a.pushDynamicEvent("email-alert-auto-".concat(this.state.version,"-view-popup"),window.DP.context.pageType)}handleButtonClose(){this.setState({version:this.props.version})}handleButtonClick(){if(_e.a.pushDynamicEvent("email-alert-".concat(this.state.version,"-view-popup"),window.DP.context.pageType),"light"===this.state.version)return _e.a.pushToDataLayer("gtm-event",window.DP.context.pageType,"View_Alert",""),void this.setState({version:"modal"});this.resetState(),this.setState({isSubmitting:!0}),fl(this.handleEmailAlertData()).then(e=>{this.setState({displayedMessage:e.message,hasSucceed:!0,isSubmitting:!1}),this.pushGtmSentEmailEvent(this.state.id)}).catch(e=>{this.setState({errorField:e.responseJSON.field,displayedMessage:e.responseJSON.message,isSubmitting:!1,hasFailed:!0})})}handleEmailAlertData(){var{emailValue:e,searchHash:t,hasConsentedToConditions:s}=this.state,i=s;return Object.assign({},{emailValue:e,searchHash:t,consentConditions:i})}handleClickLogIn(){var e=window.DP.context.pageType;_e.a.pushToDataLayer("gtm-event",e,"Connect_Account","Login"),"popup"===this.state.id?_e.a.pushDynamicEvent("email-alert-".concat(this.state.id,"-popup-login"),e):_e.a.pushDynamicEvent("email-alert-".concat(this.state.version,"-popup-login"),e)}handleEmailValueChange(e){this.setState({emailValue:e.target.value})}resetState(){this.setState({hasSucceed:!1,hasFailed:!1,displayedMessage:"",errorField:null})}render(){var e=Ee.a.build("email-alerts-form",{light:"light"===this.state.version,modal:"modal"===this.state.version});return a.a.createElement("div",{className:e},a.a.createElement("div",{className:"email-alerts-form--inner"},a.a.createElement("div",{className:"email-alerts-form__text"},a.a.createElement("div",{className:"email-alerts-form__header"},a.a.createElement("div",{className:"email-alerts-form__close",onClick:this.handleButtonClose.bind(this)},a.a.createElement(Rl.a,{name:"modal-close"}))),a.a.createElement("h3",{className:"email-alerts-form__modal-title"},this.props.modalTitle),a.a.createElement("h4",{className:"email-alerts-form__subtitle"},"modal"===this.state.version?this.props.modalSubtitle:this.props.subtitle),this.renderSearchParams()),a.a.createElement("div",{className:"email-alerts-form__form"},this.state.displayedMessage&&this.renderMessage(),this.renderEmailField(),this.renderConsentField(),this.renderEmailAlertFormInputs()),a.a.createElement("p",{className:"email-alerts-form__legal"},this.props.legal)))}renderEmailField(){var e=Ee.a.build("email-alerts-form__form__inputs",{isSuccess:this.state.hasSucceed}),t=rr.a.v4();return a.a.createElement("div",{className:"".concat(e," email-alerts-form__form__inputs-email")},this.renderEmailLabel(t),this.renderEmailFieldContent(t))}renderEmailAlertFormInputs(){var e=Ee.a.build("email-alerts-form__form__inputs",{isSuccess:this.state.hasSucceed}),t="modal"===this.state.version?this.props.modalButton:this.props.button;return a.a.createElement("div",{className:e},this.renderSubmitButton(t),this.renderRegisterInfo())}renderSubmitButton(e){var t="button button--arrow email-alerts-form__button button--nofocus gtm-search-results-link-subscribe-alerts-";return t=t.concat(this.state.id),this.state.isSubmitting?a.a.createElement("button",{className:"button button--arrow email-alerts-form__button"},a.a.createElement(we.a,null)):a.a.createElement("button",{onClick:this.handleButtonClick.bind(this),className:t},"modal"!==this.state.version&&a.a.createElement(Rl.a,{name:"envelope",color:"#333",padding:"0 10px 0 0"}),e)}renderEmailLabel(e){return a.a.createElement("label",{htmlFor:"email-alerts-input-form-".concat(e),className:"is-visually-hidden"},this.props.emailPlaceholder)}renderEmailFieldContent(e){var t=Ee.a.build("email-alerts-form__input",{invalid:"email"===this.state.errorField});return a.a.createElement("input",{id:"email-alerts-input-form-".concat(e),value:this.state.emailValue,type:"email",name:"email-alerts-input-form",className:t,disabled:Pl(),onChange:this.handleEmailValueChange.bind(this),placeholder:this.props.emailPlaceholder})}renderConsentField(){if(this.props.hasConsentedAll)return!1;var e=Ee.a.build("email-alerts-form__form__inputs",{isSuccess:this.state.hasSucceed}),t=rr.a.v4();return a.a.createElement("div",{className:"".concat(e," email-alerts-form__form__inputs-consent")},a.a.createElement(kl,{id:"email-alerts-input-form-".concat(t),onChange:this.consentCheckboxChange.bind(this),isChecked:this.state.hasConsentedToConditions,name:"consent_conditions",type:"checkbox"}),a.a.createElement("p",{className:"email-alerts-form__legal-modal"},this.props.legal))}consentCheckboxChange(){this.setState({hasConsentedToConditions:document.querySelector("[name=consent_conditions]").checked})}renderMessage(){var e=Ee.a.build("email-alerts-form__message",{isError:this.state.hasFailed,isSuccess:this.state.hasSucceed});return a.a.createElement("div",{className:e},this.state.displayedMessage)}renderSearchParams(){return"modal"!==this.state.version?null:a.a.createElement(Tl,{searchBar:this.props.searchBar,location:"email-alert",title:this.props.paramsTitle})}renderRegisterInfo(){return a.a.createElement("div",{className:"email-alerts__registered_info"},this.renderUserNotLogged())}renderUserNotLogged(){return Pl()?"":a.a.createElement("p",{onClick:this.handleClickLogIn.bind(this),dangerouslySetInnerHTML:{__html:this.props.modalLoginText}})}pushGtmSentEmailEvent(){var e=Oe()?"Subscribe_Mobile":"Subscribe_Alert",t="modal"===this.state.version?"CTA":"";_e.a.pushToDataLayer("gtm-event","SearchResults_EmailAlertWidget",e,t),_e.a.pushDynamicEvent("email-alert-subscribe-2","EmailAlert")}infosessionsPopupVisible(){return document.querySelector(".info-sessions-popup")&&!document.querySelector(".info-sessions-popup--hidden")}webinarPopupVisible(){return document.querySelector(".webinar-popup")&&!document.querySelector(".webinar-popup--hidden")}infosessionsPopupSeenOnce(){var e="";if(sessionStorage){for(var t in sessionStorage)e+=t;return-1!==e.indexOf("sscache-infosessions_popup")}return null}}Ll.propTypes={modalTitle:ve.PropTypes.string.isRequired,subtitle:ve.PropTypes.string.isRequired,emailPlaceholder:ve.PropTypes.string.isRequired,button:ve.PropTypes.string.isRequired,searchHash:ve.PropTypes.string.isRequired,searchBar:ve.PropTypes.object.isRequired,modalLoginText:ve.PropTypes.string.isRequired,modalSubtitle:ve.PropTypes.string.isRequired,modalButton:ve.PropTypes.string.isRequired,paramsTitle:ve.PropTypes.string.isRequired,emailValue:ve.PropTypes.string,version:ve.PropTypes.string,id:ve.PropTypes.string.isRequired,legal:ve.PropTypes.string.isRequired,canDisplayTermsOfUsePopup:ve.PropTypes.bool.isRequired,canOpenOnFirstLoad:ve.PropTypes.bool.isRequired,webinarOnly:ve.PropTypes.bool.isRequired,hasConsentedAll:ve.PropTypes.bool};var Ol=Ll;class ql extends a.a.Component{constructor(e){super(e),this.state={isSubmitting:!1}}handleTogglePopover(){this.props.currentPopover!==this.props.origin&&this.props.dispatch({type:"HIDE_FAVOURITE_NOTES_PANEL_POPOVER"}),p()(".favourite-notes-panel__notes").blur(),this.props.dispatch({type:"CURRENT_FAVOURITE_NOTES_PANEL_POPOVER",origin:this.props.origin}),this.props.dispatch({type:"TOGGLE_FAVOURITE_NOTES_PANEL_POPOVER"})}handleNotesClick(){this.setState({isSubmitting:!0}),this.handleNotesSave()}handleNotesSave(){kr(this.props.listingId,this.refs.notes.value).then(()=>{this.props.dispatch(Or(this.props.listingId,this.refs.notes.value)),this.setState({isSubmitting:!1}),this.props.dispatch({type:"HIDE_FAVOURITE_NOTES_PANEL_POPOVER"})})}render(){return this.props.isVisible?a.a.createElement("div",{className:"favourite-notes-panel"},this.renderButton(),this.renderPopover()):null}renderButton(){var e=Ee.a.build("favourite-notes-panel__button",{active:this.props.showPopover&&this.props.currentPopover===this.props.origin});return a.a.createElement("div",{className:e,onClick:this.handleTogglePopover.bind(this)},a.a.createElement(Pe.a,{className:"favourite-notes-panel__button-icon",src:"/build/img/svg/icn-notes-v2.svg",cacheGetRequests:!0}),a.a.createElement("span",{className:"favourite-notes-panel__button-label gtm-listing-link-notes"},this.props.buttonLabel))}renderSaveButton(){return this.state.isSubmitting?a.a.createElement("button",{className:"favourite-notes-panel__save-button"},a.a.createElement("div",{className:"favourite-notes-panel__save-button-content"},a.a.createElement(we.a,null))):a.a.createElement("button",{className:"button",onClick:this.handleNotesClick.bind(this)},this.props.saveButtonLabel)}renderPopover(){if(this.props.showPopover&&this.props.currentPopover===this.props.origin){var e=Ee.a.build("favourite-notes-panel__popover",{sticky:"header"===this.props.origin,sidebar:"Sidebar"===this.props.origin,content:"Content"===this.props.origin});return a.a.createElement(St,{onOuterClick:this.handleTogglePopover.bind(this),onOuterTouch:this.handleTogglePopover.bind(this)},a.a.createElement("div",{className:e},a.a.createElement("div",{className:"popover-arrow"}),a.a.createElement("textarea",{className:"favourite-notes-panel__notes",ref:"notes",placeholder:this.props.placeholderText,defaultValue:this.props.note}),this.renderSaveButton()))}}}ql.propTypes={buttonLabel:ve.PropTypes.string.isRequired,saveButtonLabel:ve.PropTypes.string.isRequired,placeholderText:ve.PropTypes.string.isRequired,showPopover:ve.PropTypes.bool.isRequired,currentPopover:ve.PropTypes.string,isVisible:ve.PropTypes.bool.isRequired,listingId:ve.PropTypes.string.isRequired,note:ve.PropTypes.string.isRequired,origin:ve.PropTypes.string.isRequired,dispatch:ve.PropTypes.func.isRequired};var xl=ql=Object(u.b)(({favouriteNotesPanel:e,listingsFavourites:t},{listingId:s})=>{var{showPopover:i,currentPopover:a}=e,{favouriteListingIds:r,favouriteListingNotes:n}=t;return{showPopover:i,currentPopover:a,isVisible:r.includes(s),note:n[s]||""}})(ql),Ml=m.createProviderWrappedComponent(e=>a.a.createElement(xl,e));class Dl extends a.a.Component{constructor(e){super(e),this.state={showContent:!1,notes:""},this.handleNotesSave=Ne(this.handleNotesSave.bind(this),500)}componentDidUpdate(e,{showContent:t}){this.state.showContent&&this.state.showContent!==t&&this.refs.notes.focus()}handleOpenButtonClick(){this.setState({showContent:!this.state.showContent})}handleCloseButtonClick(){this.setState({showContent:!this.state.showContent})}handleNotesKeyUp(){var e=this.refs.notes.value;this.setState({notes:e}),this.handleNotesSave()}handleNotesSave(){kr(this.props.listingId,this.state.notes).then(()=>this.props.dispatch(Or(this.props.listingId,this.state.notes)))}render(){return this.props.isVisible?a.a.createElement("div",{className:"favourite-notes-modal"},this.renderButton(),this.renderContent()):null}renderButton(){return a.a.createElement("div",{className:"favourite-notes-modal__button",onClick:this.handleOpenButtonClick.bind(this)},a.a.createElement(Pe.a,{className:"favourite-notes-modal__button-icon",src:"/build/img/svg/icn-notes-v2.svg",cacheGetRequests:!0}),a.a.createElement("span",{className:"favourite-notes-modal__button-label"},this.props.buttonLabel))}renderContent(){return this.state.showContent?a.a.createElement("div",{className:"favourite-notes-modal__content"},a.a.createElement("div",{className:"favourite-notes-modal__title"},a.a.createElement("div",{className:"favourite-notes-modal__close-button",onClick:this.handleCloseButtonClick.bind(this)},a.a.createElement(Pe.a,{className:"favourite-notes-modal__close-button-icon",src:"/build/img/svg/icn-check.svg",cacheGetRequests:!0})),this.props.titleText),a.a.createElement("textarea",{ref:"notes",className:"favourite-notes-modal__notes",defaultValue:this.props.note,placeholder:this.props.placeholderText,onKeyUp:this.handleNotesKeyUp.bind(this)})):null}}Dl.propTypes={buttonLabel:ve.PropTypes.string.isRequired,titleText:ve.PropTypes.string.isRequired,placeholderText:ve.PropTypes.string.isRequired,listingId:ve.PropTypes.string.isRequired,isVisible:ve.PropTypes.bool.isRequired,note:ve.PropTypes.string.isRequired,dispatch:ve.PropTypes.func.isRequired};var Al=Dl=Object(u.b)(({listingsFavourites:e},{listingId:t})=>{var{favouriteListingIds:s,favouriteListingNotes:i}=e;return{isVisible:s.includes(t),note:i[t]||""}})(Dl),Il=m.createProviderWrappedComponent(e=>a.a.createElement(Al,e));class Bl extends a.a.Component{render(){var e=Bt(this.props.searchResultsParams);return a.a.createElement("div",null,e)}}Bl.propTypes={searchResultsParams:ve.PropTypes.object.isRequired};var Fl=Bl=Object(u.b)(({searchAdditionalCriteria:e,searchBar:t,searchBathrooms:s,searchFieldInput:i,searchFieldResults:a,searchFilters:r,searchFlags:n,searchLandArea:o,searchOnlineSince:l,searchOptions:c,searchPriceRange:p,searchRooms:d,searchSortOrder:h,searchSubTypes:u,searchTerms:m,searchTypes:g,searchLotSize:_,searchLivingArea:b})=>({searchResultsParams:{searchAdditionalCriteria:e,searchBar:t,searchBathrooms:s,searchFieldInput:i,searchFieldResults:a,searchFilters:r,searchFlags:n,searchLandArea:o,searchOnlineSince:l,searchOptions:c,searchPriceRange:p,searchRooms:d,searchSortOrder:h,searchSubTypes:u,searchTerms:m,searchTypes:g,searchLotSize:_,searchLivingArea:b}}))(Bl),jl=m.createProviderWrappedComponent(e=>a.a.createElement(Fl,e));class Vl extends a.a.Component{constructor(e){super(e),this.state={distance:this.props.distance?this.props.distance:null}}componentDidMount(){!this.props.distance&&this.shouldUseNavigatorGeolocation()&&this.props.position&&this.fetchListingDistance()}render(){var e=!this.state.distance,t=Ee.a.build("listing-distance-tag",{hidden:e,listing:"listing"===window.DP.context.route});return a.a.createElement("div",{className:t},a.a.createElement("div",{className:"listing-distance-tag__tag"},a.a.createElement(Pe.a,{className:"listing-distance-tag__icon",src:"/build/img/svg/icn-precision.svg",cacheGetRequests:!0}),this.state.distance))}shouldUseNavigatorGeolocation(){return window.innerWidth<=window.DP.breakpoints.medium}fetchListingDistance(){var e,t;(e=this.props.listingId,t=this.props.position,(new ir).fetch(e,{position:t,fields:{listings:"distance"}}).then(e=>Promise.resolve(e.distance)).catch(()=>Promise.reject())).then(e=>{this.setState({distance:e})}).catch(()=>{this.setState({distance:null})})}}Vl.propTypes={listingId:ve.PropTypes.string.isRequired,distance:ve.PropTypes.string,position:ve.PropTypes.string};var Ul=Vl,Hl=e=>{var t=(e=>{var t=(({builderListingsPagination:e})=>{if(null!==e.currentPageNumber&&1!==e.currentPageNumber)return e.currentPageNumber})(e);return Le({pageNumber:t})})(e),s=p.a.param(t);window.location="".concat(window.location.pathname,"?").concat(s)};class $l extends a.a.Component{handlePageChange(e){this.props.dispatch({type:"SET_BUILDER_LISTINGS_PAGINATION_CURRENT_PAGE_NUMBER",pageNumber:e.toString()}),this.props.dispatch((Hl(window.DP.store.getState()),{type:"SUBMIT_BUILDER_LISTINGS"}))}render(){return a.a.createElement(Mi,{items:this.props.items,nextLinkActive:this.props.nextLinkActive,previousLinkActive:this.props.previousLinkActive,onPageChange:this.handlePageChange.bind(this)})}}$l.propTypes={dispatch:ve.PropTypes.func.isRequired,previousLinkActive:ve.PropTypes.bool.isRequired,nextLinkActive:ve.PropTypes.bool.isRequired,items:ve.PropTypes.array.isRequired,currentPageNumber:ve.PropTypes.string},$l=Object(u.b)()($l);var Gl=m.createProviderWrappedComponent(e=>a.a.createElement($l,e)),zl=(e,t,s)=>{var i={};return t.length&&(i=Object.assign({},i,{city:t.join("-")})),s.length&&(i=Object.assign({},i,{regions:s.join("-")})),Object.assign({},e,i)},Wl=({province:e,lang:t,cityIds:s,regionIds:i})=>new Promise((a,r)=>{var n="".concat(window.DP.urls.bizApi,"/getFeaturedCompanies"),o=zl({province:e,lang:t,limit:1},s,i);p.a.ajaxSetup({crossDomain:!0,xhrFields:{withCredentials:!0}}),p.a.ajax({url:n,data:o}).done(e=>{var t=(e=>{var t=p()(e).find("featured").eq(0);return 0===t.length?null:{name:t.find("name").text(),category:t.find("category_name").text(),logo:t.find("logo_url").text(),bizUrl:t.find("link_to_dp_biz").text(),websiteUrl:t.find("url").text(),phone:t.find("phone").text()}})(e);t||r(),a(t)}).fail(r)}),Kl=({province:e,lang:t,cityIds:s,regionIds:i})=>new Promise((a,r)=>{var n="".concat(window.DP.urls.bizApi,"/getCategories"),o=zl({province:e,lang:t,limit:10},s,i);p.a.ajaxSetup({crossDomain:!0,xhrFields:{withCredentials:!0}}),p.a.ajax({url:n,data:o}).done(e=>{var t=(e=>p()(e).find("category").map((e,t)=>{var s=p()(t);return{name:s.find("category_name").text(),url:s.find("link_to_dp_biz").text()}}).toArray())(e);0===t.length&&r(),a(t)}).fail(r)});function Yl(){return(Yl=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e}).apply(this,arguments)}class Xl extends a.a.Component{constructor(e){super(e),this.state={company:null,categories:[]}}componentDidMount(){this.isListingPageType()?this.fetchCategories():this.fetchCompany()}render(){var e=this.renderContent();if(!e)return null;var t=Ee.a.build("featured-company",{bordered:this.props.bordered});return a.a.createElement("div",{className:t},e,a.a.createElement(ec,Yl({},this.props.form,{regionIds:this.props.regionIds})))}renderContent(){return this.state.company?a.a.createElement(Zl,Yl({},this.props.company,{company:this.state.company,regionIds:this.props.regionIds})):this.state.categories.length?a.a.createElement(Jl,Yl({},this.props.categories,{categories:this.state.categories,regionIds:this.props.regionIds})):null}fetchCompany(){var{province:e,lang:t,cityIds:s,regionIds:i}=this.props;Wl({province:e,lang:t,cityIds:s,regionIds:i}).then(e=>this.setState({company:e})).catch(()=>this.fetchCategories())}fetchCategories(){var{province:e,lang:t,cityIds:s,regionIds:i}=this.props;Kl({province:e,lang:t,cityIds:s,regionIds:i}).then(e=>this.setState({categories:e})).catch(()=>{})}isListingPageType(){return this.props.pageType&&"listing"===this.props.pageType}}var Zl=({company:e,title:t,website:s})=>a.a.createElement("div",{className:"featured-company__container"},a.a.createElement("div",{className:"featured-company__title"},t),a.a.createElement("div",{className:"featured-company__content--company"},a.a.createElement("div",{className:"featured-company__company-name"},e.name),a.a.createElement("div",{className:"featured-company__company-category"},e.category),a.a.createElement("div",{className:"featured-company__company-columns"},a.a.createElement("div",{className:"featured-company__company-photo"},a.a.createElement("a",{target:"_blank",className:"featured-company__company-biz",href:e.bizUrl},a.a.createElement("img",{className:"featured-company__company-image",src:e.logo}))),a.a.createElement("div",{className:"featured-company__company-contact"},a.a.createElement("div",{className:"featured-company__company-phone-number"},e.phone),a.a.createElement("a",{target:"_blank",className:"featured-company__company-website",href:e.websiteUrl},s))))),Jl=({categories:e,title:t})=>a.a.createElement("div",{className:"featured-company__container"},a.a.createElement("div",{className:"featured-company__logo-title"},a.a.createElement("img",{className:"featured-company__logo-title-image",src:"/build/img/png/img-dupropriobiz.png",alt:""})),a.a.createElement("div",{className:"featured-company__subtitle"},t),a.a.createElement("div",{className:"featured-company__content--categories"},a.a.createElement("ul",{className:"featured-company__categories"},e.map((e,t)=>a.a.createElement(Ql,{key:"category:".concat(t),category:e}))))),Ql=({category:e})=>{var{name:t,url:s}=e;return a.a.createElement("li",{className:"featured-company__category"},a.a.createElement("a",{className:"featured-company__category-link",href:s,target:"_blank"},t))},ec=({regionIds:e,placeholder:t,button:s,action:i})=>a.a.createElement("form",{target:"_blank",method:"post",action:i,className:"featured-company__form"},e.map(e=>a.a.createElement("input",{key:"featuredCompany:form:region:".concat(e),type:"hidden",name:"region[]",defaultValue:e})),a.a.createElement("label",null,a.a.createElement("span",{className:"is-visually-hidden"},t),a.a.createElement("input",{className:"featured-company__form-input",name:"what",placeholder:t})),a.a.createElement("button",{className:"featured-company__form-button"},s));Zl.propTypes={company:ve.PropTypes.shape({name:ve.PropTypes.string.isRequired,category:ve.PropTypes.string.isRequired,logo:ve.PropTypes.string.isRequired,phone:ve.PropTypes.string.isRequired,bizUrl:ve.PropTypes.string.isRequired,websiteUrl:ve.PropTypes.string.isRequired}).isRequired,title:ve.PropTypes.string.isRequired,website:ve.PropTypes.string.isRequired},Jl.propTypes={categories:ve.PropTypes.array.isRequired,title:ve.PropTypes.string.isRequired},Ql.propTypes={category:ve.PropTypes.shape({name:ve.PropTypes.string.isRequired,url:ve.PropTypes.string.isRequired}).isRequired},ec.propTypes={regionIds:ve.PropTypes.arrayOf(ve.PropTypes.number).isRequired,placeholder:ve.PropTypes.string.isRequired,button:ve.PropTypes.string.isRequired,action:ve.PropTypes.string.isRequired},Xl.propTypes={cityIds:ve.PropTypes.arrayOf(ve.PropTypes.number).isRequired,regionIds:ve.PropTypes.arrayOf(ve.PropTypes.number).isRequired,province:ve.PropTypes.number.isRequired,lang:ve.PropTypes.string.isRequired,company:ve.PropTypes.object.isRequired,categories:ve.PropTypes.object.isRequired,form:ve.PropTypes.object.isRequired,bordered:ve.PropTypes.bool.isRequired,pageType:ve.PropTypes.string};var tc=Xl,sc=m.createProviderWrappedComponent(e=>a.a.createElement(tc,e));s(524);var ic=class{fetch(e={}){return this.lastRequest&&this.lastRequest.abort(),new Promise((t,s)=>{var i,a;this.lastRequest=(i=e,a=Se()(window.DP.urls.proxyInfosession),p.a.ajax({url:a,data:i})).done(t).fail(s)})}},ac={speed:15,direction:"top",cycles:1/0,delayBetweenCycles:0,space:0,duplicated:!0,handleHover:!0};class rc extends a.a.Component{constructor(e){super(e),this.state={infosessions:[]}}fetchInfosessions(){var{regions:e,cities:t}=this.props;(({regions:e,cities:t})=>(new ic).fetch({regions:e,cities:t}).then(e=>Promise.resolve(e)).catch(()=>Promise.reject()))({regions:e,cities:t}).then(e=>{this.removeDuplicateInfosession(e),this.renderWebinarOnDemand()}).catch(()=>{this.setState({infosessions:[]}),this.renderWebinarOnDemand()})}componentDidMount(){this.fetchInfosessions()}componentDidUpdate(){this.state.infosessions.length>0&&(this.element=p()(this.refs.infosessionTickerList),this.element.simplemarquee(ac))}getBaseUrl(){return this.props.webinarOnDemandUrl}getItemUrl(e){return e.isWebinar?this.props.webinarOnDemandUrl:this.props.baseUrl}removeDuplicateInfosession(e){var t=e,s=[],i="fr"===window.DP.lang?"fr":"en",a=!1,r=0;for(r in t){for(var n=s.length-1;n>=0;n--)t[r].city===s[n].city&&t[r].dayMonth===s[n].dayMonth&&(t[r].language===i&&(s.splice(n,1),s.push(t[r])),a=!0);a||s.push(t[r]),a=!1}this.setState({infosessions:s})}handleLinkClick(){_e.a.pushDynamicEvent("listing-infosession-widget-sessions-list",window.DP.context.pageType)}handleRegisterClick(){_e.a.pushDynamicEvent("listing-infosession-widget-register-button",window.DP.context.pageType)}render(){return 0===this.state.infosessions.length?this.renderPlaceholder():a.a.createElement("div",{className:"info-session-ticker"},a.a.createElement("header",{className:"info-session-ticker__title"},a.a.createElement("a",{className:"info-session-ticker__title-link",href:"".concat(this.getBaseUrl(),"?").concat(this.props.itmParametersUrls.box)},this.props.title)),a.a.createElement("ul",{className:"info-session-ticker__list has-enough-space",ref:"infosessionTickerList"},this.state.infosessions.map(e=>this.renderInfosession(e))),a.a.createElement("div",{className:"info-session-ticker__action"},a.a.createElement("a",{href:"".concat(this.getBaseUrl(),"?").concat(this.props.itmParametersUrls.button),onClick:this.handleRegisterClick.bind(this),className:"info-session-ticker__button gtm-infosession-ticker-link-subscribe"},this.props.button)))}renderWebinarOnDemand(){if("qc"===window.DP.province){var e={city:null,dayMonth:this.props.OnDemand,description:"".concat(this.props.isWebinar," ").concat(this.props.OnDemand),id:"",isWebinar:!0,language:window.DP.lang,latitude:0,longitude:0,province:"QC"},t=this.state.infosessions.concat(e);return this.setState({infosessions:t})}}renderInfosession(e){if(!e.isWebinar&&"qc"!==window.DP.province)return!1;var t="";return"qc"===window.DP.province&&(t="info-session-ticker__list-item-",e.isWebinar?t+=e.dayMonth===this.props.OnDemand?"ondemand":"online":t+="salle"),a.a.createElement("li",{key:"InfoSessionTicker:infosession:".concat(e.id),className:"info-session-ticker__list-item ".concat(t)},a.a.createElement("a",{href:"".concat(this.getItemUrl(e),"?id=").concat(e.id,"&").concat(this.props.itmParametersUrls.list),onClick:this.handleLinkClick.bind(this),className:"info-session-ticker__list-link gtm-infosession-ticker-link-session"},this.renderCity(e),e.dayMonth))}renderCity(e){var t=e.isWebinar?this.props.isWebinar:e.city;return a.a.createElement("span",{className:"info-session-ticker__location gtm-infosession-ticker-link-session"},t)}renderPlaceholder(){return a.a.createElement("div",{className:"info-session-ticker info-session-ticker--placeholder"},a.a.createElement("header",{className:"info-session-ticker__title"},a.a.createElement("div",{className:"info-session-ticker__title-link"},this.props.title)),a.a.createElement("div",{className:"info-session-ticker__list",ref:"infosessionTickerList"},a.a.createElement("div",{className:"info-session-ticker__loading loading-dots loading-dots--light"},a.a.createElement("div",{className:"loading-dots__dot"}),a.a.createElement("div",{className:"loading-dots__dot"}),a.a.createElement("div",{className:"loading-dots__dot"}))))}}rc.propTypes={title:ve.PropTypes.string.isRequired,button:ve.PropTypes.string.isRequired,baseUrl:ve.PropTypes.string.isRequired,baseUrlMobile:ve.PropTypes.string.isRequired,baseUrlServices:ve.PropTypes.string,webinarOnDemandUrl:ve.PropTypes.string,OnDemand:ve.PropTypes.string,isWebinar:ve.PropTypes.string.isRequired,regions:ve.PropTypes.array.isRequired,cities:ve.PropTypes.array.isRequired,itmParametersUrls:ve.PropTypes.shape({box:ve.PropTypes.string.isRequired,list:ve.PropTypes.string.isRequired,button:ve.PropTypes.string.isRequired})};var nc=rc,oc="/build/img/jpg/info-sessions-box/how-does-it-work-".concat(window.DP.lang,".jpg");class lc extends a.a.Component{render(){return a.a.createElement("div",{className:"info-sessions-widget-img"},a.a.createElement("a",{href:"".concat(this.props.webinarOnDemandUrl,"?").concat(this.props.itmParametersUrls.boxImage)},a.a.createElement("img",{className:"info-sessions-widget-img__img",src:oc,alt:this.props.altAttributeInfoSessionsWidgetImg})))}}lc.propTypes={webinarOnDemandUrl:ve.PropTypes.string.isRequired,itmParametersUrls:ve.PropTypes.shape({box:ve.PropTypes.string.isRequired,boxImage:ve.PropTypes.string.isRequired,list:ve.PropTypes.string.isRequired,button:ve.PropTypes.string.isRequired}),altAttributeInfoSessionsWidgetImg:ve.PropTypes.string.isRequired};var cc=lc,pc={slidesToShow:1,slidesToScroll:1,autoplay:!0,autoplaySpeed:3e3,arrows:!1};class dc extends a.a.Component{constructor(e){super(e),this.state={infosessions:[]}}fetchInfosessions(){var{regions:e,cities:t}=this.props;(({regions:e,cities:t})=>(new ic).fetch({regions:e,cities:t}).then(e=>Promise.resolve(e)).catch(()=>Promise.reject()))({regions:e,cities:t}).then(e=>{"qc"===window.DP.province?this.renderWebinarOnDemand(e):this.setState({infosessions:e})}).catch(()=>{this.setState({infosessions:[]}),"qc"===window.DP.province&&this.renderWebinarOnDemand()})}componentDidMount(){this.fetchInfosessions()}componentDidUpdate(){this.state.infosessions.length>0&&(this.element=p()(this.refs.infosessionCarousselList),Hi()(this.element,pc))}handleClick(){_e.a.pushDynamicEvent("infosession-widget-click-session-list","Listing_Mobile")}render(){return 0===this.state.infosessions.length?null:a.a.createElement("div",{id:"carousel-infosession-list"},a.a.createElement("div",{className:"carousel slide","data-ride":"carousel"},a.a.createElement("div",{className:"infosession-title"},this.renderTitleMobile()),a.a.createElement("div",{className:"carousel-inner infosession-infos"},a.a.createElement("span",{className:"arrow"}),a.a.createElement("ul",{className:"info-session-ticker__list",ref:"infosessionCarousselList"},this.state.infosessions.map((e,t)=>this.renderInfosession(e,t)))),a.a.createElement("div",{className:"clearfix"})))}renderTitleMobile(){return a.a.createElement("p",{dangerouslySetInnerHTML:{__html:this.props.titleMobile}})}renderInfosession(e,t){if(!e.isWebinar&&"qc"!==window.DP.province)return!1;var s=e.isWebinar?"webinar":"infosession",i="",r="",n=e.isWebinar?this.props.webinarOnDemandUrl:this.props.baseUrlMobile;if("qc"===window.DP.province)if(r="info-session-ticker__list-item-",i="? ".concat(this.props.itmParametersUrls.mobile),e.isWebinar){if(e.dayMonth!==this.props.OnDemand)return;r+="ondemand",n=this.props.webinarOnDemandUrl}else r+="salle";return a.a.createElement("li",{key:"InfoSessionTicker:infosession:".concat(t),className:"item ".concat(r)},a.a.createElement("a",{href:"".concat(n,"?id=").concat(e.id,"&type=").concat(s,"&").concat("from=iw").concat(i),className:"gtm-infosession-ticker-mobile-link-session",onClick:this.handleClick.bind(this)},this.renderCity(e),a.a.createElement("br",null),e.dayMonth,a.a.createElement(Pe.a,{className:"icon-arrow-right",src:"/build/img/svg/icn-arrow.svg",cacheGetRequests:!0})))}renderWebinarOnDemand(e){if("qc"===window.DP.province){var t={city:null,dayMonth:this.props.OnDemand,description:"".concat(this.props.isWebinar," ").concat(this.props.OnDemand),id:"",isWebinar:!0,language:window.DP.lang,latitude:0,longitude:0,province:"QC"},s=this.state.infosessions.concat(t);e&&(s=e.concat(t)),this.setState({infosessions:s})}}renderCity(e){var t=e.isWebinar?this.props.isWebinar:e.city;return a.a.createElement("strong",null,t)}}dc.propTypes={title:ve.PropTypes.string.isRequired,titleMobile:ve.PropTypes.string.isRequired,button:ve.PropTypes.string.isRequired,baseUrl:ve.PropTypes.string.isRequired,baseUrlMobile:ve.PropTypes.string.isRequired,webinarOnDemandUrl:ve.PropTypes.string,itmParametersUrls:ve.PropTypes.shape({box:ve.PropTypes.string.isRequired,list:ve.PropTypes.string.isRequired,button:ve.PropTypes.string.isRequired,mobile:ve.PropTypes.string.isRequired}),OnDemand:ve.PropTypes.string,isWebinar:ve.PropTypes.string.isRequired,regions:ve.PropTypes.array.isRequired,cities:ve.PropTypes.array.isRequired};var hc=dc,uc=e=>{var t=window.DP.urls.proxyCreateReferral;return p.a.ajax({method:"POST",url:t,data:e,beforeSend:e=>{e.setRequestHeader("X-CSRF-TOKEN",p()('meta[name="csrf-token"]').attr("content"))}})};class mc extends a.a.Component{constructor(e){super(e),this.state={referralFirstName:"",referralLastName:"",referralPhone:"",referentFirstName:"",referentLastName:"",referentEmail:"",referentPhone:"",displayedMessage:"",hasSucceed:!1,hasFailed:!1,isSubmitting:!1,showPopinNotEligible:!1,showPopinSuccess:!1,hidePopin:!0},this.handleValueChange=this.handleValueChange.bind(this)}scrollToItem(){window.scrollTo(0,p()(this.refs.referralForm).offset().top-50)}handleValueChange(e){this.setState({[e.target.name]:e.target.value})}handleButtonClick(){this.resetState(),this.setState({isSubmitting:!0});var e=this.state.referralFirstName,t=this.state.referralLastName,s=this.state.referralPhone,i=this.state.referentFirstName,a=this.state.referentLastName,r=this.state.referentEmail,n=this.state.referentPhone,o=window.DP.province;uc({referral_first_name:e,referral_last_name:t,referral_phone:s,referent_first_name:i,referent_last_name:a,referent_phone:n,referent_email:r,province:o}).then(e=>{this.setState({displayedMessage:e.message,hasSucceed:!0,isSubmitting:!1,hidePopin:!1,showPopinSuccess:!0}),this.resetFormInformation(),_e.a.pushToDataLayer("gtm-event","ReferralPage","Subscribe","Referral")}).catch(e=>{var t=null,s="";e.status>400?s=this.props.genericError:(t=e.responseJSON.field,s=e.responseJSON.message),"referral_not_eligible"===t&&this.setState({showPopinNotEligible:!0,hidePopin:!1}),this.setState({errorField:t,displayedMessage:s,isSubmitting:!1,hasFailed:!0}),this.scrollToItem()})}resetState(){this.setState({hasSucceed:!1,hasFailed:!1,displayedMessage:"",errorField:null,showPopinNotEligible:!1,showPopinSuccess:!1,hidePopin:!0})}resetFormInformation(){this.setState({referralFirstName:"",referralLastName:"",referralPhone:"",referentFirstName:"",referentLastName:"",referentEmail:"",referentPhone:""})}renderMessage(){var e=Ee.a.build("referral-form__message",{isError:this.state.hasFailed,isSuccess:this.state.hasSucceed});return a.a.createElement("div",{className:e},this.state.displayedMessage)}renderReferralFirstNameField(){var e=Ee.a.build("referral-form__field",{invalid:"referral_first_name"===this.state.errorField});return a.a.createElement("input",{className:e,type:"text",name:"referralFirstName",placeholder:this.props.referral.firstNamePlaceholder,value:this.state.referralFirstName,onChange:this.handleValueChange})}renderReferralLastNameField(){var e=Ee.a.build("referral-form__field",{invalid:"referral_last_name"===this.state.errorField});return a.a.createElement("input",{className:e,type:"text",name:"referralLastName",placeholder:this.props.referral.lastNamePlaceholder,value:this.state.referralLastName,onChange:this.handleValueChange})}renderReferralPhoneField(){var e=Ee.a.build("referral-form__field",{invalid:this.handleReferralPhoneFieldInvalid()});return a.a.createElement(yn.a,{className:e,mask:"999-999-9999",name:"referralPhone",placeholder:this.props.referral.phonePlaceholder,value:this.state.referralPhone,onChange:this.handleValueChange})}renderReferentFirstNameField(){var e=Ee.a.build("referral-form__field",{invalid:"referent_first_name"===this.state.errorField});return a.a.createElement("input",{className:e,type:"text",name:"referentFirstName",placeholder:this.props.referent.firstNamePlaceholder,value:this.state.referentFirstName,onChange:this.handleValueChange})}renderReferentLastNameField(){var e=Ee.a.build("referral-form__field",{invalid:"referent_last_name"===this.state.errorField});return a.a.createElement("input",{className:e,type:"text",name:"referentLastName",placeholder:this.props.referent.lastNamePlaceholder,value:this.state.referentLastName,onChange:this.handleValueChange})}renderReferentEmailField(){var e=Ee.a.build("referral-form__field",{invalid:"referent_email_invalid"===this.state.errorField});return a.a.createElement("input",{className:e,type:"email",name:"referentEmail",placeholder:this.props.referent.emailPlaceholder,value:this.state.referentEmail,onChange:this.handleValueChange})}renderReferentPhoneField(){var e=Ee.a.build("referral-form__field",{invalid:this.handleReferentPhoneFieldInvalid()});return a.a.createElement(yn.a,{className:e,mask:"999-999-9999",name:"referentPhone",placeholder:this.props.referent.phonePlaceholder,value:this.state.referentPhone,onChange:this.handleValueChange})}renderSubmitButton(){return this.state.isSubmitting?a.a.createElement("button",{className:"referral-form__button referral-form__button--submitting"},a.a.createElement("div",{className:"referral-form__button-content"},a.a.createElement(we.a,null))):a.a.createElement("button",{onClick:this.handleButtonClick.bind(this),className:"referral-form__button"},this.props.submitButtonLabel)}renderWizardContent(){return a.a.createElement("div",{className:"referral-form__wizard-container"},a.a.createElement("h2",{className:"referral-form__wizard-intro-title"},this.props.titleIntro),a.a.createElement("p",{className:"referral-form__wizard-intro-text",dangerouslySetInnerHTML:{__html:this.props.textIntro}}),this.renderFormContent())}renderDisclaimer(){return a.a.createElement("div",{className:"referral-form__disclaimer",dangerouslySetInnerHTML:{__html:this.props.disclaimer}})}renderFormContent(){return a.a.createElement("div",{className:"referral-form__wizard-content"},a.a.createElement("h2",{className:"referral-form__wizard-title"},this.props.referral.title),this.state.displayedMessage?this.renderMessage():null,a.a.createElement("div",{className:"referral-form__field-group"},this.renderReferralFirstNameField(),this.renderReferralLastNameField(),this.renderReferralPhoneField()),a.a.createElement("h2",{className:"referral-form__wizard-title"},this.props.referent.title),a.a.createElement("div",{className:"referral-form__field-group"},this.renderReferentFirstNameField(),this.renderReferentLastNameField(),this.renderReferentEmailField(),this.renderReferentPhoneField()),this.renderSubmitButton(),this.renderDisclaimer())}renderPopin(){return this.state.hidePopin?null:a.a.createElement("div",{className:"referral-form-popin"},a.a.createElement("div",{className:"referral-form-popin--inner"},this.renderPopinText(),a.a.createElement("div",{className:"referral-form-popin__close",onClick:this.handlePopinCloseAction.bind(this)},a.a.createElement(Pe.a,{className:"referral-form-popin__close-icon",src:"/build/img/svg/icn-close.svg",cacheGetRequests:!0}))))}renderPopinText(){var e="";return this.state.showPopinSuccess?e=this.props.popinSuccessText:this.state.showPopinNotEligible&&(e=this.props.popinNotEligibleText),a.a.createElement("div",{className:"referral-form-popin__text",dangerouslySetInnerHTML:{__html:e}})}render(){var e=Ee.a.build("referral-form",{success:this.state.hasSucceed});return a.a.createElement("div",{className:e,ref:"referralForm"},this.renderWizardContent(),this.renderPopin())}handlePopinCloseAction(){this.setState({hidePopin:!0})}handleReferralPhoneFieldInvalid(){return"referral_phone_required"===this.state.errorField||"referral_phone_invalid"===this.state.errorField||"referral_not_eligible"===this.state.errorField}handleReferentPhoneFieldInvalid(){return"referent_phone_required"===this.state.errorField||"referent_phone_invalid"===this.state.errorField||"referent_not_eligible"===this.state.errorField}}mc.propTypes={titleIntro:ve.PropTypes.string.isRequired,textIntro:ve.PropTypes.string.isRequired,referral:ve.PropTypes.shape({firstNamePlaceholder:ve.PropTypes.string.isRequired,lastNamePlaceholder:ve.PropTypes.string.isRequired,phonePlaceholder:ve.PropTypes.string.isRequired,title:ve.PropTypes.string.isRequired}),referent:ve.PropTypes.shape({firstNamePlaceholder:ve.PropTypes.string.isRequired,lastNamePlaceholder:ve.PropTypes.string.isRequired,emailPlaceholder:ve.PropTypes.string.isRequired,phonePlaceholder:ve.PropTypes.string.isRequired,title:ve.PropTypes.string.isRequired}),submitButtonLabel:ve.PropTypes.string.isRequired,disclaimer:ve.PropTypes.string.isRequired,popinSuccessText:ve.PropTypes.string.isRequired,popinNotEligibleText:ve.PropTypes.string.isRequired,genericError:ve.PropTypes.string.isRequired};var gc=mc;class _c extends a.a.Component{constructor(e){super(e),window.__lc=window.__lc||{},window.__lc.license=e.license,window.LC_API=window.LC_API||{},window.__lc.chat_between_groups=!0,window.__lc.group=e.group,window.LC_API.on_before_load=function(){e.version&&"light"===e.version?window.LC_API.livechat_chat_started||window.LC_API.hide_chat_window():window.LC_API.agents_are_available()||window.LC_API.visitor_engaged()||window.LC_API.hide_chat_window()};var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src="https://cdn.livechatinc.com/tracking.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}render(){return a.a.createElement("div",null)}}_c.propTypes={license:ve.PropTypes.number.isRequired,group:ve.PropTypes.number.isRequired,version:ve.PropTypes.string};var bc=_c;class vc extends a.a.Component{handleClick(){this.props.handleGroupClick(this)}render(){var{selected:e,label:t}=this.props,s=Ee.a.build("packages-selection__listingroup-selector-list-item",{active:e});return a.a.createElement("li",{className:s,onClick:this.handleClick.bind(this)},t)}}vc.propTypes={handleGroupClick:ve.PropTypes.func.isRequired,group:ve.PropTypes.string.isRequired,selected:ve.PropTypes.bool.isRequired,label:ve.PropTypes.string.isRequired};var yc=vc;class Tc extends a.a.Component{render(){var{labels:e}=this.props;return a.a.createElement("div",{className:"packages-selection__listingroup-selector"},a.a.createElement("span",{className:"packages-selection__listingroup-selector-label"},e.title),a.a.createElement("ul",{className:"packages-selection__listingroup-selector-list"},this.getListingGroups().map(e=>this.renderListingGroupItem(e))))}getListingGroups(){var{config:e}=this.props;return Object.keys(e)}renderListingGroupItem(e){var{handleGroupClick:t,labels:s,selectedGroup:i}=this.props,r=s.groups[e],n=i===e;return a.a.createElement(yc,{key:e,handleGroupClick:t,group:e,selected:n,label:r})}}Tc.propTypes={handleGroupClick:ve.PropTypes.func.isRequired,config:ve.PropTypes.object.isRequired,labels:ve.PropTypes.shape({title:ve.PropTypes.string.isRequired,groups:ve.PropTypes.object.isRequired}),selectedGroup:ve.PropTypes.string};var fc=Tc;class Pc extends a.a.Component{render(){return a.a.createElement("div",{className:"packages-selection__boxes-extras"},this.renderSpecialOffer(),this.renderExtraIdealLargeVolume())}isPromoActive(e){var{extras:t}=this.props;return 0!==t.length&&-1!==t.indexOf(e)}getTextForPromoKey(e,t){var{labels:s}=this.props,i="";return s.hasOwnProperty("extra")&&s.extra.hasOwnProperty(e)&&s.extra[e].hasOwnProperty(t)&&"string"==typeof s.extra[e][t]&&(i=s.extra[e][t]),i}renderSpecialOffer(){var e=this.getTextForPromoKey("special_offer","title"),t=this.getTextForPromoKey("special_offer","text");if(this.isPromoActive("special_offer")&&(0!==e.length||0!==t.length))return a.a.createElement(Ec,{title:e,text:t})}renderExtraIdealLargeVolume(){var e=this.getTextForPromoKey("ideal_for_large_volume","text");if(this.isPromoActive("ideal_for_large_volume")&&0!==e.length)return a.a.createElement(wc,{text:e})}}class Ec extends a.a.Component{render(){var{title:e,text:t}=this.props;return a.a.createElement("div",{className:"packages-selection__boxes-special-offer"},a.a.createElement("h4",{className:"packages-selection__boxes-special-offer-title"},e),a.a.createElement("p",{className:"packages-selection__boxes-special-offer-text",dangerouslySetInnerHTML:{__html:t}}))}}class wc extends a.a.Component{render(){var{text:e}=this.props;return a.a.createElement("div",{className:""},e)}}Pc.propTypes={extras:ve.PropTypes.array.isRequired,labels:ve.PropTypes.object.isRequired},Ec.propTypes={title:ve.PropTypes.string.isRequired,text:ve.PropTypes.string.isRequired},wc.propTypes={text:ve.PropTypes.string.isRequired};var Cc=Pc;class Sc extends a.a.Component{buildTitle(){var{data:e,labels:t}=this.props,s="";return e.code&&(s=t.titles[e.code]),s}buildPrice(){var{data:e}=this.props;return e.price}buildDefinitions(){var{data:e}=this.props,t=this;return!e.hasOwnProperty("definitions")||e.hasOwnProperty("definitions")&&!Array.isArray(e.definitions)?[]:e.definitions.map((function(e){return{key:t.buildDefinitionKey(e),title:t.buildDefinitionTitle(e),help:t.buildDefinitionHelp(e)}}))}buildDefinitionKey(e){var{data:t}=this.props;return"".concat(t.code,"_").concat(e)}buildDefinitionTitle(e){var{labels:t}=this.props,s=t.definitions;return s.hasOwnProperty(e)&&s[e].hasOwnProperty("text")?s[e].text:""}buildDefinitionHelp(e){var{labels:t}=this.props,s=t.definitions;return s.hasOwnProperty(e)&&s[e].hasOwnProperty("help")?s[e].help:""}buildButtonText(){var{labels:e,data:t}=this.props,s="default";return t.hasOwnProperty("button")&&e.buttons.hasOwnProperty(t.button)&&(s=t.button),e.buttons[s]}buildButtonUrl(){var{baseUrl:e,data:t,selectedGroup:s}=this.props,i=1;return t.hasOwnProperty("rank")&&"number"==typeof t.rank&&(i=t.rank),"".concat(e,"&package=").concat(i,"&type=").concat(s)}render(){var{data:e,labels:t}=this.props,s=[];return e.hasOwnProperty("extras")&&Array.isArray(e.extras)&&(s=e.extras),a.a.createElement("div",{className:"packages-selection__boxes packages-selection__boxes--package-".concat(e.rank)},a.a.createElement(Rc,{title:this.buildTitle()}),a.a.createElement(kc,{definitions:this.buildDefinitions()}),a.a.createElement(Cc,{extras:s,labels:t}),a.a.createElement(Nc,{price:this.buildPrice()}),a.a.createElement(Oc,{text:this.buildButtonText(),url:this.buildButtonUrl()}))}}class Rc extends a.a.Component{render(){var{title:e}=this.props;return a.a.createElement("div",{className:"packages-selection__boxes-title packages-selection__boxes-title--lang-".concat(window.DP.lang)},a.a.createElement("h3",null,e))}}class Nc extends a.a.Component{encodeCurrencyValueDisplay(e){return d.a.encodeCurrencyValue(e,{noDecimal:!1})}render(){var{price:e}=this.props;return a.a.createElement("div",{className:"packages-selection__boxes-price"},this.encodeCurrencyValueDisplay(e))}}class kc extends a.a.Component{render(){var{definitions:e}=this.props;return a.a.createElement("div",{className:"packages-selection__boxes-definition"},a.a.createElement("ul",{className:"packages-selection__boxes-definition-list"},e.map((e,t)=>this.renderDefinitionLine(e,t))))}renderDefinitionLine(e,t){return a.a.createElement("li",{key:t},a.a.createElement("span",{className:"packages-selection__boxes-definition-text",dangerouslySetInnerHTML:{__html:e.title}}),a.a.createElement(Lc,{id:e.key,text:e.help}))}}class Lc extends a.a.Component{render(){return this.props.text.length<=0?null:a.a.createElement("span",{className:"packages-selection__boxes-definition-helper"},a.a.createElement("span",{className:"packages-selection__boxes-definition-helper-trigger"},"?"),this.renderHelperText())}renderHelperText(){var e=this.props.text;return a.a.createElement("span",{className:"packages-selection__boxes-helper-text",dangerouslySetInnerHTML:{__html:e}})}}class Oc extends a.a.Component{render(){var{text:e,url:t}=this.props;return a.a.createElement("div",{className:"packages-selection__boxes-button-container"},a.a.createElement("a",{className:"packages-selection__boxes-button",href:t,target:"_self"},e))}}Rc.propTypes={title:ve.PropTypes.string.isRequired},Nc.propTypes={price:ve.PropTypes.number.isRequired},kc.propTypes={definitions:ve.PropTypes.array.isRequired},Lc.propTypes={id:ve.PropTypes.string.isRequired,text:ve.PropTypes.string.isRequired},Oc.propTypes={text:ve.PropTypes.string.isRequired,url:ve.PropTypes.string.isRequired},Sc.propTypes={baseUrl:ve.PropTypes.string.isRequired,data:ve.PropTypes.object.isRequired,labels:ve.PropTypes.object.isRequired,selectedGroup:ve.PropTypes.string};var qc=Sc;class xc extends a.a.Component{constructor(e){super(e)}getGroupPackages(){var{config:e,selectedGroup:t}=this.props;return e[t]}render(){return a.a.createElement("div",{className:"packages-selection__boxes-container"},this.getGroupPackages().map((e,t)=>this.renderPackageItem(e,t)))}renderPackageItem(e,t){var{labels:s,baseUrl:i,selectedGroup:r}=this.props;return a.a.createElement(qc,{key:t,baseUrl:i,data:e,labels:s,selectedGroup:r})}}xc.propTypes={baseUrl:ve.PropTypes.string.isRequired,config:ve.PropTypes.object.isRequired,labels:ve.PropTypes.object.isRequired,selectedGroup:ve.PropTypes.string};var Mc=xc;class Dc extends a.a.Component{render(){return a.a.createElement("div",{className:"packages-selection__disclaimer"},this.props.disclaimerText)}}Dc.propTypes={disclaimerText:ve.PropTypes.string.isRequired};var Ac=Dc;class Ic extends a.a.Component{constructor(e){super(e);var t=e.selectedGroup;this.state={selectedGroup:t}}handleGroupClick(e){var t=e.props.group;this.setState({selectedGroup:t})}render(){var{config:e,labels:t,baseUrl:s,disclaimerText:i}=this.props,{selectedGroup:r}=this.state;return a.a.createElement("div",{className:"packages-selection__main-container"},a.a.createElement(fc,{config:e,labels:t.listingGroupSelection,selectedGroup:r,handleGroupClick:this.handleGroupClick.bind(this)}),a.a.createElement(Mc,{baseUrl:s,config:e,labels:t.packages,selectedGroup:r}),a.a.createElement(Ac,{disclaimerText:i}))}}Ic.propTypes={baseUrl:ve.PropTypes.string.isRequired,config:ve.PropTypes.object.isRequired,labels:ve.PropTypes.shape({listingGroupSelection:ve.PropTypes.object.isRequired,packages:ve.PropTypes.object.isRequired}),selectedGroup:ve.PropTypes.string,disclaimerText:ve.PropTypes.string.isRequired};var Bc=Ic;class Fc extends a.a.Component{constructor(e){super(e),this.state={showModal:!1}}handleOpenClick(){this.setState({showModal:!0})}renderMatterportIframe(){if(!this.state.showModal)return null;var e=Ee.a.build("photo-viewer-3d-showcase-content__viewer",{visible:this.state.showModal});return a.a.createElement("iframe",{className:"".concat(e," matterportIframe_vrmfu2 keep-aspect-ratio"),src:this.props.showcaseUrl,frameBorder:"0",allowFullScreen:!0})}renderDisplay3DShowcaseButton(){return this.state.showModal?null:a.a.createElement("div",{onClick:this.handleOpenClick.bind(this),className:"virtual-tour-page-visual__block__button"},a.a.createElement("img",{className:"virtual-tour-page-visual__block__button__image",src:"/build/img/jpg/landingpages/landing-virtual-tour/virtual-tour-preview-v2-".concat(this.props.lang,".jpg"),alt:""}))}render(){var e=Ee.a.build("virtual-tour-page-visual__block__showcase",{visible:this.state.showModal});return a.a.createElement("div",{className:e},this.renderDisplay3DShowcaseButton(),this.renderMatterportIframe())}}Fc.propTypes={showcaseUrl:ve.PropTypes.string.isRequired,lang:ve.PropTypes.string.isRequired};var jc=Fc;class Vc extends a.a.Component{constructor(e){super(e),this.state={showModal:!1}}handleOpenClick(){this.setState({showModal:!0})}loadWistiaVideoScript(){var e=document.createElement("script"),t="//fast.wistia.com/embed/medias/".concat(this.props.virtualTourVideoPath,".jsonp");e.src=t,e.async=!0,window.wistiaInit=e=>e.options("".concat(this.props.virtualTourVideoPath),{autoPlay:!0}),document.querySelector("footer").appendChild(e)}loadWistiaAssetsScript(){var e=document.createElement("script");e.src="//fast.wistia.com/assets/external/E-v1.js",document.body.appendChild(e)}renderTriggerVideoButton(){return this.state.showModal?null:a.a.createElement("div",{onClick:this.handleOpenClick.bind(this),className:"virtual-tour-page__video__trigger"})}renderWistiaVideo(){return this.state.showModal?a.a.createElement("div",null,a.a.createElement("div",{className:"wistia_embed wistia_async_".concat(this.props.virtualTourVideoPath)},"Â "),this.loadWistiaVideoScript(),this.loadWistiaAssetsScript()):null}render(){return a.a.createElement("div",null,this.renderTriggerVideoButton(),this.renderWistiaVideo())}}Vc.propTypes={virtualTourVideoPath:ve.PropTypes.string.isRequired};var Uc=Vc;class Hc extends a.a.Component{constructor(e){super(e),l.a.setBucket("survey-popup"),this.state={isVisible:!1,willShow:!l.a.get("status")&&this.lottery()}}componentDidMount(){if(!this.state.willShow)return null;this.openPopup()}lottery(){var e=Math.random().toFixed(2);return l.a.setBucket("survey-popup"),e<.33?(l.a.set("status","winner"),!0):(l.a.set("status","looser"),!1)}openPopup(){setTimeout(()=>{this.setState({isVisible:!0})},5e3)}closePopup(e){l.a.setBucket("survey-popup"),l.a.set("status",e),this.setState({isVisible:!1})}handleCloseButtonClick(){this.closePopup("declined")}handleLinkButtonClick(){this.closePopup("accepted")}renderLinkButton(){return this.props.buttonTitle&&this.props.buttonLink?a.a.createElement("p",{className:"is-center"},a.a.createElement("a",{href:this.props.buttonLink,target:"_blank",className:"button survey-popup__link-button",onClick:()=>this.handleLinkButtonClick()},this.props.buttonTitle)):null}render(){return a.a.createElement("section",{className:"survey-popup"+(this.state.isVisible?" survey-popup--is-visible":"")},a.a.createElement("div",{className:"survey-popup__inner"},a.a.createElement("div",{className:"survey-popup__close",onClick:()=>this.handleCloseButtonClick()},a.a.createElement(Pe.a,{className:"survey-popup__close__icon",src:"/build/img/svg/icn-close.svg",cacheGetRequests:!0})),this.props.title?a.a.createElement("h2",{className:"survey-popup__title"},this.props.title):null,a.a.createElement("div",{className:"survey-popup__text",dangerouslySetInnerHTML:{__html:this.props.text}}),this.renderLinkButton(),this.props.legal?a.a.createElement("footer",{className:"survey-popup__footer"},this.props.legal):null))}}Hc.propTypes={buttonLink:ve.PropTypes.string,buttonTitle:ve.PropTypes.string,legal:ve.PropTypes.string,title:ve.PropTypes.string,text:ve.PropTypes.string.isRequired};var $c=Hc,Gc=a.a.Fragment;class zc extends a.a.Component{constructor(e){super(e),this.state={activeTabName:this.props.activeTabName},this.itemsCount=this.props.items.length,this.isSingleTab=1===this.itemsCount}componentDidMount(){this.manageHashtagNavigation()}handleItemClick(e){e.preventDefault();var t=p()(e.currentTarget).data("item");t===this.state.activeTabName&&Oe()&&!this.isSingleTab?(window.location.replace("#"),this.setState({activeTabName:""})):(window.location.replace("#".concat(t)),_e.a.pushDynamicEvent("contact-click-tab-".concat(t),window.DP.context.pageType),this.setState({activeTabName:t})),this.manageAriaTags()}manageHashtagNavigation(){var e=window.location.hash.substring(1);e&&(this.setState({activeTabName:e}),this.manageAriaTags())}manageAriaTags(){var e=p()(".".concat("contact-us__tabs_content")),t=p()(".".concat("contact-us__tabs-list__item"));t.find("a").attr("aria-selected","false"),e.attr("aria-hidden","true"),t.removeClass("contact-us__tabs-list__item--active"),e.removeClass("contact-us__tabs_content--active"),setTimeout(()=>{var e=p()(".".concat("contact-us__tabs_content","--").concat(this.state.activeTabName));p()(".".concat("contact-us__tabs-list__item","--").concat(this.state.activeTabName)).addClass("contact-us__tabs-list__item--active").find("a").attr("aria-selected","true"),e.addClass("contact-us__tabs_content--active").attr("aria-hidden","false")})}render(){return a.a.createElement("div",{className:"contact-us__container"},a.a.createElement("ul",{className:"contact-us__tabs-list contact-us__tabs-list--items-count-".concat(this.itemsCount)},this.props.items.map(({name:e,label:t,labelShort:s})=>this.renderTab(e,t,s))))}renderTabsContainer(e){if(e===this.state.activeTabName)return a.a.createElement("li",{className:"contact-us__tabs_container contact-us__tabs_container--mobile"},this.props.items.map(({name:e,subTitle:t,email:s,phoneLabel:i,phoneValue:a,phoneLink:r,openHours:n,subTitleOfferAssist:o,emailOfferAssist:l,phoneLabelOfferAssist:c,phoneValueOfferAssist:p,phoneLinkOfferAssist:d,openHoursOfferAssist:h,faxValue:u,faxValueOfferAssist:m,faxValueLink:g,faxValueLinkOfferAssist:_})=>this.renderTabContent(e,t,s,i,a,r,n,o,l,c,p,d,h,u,m,g,_)))}renderTab(e,t,s){var i=Oe()||this.isSingleTab?s:t,r=Ee.a.build("contact-us__tabs-list__item",{active:e===this.state.activeTabName,single:this.isSingleTab});return a.a.createElement(Gc,null,a.a.createElement("li",{key:"contactUsTabs:item:".concat(e),className:"".concat(r," ").concat("contact-us__tabs-list__item","--").concat(e)},a.a.createElement("button",{"aria-selected":"false","aria-labelledby":e,className:"contact-us__tabs-list__item-link","data-item":e,onClick:this.handleItemClick.bind(this),dangerouslySetInnerHTML:{__html:i}})),this.renderTabsContainer(e))}renderFaxNumber(e,t,s){if(void 0!==e)return a.a.createElement("a",{href:t,className:"contact-us__action-link contact-us__action-link--fax gtm__push-event gtm__push-event__contact-link-fax-".concat(s)},a.a.createElement(Pe.a,{className:"contact-us__action-link-icon contact-us__action-link-icon--fax",src:"/build/img/svg/purplebricks/icn-fax.svg",cacheGetRequests:!0}),a.a.createElement("span",null,"".concat(e)))}renderOpenHours(e){var t=[];for(var s of e)t.push(this.renderSingleOpenHour(s));return t}renderSingleOpenHour(e){return a.a.createElement("div",{className:"contact-us__open-hours-single"},a.a.createElement("span",{className:"contact-us__open-hours-days"},e.days)," ",a.a.createElement("span",{className:"contact-us__open-hours-hours"},e.hours))}renderMultiOpenHours(e){return e.map((e,t)=>a.a.createElement("div",{key:t,className:"contact-us__open-multi-hours"},a.a.createElement("h3",{className:"contact-us__open-multi-hours-title"},e.title),this.renderOpenHours(e.hours),void 0!==e.disclaimer&&a.a.createElement("small",{className:"contact-us__open-multi-hours-disclaimer"},e.disclaimer)))}renderTabContentDescription(e,t,s,i,r,n,o,l){return a.a.createElement("div",{className:"contact-us__tabs-list__item__description"},a.a.createElement("a",{href:i,className:"contact-us__action-link gtm__push-event gtm__push-event__contact-link-phone-".concat(l)},a.a.createElement(Pe.a,{className:"contact-us__action-link-icon contact-us__action-link-icon--phone",src:"/build/img/svg/icn-phone.svg",cacheGetRequests:!0}),a.a.createElement("span",null,"".concat(t," ").concat(s))),a.a.createElement("div",{className:"contact-us__open-hours"},void 0===r[0].title?this.renderOpenHours(r):this.renderMultiOpenHours(r)),a.a.createElement("a",{href:"mailto:".concat(e),className:"contact-us__action-link gtm-contact-us-link-email gtm__push-event gtm__push-event__contact-link-email-".concat(l)},a.a.createElement(Pe.a,{className:"contact-us__action-link-icon contact-us__action-link-icon--mail",src:"/build/img/svg/icn-mail.svg",cacheGetRequests:!0}),a.a.createElement("span",{className:"contact-us__action-link-address"},e)),this.renderFaxNumber(n,o,l))}renderTabContentOfferAssistTitle(e){return Oe()?a.a.createElement(Gc,null,a.a.createElement("h3",{className:"contact-us__tabs-list__item__title",dangerouslySetInnerHTML:{__html:e}})):a.a.createElement("h2",{className:"contact-us__tabs-list__item__title",dangerouslySetInnerHTML:{__html:e}})}renderTabContentOfferAssist(e,t,s,i,r,n,o,l,c,p){if(void 0!==s){var d="".concat(e,"-OA");return a.a.createElement(Gc,null,a.a.createElement("div",{key:"contactUsTabs:item-OA:".concat(e),className:"".concat(t," ").concat("contact-us__tabs_content","--").concat(e," ").concat("contact-us__tabs_content","--offer-assist"),"aria-hidden":"false"},this.renderTabContentOfferAssistTitle(s),this.renderTabContentDescription(i,r,n,o,l,c,p,d)))}}renderTabContent(e,t,s,i,r,n,o,l,c,p,d,h,u,m,g,_,b){var v=Ee.a.build("contact-us__tabs_content",{active:e===this.state.activeTabName});return a.a.createElement(Gc,null,a.a.createElement("div",{key:"contactUsTabs:item:".concat(e),className:"".concat(v," ").concat("contact-us__tabs_content","--").concat(e),"aria-hidden":"false"},a.a.createElement("h2",{className:"contact-us__tabs-list__item__title",dangerouslySetInnerHTML:{__html:t}}),this.renderTabContentDescription(s,i,r,n,o,m,_,e)),this.renderTabContentOfferAssist(e,v,l,c,p,d,h,u,g,b))}}zc.propTypes={activeTabName:ve.PropTypes.string.isRequired,items:ve.PropTypes.arrayOf(ve.PropTypes.shape({name:ve.PropTypes.string,label:ve.PropTypes.string,labelShort:ve.PropTypes.string,subTitle:ve.PropTypes.string,email:ve.PropTypes.string,phoneLabel:ve.PropTypes.string,phoneValue:ve.PropTypes.string,phoneLink:ve.PropTypes.string,faxValue:ve.PropTypes.string,faxValueLink:ve.PropTypes.string,openHours:ve.PropTypes.array,subTitleOfferAssist:ve.PropTypes.string,emailOfferAssist:ve.PropTypes.string,phoneLabelOfferAssist:ve.PropTypes.string,phoneValueOfferAssist:ve.PropTypes.string,phoneLinkOfferAssist:ve.PropTypes.string,faxValueLinkOfferAssist:ve.PropTypes.string,faxValueOfferAssist:ve.PropTypes.string,openHoursOfferAssist:ve.PropTypes.array})).isRequired};var Wc=zc,Kc=window.DP.context.pageType;class Yc extends a.a.Component{handleSelect(e){if(e.value){var t=this.labelGenerator(e.value);_e.a.pushToDataLayer("gtm-event",Kc,"Click_Category",t),window.location.href="".concat(this.props.baseUrl,"/").concat(e.value)}else p()(".".concat("select-dropdown__arrow")).click()}labelGenerator(e){return e.split("-").map(e=>e.charAt(0).toUpperCase()+e.substring(1)).join("")}render(){return a.a.createElement(qa.a,{dropdownId:"blog-category-dropdown",options:this.props.options,selected:this.props.selected,placeholder:this.props.placeholder,onSelect:this.handleSelect.bind(this)})}}Yc.propTypes={baseUrl:ve.PropTypes.string.isRequired,selected:ve.PropTypes.string,placeholder:ve.PropTypes.string.isRequired,options:ve.PropTypes.arrayOf(ve.PropTypes.shape({label:ve.PropTypes.string.isRequired,value:ve.PropTypes.string.isRequired})).isRequired};var Xc=Yc,Zc=s(196),Jc=s.n(Zc),Qc=s(19),ep=s(656),tp=e=>({type:"MODAL_SELECTED_ITEM",selected:e});function sp(){var e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n    display: flex;\n    position: absolute;\n    z-index: 1;\n    flex-direction: column;\n    align-items: center;\n    justify-content: space-around;\n    height: 100%;\n    width: 100%;\n    backface-visibility: hidden;\n    padding: 26px 12px;\n    margin-bottom: 1rem;\n    border-radius: 10px;\n    transition: 1s ease-in-out;\n\n    @media only screen and (min-width: ",") {\n        padding: 26px 30px;\n    }\n\n    &.card--blue {\n        border-top: 11px solid "," !important;\n        background-color: ",";\n    }\n\n    &.card--green {\n        border-top: 11px solid "," !important;\n        background-color: ",";\n    }\n\n    &.card--gray {\n        border-top: 11px solid "," !important;\n        background-color: ",";\n    }\n"]);return sp=function(){return e},e}var ip=En.default.div(sp(),Qc.h.xSmallSize,Qc.e,Qc.d,Qc.f,Qc.g,Qc.a,Qc.b),ap=({content:e,classes:t,cy:s})=>a.a.createElement(ip,{className:t,"data-cy":s},e);ap.propTypes={classes:ve.PropTypes.string,content:ve.PropTypes.oneOfType([ve.PropTypes.string,ve.PropTypes.func,ve.PropTypes.object,ve.PropTypes.element]),cy:ve.PropTypes.string};var rp=ap;function np(){var e=vp(["\n    position: absolute;\n    top: 16px;\n    right: 8px;\n    background: transparent;\n\n    .flip-card__icon-reload {\n        svg {\n            display: block;\n            width: 15px;\n            height: 17px;\n        }\n    }\n"]);return np=function(){return e},e}function op(){var e=vp(["\n    display: none;\n    font-size: 22px;\n    font-weight: 700;\n    color: ",";\n\n    "," {\n        display: block;\n    }\n\n    .flip-card__face--front & {\n        "," {\n            font-size: 20px;\n        }\n    }\n"]);return op=function(){return e},e}function lp(){var e=vp(["\n    display: none;\n    margin: 10px 0 0;\n    font-size: 15px;\n    font-weight: 600;\n    color: ",";\n\n    "," {\n        display: block;\n    }\n\n    .flip-card__face--front & {\n        "," {\n            font-size: 13px;\n        }\n    }\n"]);return lp=function(){return e},e}function cp(){var e=vp(["\n    width: 100%;\n    margin: 14px 0 0;\n\n    .select-dropdown {\n        margin: 0;\n    }\n\n    .select-dropdown__label {\n        padding: 14px 11px;\n        font-size: 16px;\n        font-weight: 700;\n        background-color: ",";\n        color: #fff;\n        border: none !important;\n\n        svg,\n        path {\n            fill: #fff;\n        }\n    }\n\n    .select-dropdown__arrow {\n        top: 15px;\n    }\n\n    .select-dropdown__option--selected,\n    .select-dropdown__option:focus,\n    .select-dropdown__option:hover {\n        background-color: ",";\n    }\n\n    .select-dropdown__placeholder {\n        margin: 0 auto;\n    }\n"]);return cp=function(){return e},e}function pp(){var e=vp(["\n    width: 100%;\n    padding: 14px 0;\n    margin: 14px 0;\n    font-size: 16px;\n    font-weight: 700;\n    background-color: ",";\n    color: #fff;\n    border-radius: 3px;\n    text-decoration: none;\n\n    "," {\n        max-width: 161px;\n        margin-top: 10px;\n\n        .flip-card__face--back & {\n            display: none;\n        }\n    }\n"]);return pp=function(){return e},e}function dp(){var e=vp(["\n    display: inline-block;\n    align-self: flex-start;\n    padding: 2px 0 10px;\n    font-size: 14px;\n    font-weight: 600;\n    color: ",";\n    text-decoration: none;\n"]);return dp=function(){return e},e}function hp(){var e=vp(["\n    align-self: stretch;\n    width: 100%;\n\n    &.flip-card__face__text--strike {\n        color: #bebebe;\n        text-decoration: line-through;\n    }\n\n    &.flip-card__face__text--optional::before {\n        font-weight: 700;\n        content: 'Add-on: ';\n    }\n\n    :lang(fr).flip-card__face__text--optional::before {\n        content: 'Ã€ la carte : ';\n    }\n"]);return hp=function(){return e},e}function up(){var e=vp(["\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin: 16px 0;\n    font-size: 14px;\n    font-weight: 600;\n    color: ",";\n\n    strong {\n        font-weight: 800;\n    }\n\n    a {\n        display: flex;\n        align-items: center;\n        width: 100%;\n        text-align: left;\n\n        &:active svg g {\n            stroke: ",";\n        }\n    }\n\n    .flip-card__face--back & {\n        &:last-child {\n            margin-top: 24px;\n            padding-top: 20px;\n            border-top: 1px solid #000;\n        }\n\n        margin: 17px 0;\n    }\n"]);return up=function(){return e},e}function mp(){var e=vp(["\n    width: 100%;\n"]);return mp=function(){return e},e}function gp(){var e=vp(["\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    width: 100%;\n\n    .flip-card__face--front & {\n        "," {\n            width: calc(40% - 20px);\n\n            &.flip-card__column--list {\n                flex: 1 1 100%;\n                order: 1;\n                justify-content: center;\n                width: calc(60% - 20px);\n                padding-left: 38px;\n                margin-left: 20px;\n\n                .card--blue & {\n                    border-left: 1px solid ",";\n                }\n\n                .card--green & {\n                    border-left: 1px solid ",";\n                }\n\n                .card--gray & {\n                    border-left: 1px solid ",";\n                }\n            }\n        }\n    }\n\n    .flip-card__face--back & {\n        "," {\n            flex-direction: row;\n            justify-content: center;\n\n            h3 {\n                display: inline-block;\n                margin: 0 0 0 5px !important;\n                text-transform: lowercase;\n            }\n        }\n    }\n\n    .flip-card__icon-more {\n        margin-top: 4px;\n\n        svg {\n            display: block;\n            width: 11px;\n            height: 11px;\n        }\n    }\n\n    .flip-card__icon-arrow-right {\n        margin: 0 0 0 5px;\n\n        svg {\n            display: inline-block;\n            width: 5px;\n            height: 9px;\n            fill: ",";\n        }\n    }\n\n    h2 {\n        font-size: 20px;\n        font-weight: 700;\n        line-height: 0.8;\n\n        .card--blue & {\n            color: ",";\n        }\n\n        .card--green & {\n            color: ",";\n        }\n\n        .card--gray {\n            color: ",";\n        }\n    }\n\n    h3 {\n        margin-bottom: 2px;\n        font-size: 20px;\n        font-weight: 600;\n        color: ",";\n        line-height: 1.5;\n    }\n"]);return gp=function(){return e},e}function _p(){var e=vp(["\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    width: 100%;\n\n    "," {\n        width: calc(40% - 20px);\n    }\n\n    h2 {\n        font-size: 20px;\n        font-weight: 700;\n        line-height: 0.8;\n\n        .card--blue & {\n            color: ",";\n        }\n\n        .card--green & {\n            color: ",";\n        }\n\n        .card--gray & {\n            color: ",";\n        }\n    }\n\n    h3 {\n        font-size: 40px;\n        font-weight: 600;\n        color: ",";\n\n        sup {\n            bottom: 0.9ex;\n            font-size: 60%;\n        }\n    }\n"]);return _p=function(){return e},e}function bp(){var e=vp(["\n    position: relative;\n    height: 464px;\n\n    "," {\n        height: 345px;\n    }\n\n    "," {\n        height: 494px;\n    }\n\n    .flip-card__face--front {\n        transform: perspective(1200px) rotateY(0deg);\n\n        "," {\n            flex-wrap: wrap;\n            justify-content: center;\n            transform: perspective(1200px) rotateX(0deg);\n        }\n    }\n\n    .flip-card__face--back {\n        border: 1px solid ",";\n        border-top: none;\n        background-color: #fff;\n        transform: perspective(1200px) rotateY(180deg);\n\n        "," {\n            transform: perspective(1200px) rotateX(180deg);\n        }\n\n        .select-dropdown {\n            margin-bottom: 4px;\n        }\n    }\n\n    &.flip-card--flipped {\n        .flip-card__face--front {\n            transform: perspective(1200px) rotateY(-179.9deg);\n\n            "," {\n                transform: perspective(1200px) rotateX(-179.9deg);\n            }\n        }\n\n        .flip-card__face--back {\n            transform: perspective(1200px) rotateY(0);\n\n            "," {\n                transform: perspective(1200px) rotateX(0);\n            }\n        }\n    }\n"]);return bp=function(){return e},e}function vp(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var yp="@media (min-width: 580px) and (max-width: 936px)",Tp=En.default.div(bp(),"@media (max-width: 936px)","@media (max-width: 579px)",yp,Qc.k,yp,yp,yp),fp=En.default.div(_p(),yp,Qc.e,Qc.f,Qc.k,Qc.i),Pp=En.default.div(gp(),yp,Qc.e,Qc.f,Qc.a,yp,Qc.c,Qc.e,Qc.f,Qc.k,Qc.i),Ep=En.default.ul(mp()),wp=En.default.li(up(),Qc.i,Qc.c),Cp=En.default.span(hp()),Sp=En.default.a(dp(),Qc.c),Rp=En.default.a(pp(),Qc.c,yp),Np=En.default.div(cp(),Qc.c,Qc.c),kp=En.default.p(lp(),Qc.i,"@media (max-width: 936px)",yp),Lp=En.default.a(op(),Qc.i,"@media (max-width: 936px)",yp),Op=En.default.button(np()),qp=({pricing:e})=>{var{back:t,cityId:s,common:r,front:n,packageCode:o,packageColor:l,packageId:c,packageName:p,packageType:d}=e,[h,u]=Object(i.useState)(!1),[m]=Object(ep.a)("packages"),g=[{label:m("subTypes.comm"),value:"COMM"},{label:m("subTypes.mult"),value:"MULT"}],_=(e,t)=>{e.preventDefault(),u(!h),t&&_e.a.pushDynamicEvent("pricing-slide-".concat(c,"-include-click"),window.DP.context.pageType)},b=()=>{Object(be.b)()&&!window.DP.configSwitch.NewSubscriptionPage&&window.scrollTo({behavior:"smooth",left:0,top:document.getElementById("packagesCallUs").offsetTop-50}),v()},v=()=>{_e.a.pushDynamicEvent("pricing-slide-".concat(c,"-cta-click"),window.DP.context.pageType)},y=(t,s)=>{var i=Ee.a.build("flip-card__face__text",{strike:"no"===t.status||!1===t.status||"0"===t.status,optional:"optional"===t.status});return a.a.createElement("a",{onClick:e=>((e,t,s)=>{e.preventDefault(),window.DP.store.dispatch({type:"SHOW_MODAL"}),window.DP.store.dispatch(tp(t)),_e.a.pushDynamicEvent("pricing-slide-".concat(c,"-item-").concat(s,"-click"),window.DP.context.pageType)})(e,t,s)},a.a.createElement(Cp,{className:i,dangerouslySetInnerHTML:{__html:t.list.replace(":HDR",e.common.photosHDR.served)}}),a.a.createElement(Pe.a,{className:"flip-card__icon-more",src:"/build/img/svg/icn-more.svg",cacheGetRequests:!0}))},T=(e,t)=>Object.entries(e).map(([e,s])=>a.a.createElement(wp,{key:e},y(s,t))),f=e=>{if(!window.DP.configSwitch.NewPackagesPage)return"#";if(window.DP.configSwitch.NewSubscriptionPage){var t=window.DP.urls.newSubscription,i=Pl()?"":"&city=".concat(s),a="&package=".concat(o.match(/\d+/g)),r="prov=".concat(window.DP.province),n="&type=".concat("MULT"===d?e:d);return"".concat(t,"?").concat(r).concat(a).concat(i).concat(n)}var l="",c="",p=Pl()?"":"&city=".concat(s),h="&package=".concat(o.match(/\d+/g)),u="&prov=".concat(window.DP.province),m="&type=".concat("RES"===d?e:d);return"fr"===window.DP.lang?(c="/vendre/adhesion/",l=Pl()?"compte?client-existant":"compte?nouveau-client"):(c="/sell/subscription/",l=Pl()?"account?client-exist":"account?new-user"),Object(be.b)()?"#":"".concat(c).concat(l).concat(u).concat(h).concat(p).concat(m)},P=()=>"MULT"===d?a.a.createElement(Np,null,a.a.createElement(qa.a,{dropdownId:"res-type-dropdown",onSelect:E.bind(void 0),options:g,placeholder:r.button})):a.a.createElement(Rp,{className:"js-noPopup","data-cy":"flipcard-buy-button",href:f(),onClick:b},r.button),E=e=>{window.location.href=f(e.value),v()},w=a.a.createElement(a.a.Fragment,null,a.a.createElement(fp,null,a.a.createElement("h2",null,p),a.a.createElement("h3",{dangerouslySetInnerHTML:{__html:n.price}})),a.a.createElement(Pp,{className:"flip-card__column--list"},a.a.createElement(Ep,null,T(n.items,"front")),void 0!==t&&a.a.createElement(Sp,{href:"#",onClick:e=>_(e,!0)},r.include,a.a.createElement(Pe.a,{cacheGetRequests:!0,className:"flip-card__icon-arrow-right",src:"/build/img/svg/icn-arrow-full-right.svg"}))),a.a.createElement(Pp,null,P(),a.a.createElement(kp,null,r.more),a.a.createElement(Lp,{href:"tel:".concat(r.phone),onClick:()=>{_e.a.pushDynamicEvent("pricing-slide-".concat(c,"-phone-click"),window.DP.context.pageType)}},r.phone))),C=Ee.a.build("flip-card",{flipped:h}),S=Ee.a.build("card",{blue:"blue"===l,green:"green"===l,gray:"gray"===l});return a.a.createElement(Tp,{className:C},a.a.createElement(rp,{classes:"flip-card__face flip-card__face--front ".concat(S),content:w,cy:"front-card-".concat(o)}),void 0===t?a.a.createElement("div",null,"Â "):a.a.createElement(rp,{classes:"flip-card__face flip-card__face--back ".concat(S),content:void 0===t?a.a.createElement("div",null,"Â "):a.a.createElement(a.a.Fragment,null,a.a.createElement("div",null,a.a.createElement(Op,{onClick:e=>_(e,!1)},a.a.createElement(Pe.a,{className:"flip-card__icon-reload",src:"/build/img/svg/icn-reload.svg",cacheGetRequests:!0}))),a.a.createElement(Pp,null,a.a.createElement("h2",null,p),a.a.createElement("h3",null,t.include)),a.a.createElement(Pp,null,a.a.createElement(Ep,null,T(t.items,"back")),P()))}))};qp.propTypes={pricing:ve.PropTypes.object.isRequired};var xp=qp;function Mp(){var e=jp(["\n    width: 100%;\n    margin-top: 30px;\n    font-size: 10px;\n    text-align: center;\n"]);return Mp=function(){return e},e}function Dp(){var e=jp(["\n    position: absolute;\n    top: 15px;\n    right: 15px;\n    cursor: pointer;\n\n    .pricing-modal__close-button-icon {\n        display: block;\n\n        svg {\n            width: 20px;\n            height: 20px;\n            transition: fill 0.2s ease;\n            fill: #b9b9b9;\n        }\n\n        svg:focus,\n        svg:hover {\n            fill: #58bf26;\n        }\n\n        svg:active {\n            fill: #369600;\n        }\n    }\n"]);return Dp=function(){return e},e}function Ap(){var e=jp(["\n    width: 100%;\n    font-size: 14px;\n    color: #333;\n    text-align: center;\n\n    .pricing-modal__description--italic {\n        font-style: italic;\n    }\n"]);return Ap=function(){return e},e}function Ip(){var e=jp(["\n    display: block;\n    margin-bottom: 15px;\n    width: 100%;\n    font-size: 20px;\n    font-weight: 600;\n    color: #333;\n    text-align: center;\n"]);return Ip=function(){return e},e}function Bp(){var e=jp(["\n    position: fixed;\n    display: none;\n    z-index: 10000;\n    top: 0;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    box-sizing: border-box;\n    padding: 50px;\n    margin: auto;\n    background: #fff;\n    transition: all 0.4s ease;\n    touch-action: pan-y;\n\n    &.pricing-modal--visible {\n        display: flex;\n        transform: translate(0, 0);\n        animation: fadeInAnimation ease 300ms;\n    }\n\n    @media (min-width: 769px) {\n        &.pricing-modal--visible {\n            width: 600px;\n            height: 400px;\n        }\n\n        &.pricing-modal--hidden {\n            display: none;\n            transform: translate(0, 100%);\n        }\n    }\n\n    @keyframes fadeInAnimation {\n        0% {\n            opacity: 0;\n        }\n\n        100% {\n            opacity: 1;\n        }\n    }\n"]);return Bp=function(){return e},e}function Fp(){var e=jp(["\n    display: none;\n    position: fixed;\n    z-index: 10000;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(0, 0, 0, 0.75);\n\n    &.overlay-modal--visible {\n        display: block;\n\n        @media (max-width: 768px) {\n            display: none;\n        }\n    }\n"]);return Fp=function(){return e},e}function jp(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var Vp=En.default.div(Fp()),Up=En.default.div(Bp()),Hp=En.default.h2(Ip()),$p=En.default.p(Ap()),Gp=En.default.a(Dp()),zp=En.default.small(Mp());class Wp extends a.a.Component{constructor(e){super(e),this.state={yAxisDown:0,yAxisUp:0}}componentDidMount(){this.$html=p()("html")}componentDidUpdate(){this.props.modalVisible?this.$html.css("overflow","hidden"):this.$html.css("overflow","auto")}handleTouchMove(e){this.setState({yAxisUp:Math.floor(e.changedTouches[0].pageY)});var t=this.state.yAxisUp-this.state.yAxisDown-30,s=t>0?t:0;e.currentTarget.style.transform="translate(0, ".concat(s,"px)")}handleTouchStart(e){this.setState({yAxisDown:Math.floor(e.changedTouches[0].pageY)})}handleTouchEnd(e){this.state.yAxisUp>=this.state.yAxisDown+30?(this.hideModal(),e.currentTarget.style.removeProperty("transform")):e.currentTarget.style.transform="translate(0, 0)"}handleCloseButton(e){e.preventDefault(),this.hideModal(),e.currentTarget.parentElement.style.removeProperty("transform")}hideModal(){window.DP.store.dispatch({type:"HIDE_MODAL"}),window.DP.store.dispatch(tp(null))}renderTitle(){var e=this.props.modalContent?this.props.modalContent.modal.title:"";return a.a.createElement(Hp,null,e)}renderDescription(){var e=this.props.modalContent?this.props.modalContent.modal.description:"";return a.a.createElement($p,{dangerouslySetInnerHTML:{__html:e}})}renderCloseButton(){return a.a.createElement(Gp,{href:"#",onClick:this.handleCloseButton.bind(this)},a.a.createElement(Pe.a,{className:"pricing-modal__close-button-icon",src:"/build/img/svg/icn-close-thin.svg",cacheGetRequests:!0}))}renderDisclaimer(){if(this.props.modalContent){var e=this.props.modalContent.modal.disclaimer;return e&&a.a.createElement(zp,{dangerouslySetInnerHTML:{__html:e}})}}render(){var e=Ee.a.build("pricing-modal",{visible:this.props.modalVisible,hidden:!this.props.modalVisible}),t=Ee.a.build("overlay-modal",{visible:this.props.modalVisible});return a.a.createElement(a.a.Fragment,null,a.a.createElement(Vp,{className:"".concat(t),onClick:this.handleCloseButton.bind(this)}),a.a.createElement(Up,{className:"".concat(e),onTouchMove:this.handleTouchMove.bind(this),onTouchStart:this.handleTouchStart.bind(this),onTouchEnd:this.handleTouchEnd.bind(this)},this.renderCloseButton(),this.renderTitle(),this.renderDescription(),this.renderDisclaimer()))}}Wp.propTypes={modalContent:ve.PropTypes.object,modalVisible:ve.PropTypes.bool};var Kp=Wp;function Yp(){var e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    margin: 0;\n    padding: 0.4rem 0.5rem;\n    width: 100%;\n    height: 62px;\n    background-color: #fff;\n    color: #333;\n    font-size: 0.9rem;\n    font-weight: 700;\n    border: 1px solid #333;\n    border-radius: 7px;\n    cursor: pointer;\n    text-align: left;\n    line-height: 1.1em;\n    white-space: pre-line;\n\n    &:hover,\n    &.selected {\n        border: 2px solid #58bf26;\n        background-color: #e7fbe0;\n    }\n"]);return Yp=function(){return e},e}var Xp=En.default.button(Yp()),Zp=({selected:e=!1,handleOnClick:t,children:s})=>a.a.createElement(Xp,{className:"".concat(e?"selected":""),selected:!!e,onClick:e=>{t(e)}},s);Zp.propTypes={selected:ve.PropTypes.bool,handleOnClick:ve.PropTypes.func.isRequired,children:ve.PropTypes.oneOfType([ve.PropTypes.string,ve.PropTypes.array,ve.PropTypes.object]).isRequired};var Jp=Zp;function Qp(){var e=td(["\n    display: none;\n    margin: 1rem auto;\n    width: 50%;\n    min-width: 264px;\n\n    .select-dropdown__label {\n        justify-content: center;\n        border: 1px solid #333 !important;\n        border-radius: 0;\n        font-size: 0.8rem;\n        font-weight: 700;\n        color: #333;\n    }\n\n    @media (max-width: 768px) {\n        display: block;\n    }\n"]);return Qp=function(){return e},e}function ed(){var e=td(["\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 100%;\n    margin: 2rem auto;\n\n    @media (max-width: 936px) {\n        width: auto;\n        margin: 2rem 50px;\n    }\n\n    @media (max-width: 768px) {\n        display: none;\n    }\n\n    li {\n        flex: 1 0 25%;\n        padding: 0 0.5rem;\n    }\n"]);return ed=function(){return e},e}function td(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var sd=En.default.ul(ed()),id=En.default.div(Qp()),ad=({selectedType:e,handleOnClick:t})=>{if(!window.DP.configSwitch.NewPackagesPage)return null;var[s]=Object(ep.a)("packages"),i=[{label:s("types.residential"),value:"RES"},{label:s("types.multiplex"),value:"MULT"},{label:s("types.newHomes"),value:"CONS"},{label:s("types.land"),value:"TERR"}];return a.a.createElement(a.a.Fragment,null,a.a.createElement(sd,null,a.a.createElement("li",null,a.a.createElement(Jp,{handleOnClick:()=>t("RES"),selected:"RES"===e},a.a.createElement(Rl.a,{clsName:"",name:"residential",color:"#333",dimension:"30px",padding:"0.4rem 0.6rem 0.4rem 0"}),s("types.residential"))),a.a.createElement("li",null,a.a.createElement(Jp,{handleOnClick:()=>t("MULT"),selected:"MULT"===e},a.a.createElement(Rl.a,{clsName:"",name:"multiplex",color:"#333",dimension:"25px",padding:"0.4rem 0.6rem 0.4rem 0"}),s("types.multiplex"))),a.a.createElement("li",null,a.a.createElement(Jp,{handleOnClick:()=>t("CONS"),selected:"CONS"===e},a.a.createElement(Rl.a,{clsName:"",name:"newhomes",color:"#333",dimension:"30px",padding:"0.4rem 0.6rem 0.4rem 0"}),s("types.newHomes"))),a.a.createElement("li",null,a.a.createElement(Jp,{handleOnClick:()=>t("TERR"),selected:"TERR"===e},a.a.createElement(Rl.a,{clsName:"",name:"land",color:"#333",dimension:"30px",padding:"0.4rem 0.6rem 0.4rem 0"}),s("types.land")))),a.a.createElement(id,null,a.a.createElement(qa.a,{dropdownId:"property-type-dropdown",options:i,selected:e,onSelect:(e=>{t(e.value),window.Dropdown("hide")}).bind(void 0)})))};ad.propTypes={selectedType:ve.PropTypes.string.isRequired,handleOnClick:ve.PropTypes.func.isRequired};var rd=ad;function nd(){var e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n    font-size: 1.25rem;\n    font-weight: 700;\n    text-align: center;\n\n    sup {\n        font-weight: 600;\n        font-size: 0.7rem;\n    }\n\n    @media (max-width: 768px) {\n        display: none;\n    }\n"]);return nd=function(){return e},e}var od=En.default.h2(nd()),ld=({selectedType:e})=>{if(!window.DP.configSwitch.NewPackagesPage)return null;var[t]=Object(ep.a)("packages"),s=t("subTitle.residential");switch(e){case"MULT":s=t("subTitle.multiplex");break;case"CONS":s=t("subTitle.newHomes");break;case"TERR":s=t("subTitle.land")}return a.a.createElement(od,{dangerouslySetInnerHTML:{__html:s}})};ld.propTypes={selectedType:ve.PropTypes.string.isRequired};var cd=ld,pd=s(76),dd=e=>new Promise((t,s)=>{var i="".concat(window.DP.urls.proxyPackages);p.a.ajax({url:i,data:e}).done(e=>{e||s(),t(e)}).fail(s)}),hd=s(657),ud=s(64),md=s(68),gd=s(417),_d=s(197),bd=s(418),vd=s(419);function yd(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function Td(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?yd(Object(s),!0).forEach((function(t){fd(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):yd(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function fd(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var Pd=Td(Td(Td(Td({},gd),_d),bd),vd),Ed=s(420),wd=s(198),Cd=s(421),Sd=s(422);function Rd(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function Nd(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Rd(Object(s),!0).forEach((function(t){kd(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Rd(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function kd(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var Ld=Nd(Nd(Nd(Nd({},Ed),wd),Cd),Sd);ud.a.use(md.e).init({fallbackLng:"en",debug:!0,react:{wait:!0},resources:{fr:Pd,en:Ld},interpolation:{escapeValue:!1}});var Od=ud.a;function qd(){return(qd=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e}).apply(this,arguments)}function xd(){var e=Ad(["\n    display: flex;\n    flex-direction: column;\n    text-align: left;\n    align-items: center;\n    width: 75%;\n    max-width: 670px;\n    margin: 20px auto;\n    padding: 15px;\n    color: ",";\n    font-size: 0.9rem;\n    border: 1px solid ",";\n    border-radius: 10px;\n    background-color: rgba(255, 192, 203, 0.2);\n\n    > span {\n        flex-basis: 15%;\n        padding-bottom: 10px;\n\n        svg {\n            fill: red;\n            width: 20px;\n            height: 20px;\n        }\n    }\n\n    @media (min-width: 768px) {\n        flex-direction: row;\n\n        > span {\n            padding-bottom: 0;\n        }\n    }\n"]);return xd=function(){return e},e}function Md(){var e=Ad(["\n    max-width: 1024px;\n    margin: 0 auto;\n\n    .slick-slider {\n        display: flex;\n        flex-direction: column-reverse;\n\n        .slick-track {\n            margin: 35px auto 25px;\n            width: 100% !important;\n\n            @media (max-width: 936px) {\n                width: calc(300%) !important;\n            }\n        }\n\n        .slick-slide {\n            width: calc(33.33%) !important;\n            padding: 0 8px;\n            touch-action: pan-y;\n\n            div {\n                outline: none;\n            }\n        }\n    }\n\n    .pricing-carrousel__dots {\n        display: flex !important;\n        justify-content: center;\n        margin: 0 0 -15px;\n\n        .slick-active button {\n            background: ",";\n        }\n\n        button {\n            width: 7px;\n            height: 7px;\n            margin: 0 7px 0 0;\n            padding: 0;\n            background: rgba(102, 102, 102, 0.3);\n            border-radius: 50%;\n            font-size: 0;\n            outline: none;\n            transition: background 0.1s ease;\n        }\n    }\n"]);return Md=function(){return e},e}function Dd(){var e=Ad(["\n    margin: 20px 0;\n\n    @media (max-width: 1020px) {\n        margin: 0;\n    }\n"]);return Dd=function(){return e},e}function Ad(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var Id={infinite:!1,arrows:!1,dots:!1,swipeToSlide:!1,focusOnSelect:!0,centerMode:!0,speed:200,slidesToShow:3,centerPadding:"0",dotsClass:"pricing-carrousel__dots",responsive:[{breakpoint:937,settings:{dots:!0,swipeToSlide:!0,slidesToShow:1,slidesToScroll:1,centerPadding:"50px"}},{breakpoint:375,settings:{dots:!0,swipeToSlide:!0,slidesToShow:1,slidesToScroll:1,centerPadding:"35px"}},{breakpoint:320,settings:{dots:!0,swipeToSlide:!0,slidesToShow:1,slidesToScroll:1,centerPadding:"20px"}}]},Bd=En.default.div(Dd()),Fd=En.default.div(Md(),Qc.k),jd=En.default.span(xd(),Qc.i,Qc.j),Vd=document.getElementsByTagName("html")[0].getAttribute("lang")||"fr";Od.changeLanguage(Vd);class Ud extends a.a.Component{constructor(e){super(e);var t=window.DP.isNewHomes?"CONS":"RES";this.state={packages:[],prestigeShown:!1,premiumShown:!1,classicShown:!1,selectedType:t,loading:!0,hasFailed:!1},this.slideVisibility=this.slideVisibility.bind(this),this.handleTypeSelectionClick=this.handleTypeSelectionClick.bind(this)}fetchPackages(e){this.setState({loaded:!1}),dd({group:e}).then(e=>{this.setState({loading:!1}),this.setState({packages:e})}).catch(()=>{this.setState({loading:!1,hasFailed:!0})})}componentDidMount(){var e=location.hash.substr(1);if(["CONS","TERR","COMM","MULT"].includes(e)){var t="COMM"===e?"MULT":e;this.typeSelection(t)}else this.fetchPackages(this.state.selectedType)}componentDidUpdate(e,t,s){var{loading:i}=this.state;i||i===t.loading||(this.$prestige=document.querySelector(".".concat("js-slide-1")),this.$premium=document.querySelector(".".concat("js-slide-2")),this.$classic=document.querySelector(".".concat("js-slide-3")),document.addEventListener("DOMContentLoaded",()=>{window.$window.on("scroll.".concat("js-slide-1"),this.slideVisibility),this.slideVisibility()}))}slideVisibility(){this.isVisible(this.$prestige)&&!this.state.prestigeShown&&(this.handleGtmSlideView("LaTotale"),this.setState({prestigeShown:!0}),window.$window.off("scroll.".concat("js-slide-1"))),this.isVisible(this.$premium)&&!this.state.premiumShown&&(this.handleGtmSlideView("LeGrosForfait"),this.setState({premiumShown:!0})),this.isVisible(this.$classic)&&!this.state.classicShown&&(this.handleGtmSlideView("LeDeBase"),this.setState({classicShown:!0}))}handleGtmSlideView(e){_e.a.pushToDataLayer("gtm-event",window.DP.context.pageType,"View_Package",e)}handleGtmMenuClick(e){_e.a.pushDynamicEvent("pricing-menu-".concat(e.toLowerCase(),"-click"),window.DP.context.pageType)}handleTypeSelectionClick(e){this.typeSelection(e),window.location.hash=e,this.handleGtmMenuClick(e)}typeSelection(e){this.setState({loading:!0}),this.setState({selectedType:e}),this.fetchPackages(e),window.DP.store.dispatch({type:"SELECTED_PACKAGE",selected:e})}isVisible(e){if(null===e)return null;var{top:t,bottom:s,x:i,right:a}=e.getBoundingClientRect(),r=window.innerHeight||document.documentElement.clientHeight,n=window.innerWidth||document.documentElement.clientWidth;return(t>0||s>0)&&t<r&&i+a<=n}filterItems(e,t){var s={},i=Object.keys(e).map(e=>e);for(var a in t)t.hasOwnProperty(a)&&i.includes(a)&&(s[a]=t[a],s[a].status=e[a]);return s}applyDynamicValues(e,t){var s=JSON.stringify(e);for(var i in t)if(t.hasOwnProperty(i)){var a=new RegExp(":".concat(i),"i");s=s.replace(a,t[i])}return JSON.parse(s)}renderPackagesCards(){if(this.state.loading)return a.a.createElement(pd.a,null);var e=0,t=this.state.packages.sort((e,t)=>e.code>t.code?-1:1);return("CONS"===this.state.selectedType?t.reverse():t).map(t=>{if("OWN_ADH_4"===t.code||"OWN_ADH_MULT_4"===t.code||void 0===this.props[t.code])return!1;e++;var s=this.props[t.code],i={common:this.props.common,packageId:s.id,packageName:s.name,packageColor:s.color,packageCode:t.code,cityId:t.cityId,packageType:this.state.selectedType},r=s.front.items;Object.keys(t).map(e=>e);if(i.front={items:this.filterItems(t,r),price:Js(d.a.encodeCurrencyValue(t.price,{noDollarSign:!0,noDecimal:!1}))},void 0!==s.back){var n=s.back.items;i.back={include:s.back.include,items:this.filterItems(t,n)}}return i=this.applyDynamicValues(i,t),a.a.createElement("div",{className:"js-slide-".concat(e),key:e},a.a.createElement(xp,{pricing:i}))})}renderWarningIcon(){return a.a.createElement(Pe.a,{src:"/build/img/svg/icn-warning.svg",cacheGetRequests:!0})}renderErrorMessage(){return a.a.createElement(jd,null,this.renderWarningIcon(),this.props.common.error)}renderIncompatiblePackageErrorMessage(){var e={incompatible_package:"incompatiblePackage",incompatible_package_builder:"incompatiblePackageBuilder"}[new URLSearchParams(window.location.search).get("return")];return void 0!==e?a.a.createElement(jd,{"data-cy":"warning-incompatible-package"},this.renderWarningIcon(),Od.t("packages:error.".concat(e),Vd)):null}renderSlider(){return this.state.hasFailed?this.renderErrorMessage():a.a.createElement(Fd,null,this.renderIncompatiblePackageErrorMessage(),a.a.createElement(rd,{handleOnClick:this.handleTypeSelectionClick,selectedType:this.state.selectedType}),a.a.createElement(cd,{selectedType:this.state.selectedType}),a.a.createElement(Jc.a,qd({},Id,{afterChange:this.slideVisibility}),this.renderPackagesCards()),a.a.createElement(Kp,{modalContent:this.props.currentItem,modalVisible:this.props.visible}))}render(){return a.a.createElement(hd.a,{i18n:Od},a.a.createElement(En.ThemeProvider,{theme:{style:"default"}},a.a.createElement(Bd,null,this.renderSlider())))}}Ud.propTypes={common:ve.PropTypes.object.isRequired,BLD_ADH_1:ve.PropTypes.object,BLD_ADH_2:ve.PropTypes.object,OWN_ADH_1:ve.PropTypes.object,OWN_ADH_2:ve.PropTypes.object,OWN_ADH_3:ve.PropTypes.object,OWN_ADH_TERR_1_SS:ve.PropTypes.object,OWN_ADH_TERR_2_SS:ve.PropTypes.object,OWN_ADH_MULT_1:ve.PropTypes.object,OWN_ADH_MULT_2:ve.PropTypes.object,OWN_ADH_MULT_3:ve.PropTypes.object,visible:ve.PropTypes.bool,currentItem:ve.PropTypes.object,currentPackage:ve.PropTypes.string};var Hd=Ud=Object(u.b)(({Modal:e,Packages:t})=>{var{visible:s,currentItem:i}=e,{currentPackage:a}=t;return{visible:s,currentItem:i,currentPackage:a}})(Ud),$d=m.createProviderWrappedComponent(e=>a.a.createElement(Hd,e));class Gd extends a.a.Component{renderDisclaimer(){var e=this.props.residential;switch(this.props.currentPackage){case"MULT":e=this.props.multiplex;break;case"CONS":e=this.props.builder;break;case"TERR":e=this.props.land}return e}render(){return window.DP.context.route==="".concat(window.DP.lang,"::sell::pricing")&&a.a.createElement("div",{dangerouslySetInnerHTML:{__html:this.renderDisclaimer()}})}}Gd.propTypes={residential:ve.PropTypes.string,multiplex:ve.PropTypes.string,builder:ve.PropTypes.string,land:ve.PropTypes.string,currentPackage:ve.PropTypes.string.isRequired};var zd=Gd=Object(u.b)(({Packages:e})=>{var{currentPackage:t}=e;return{currentPackage:t}})(Gd),Wd=m.createProviderWrappedComponent(e=>a.a.createElement(zd,e));function Kd(){var e=Xd(["\n    padding: 0 45px 20px;\n    text-align: center;\n    border: none;\n\n    @media only screen and (max-width: 768px) {\n        padding: 0 45px 40px;\n        border-bottom: solid 10px #f6f6f6;\n    }\n\n    > div {\n        margin-top: -15px;\n        margin-bottom: 30px;\n        font-size: 9px;\n        color: #666;\n    }\n\n    > p {\n        font-size: 20px;\n        font-weight: 600;\n        line-height: 1;\n\n        span {\n            display: inline-block;\n            font-size: 20px;\n            font-weight: 700;\n\n            @media (max-width: 640px) {\n                display: block;\n            }\n        }\n    }\n\n    > a {\n        display: block;\n        margin-top: 10px;\n        font-size: 14px;\n        font-weight: 600;\n        color: #00c6ff;\n        text-decoration: none;\n\n        span {\n            display: inline-block;\n            width: 5px;\n            margin: 0 0 0 5px;\n\n            svg {\n                display: inline-block;\n                width: 5px;\n                height: 9px;\n                fill: #00c6ff;\n            }\n        }\n    }\n"]);return Kd=function(){return e},e}function Yd(){var e=Xd(["\n    margin: 20px 0;\n    height: 65px;\n\n    @media only screen and (max-width: 1020px) {\n        margin: 0;\n    }\n\n    @media only screen and (max-width: 768px) {\n        height: auto;\n    }\n"]);return Yd=function(){return e},e}function Xd(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var Zd=En.default.div(Yd()),Jd=En.default.div(Kd());class Qd extends a.a.Component{handleClickDetails(e){e.preventDefault(),window.DP.store.dispatch({type:"SHOW_MODAL"}),window.DP.store.dispatch(tp(this.props.modal)),_e.a.pushToDataLayer("gtm-event",window.DP.context.pageType,"Click_Financing","Overlay-Button")}renderNoPaymentInfo(){if("RES"!==this.props.currentPackage)return!1;var{content:e,btnLabel:t}=this.props;return a.a.createElement(a.a.Fragment,null,a.a.createElement("p",{dangerouslySetInnerHTML:{__html:e}}),a.a.createElement("a",{onClick:this.handleClickDetails.bind(this),href:"#"},t,a.a.createElement(Pe.a,{src:"/build/img/svg/icn-arrow-full-right.svg",cacheGetRequests:!0})))}renderFooter(){return a.a.createElement(Jd,null,this.renderNoPaymentInfo())}render(){return a.a.createElement(Zd,null,this.renderFooter())}}Qd.propTypes={content:ve.PropTypes.string,btnLabel:ve.PropTypes.string,modal:ve.PropTypes.object,visible:ve.PropTypes.bool,currentItem:ve.PropTypes.object,currentPackage:ve.PropTypes.string};var eh=Qd=Object(u.b)(({Modal:e,Packages:t})=>{var{visible:s,currentItem:i}=e,{currentPackage:a}=t;return{visible:s,currentItem:i,currentPackage:a}})(Qd),th=m.createProviderWrappedComponent(e=>a.a.createElement(eh,e));class sh extends a.a.Component{render(){return this.props.showWarningMessage?a.a.createElement(Ni,{message:this.props.geoWarningMessage}):null}}sh.propTypes={geoWarningMessage:ve.PropTypes.string.isRequired,showWarningMessage:ve.PropTypes.bool};var ih=sh=Object(u.b)(({warningMessageBar:e})=>{var{showWarningMessage:t}=e;return{showWarningMessage:t}})(sh),ah=m.createProviderWrappedComponent(e=>a.a.createElement(ih,e));class rh extends a.a.Component{constructor(e){super(e),this.state={formDoYouSell:this.props.form.doYouSellOptions[0].value,formEmail:"",formFirstName:"",formLastName:"",formPhone:"",displayedMessage:"",hasSucceed:!1,hasFailed:!1,isSubmitting:!1,showPopinSuccess:!1,hidePopin:!0,emailConsentChecked:!1},this.handleValueChange=this.handleValueChange.bind(this)}scrollToItem(){window.scrollTo(0,p()(this.refs.refForm).offset().top-50)}handleValueChange(e){this.setState({[e.target.name]:e.target.value})}handleDoYouSellValueChange(e){this.setState({formDoYouSell:e.value}),window.Dropdown("hide")}handleEmailConsentClick(e){this.setState({emailConsentChecked:!e})}handleButtonClick(){this.resetState(),this.setState({isSubmitting:!0});var e=this.state.formEmail,t=this.state.emailConsentChecked,s=this.state.formFirstName,i=this.state.formLastName,a=this.state.formDoYouSell,r=this.state.formPhone,n=window.DP.province,o=this.props.form.leadSource,l=this.props.form.leadSource;"placeholder"===a?(this.setState({errorField:"likely_sell",displayedMessage:this.props.form.error.likelySell,isSubmitting:!1,hasFailed:!0}),this.scrollToItem()):Yn({email:e,emailConsent:t,firstname:s,lastname:i,likely_sell:a,phone:r.replace(/\D/g,""),province:n,source:o,description:l,campaign_id:this.props.campaign,attendees_count:1}).then(()=>{this.setState({displayedMessage:this.props.form.success,hasSucceed:!0,isSubmitting:!1,hidePopin:!1,showPopinSuccess:!0}),this.resetFormInformation(),_e.a.pushToDataLayer("gtm-event","WebinarPage","Subscribe","Webinar")}).catch(e=>{var t=null,s="";e.status>400?s=this.props.form.error.generic:(t=e.responseJSON.field,s=e.responseJSON.message),this.setState({errorField:t,displayedMessage:s,isSubmitting:!1,hasFailed:!0}),this.scrollToItem()})}resetState(){this.setState({hasSucceed:!1,hasFailed:!1,displayedMessage:"",errorField:null,showPopinSuccess:!1,hidePopin:!0})}resetFormInformation(){this.setState({formEmail:"",emailConsentChecked:!1,formFirstName:"",formLastName:"",formDoYouSell:this.props.form.doYouSellOptions[0].value,formPhone:""})}renderMessage(){var e=Ee.a.build("comparison-form__message",{isError:this.state.hasFailed,isSuccess:this.state.hasSucceed});return a.a.createElement("div",{className:e},this.state.displayedMessage)}renderFirstNameField(){var e=Ee.a.build("comparison-form__field",{invalid:"name"===this.state.errorField});return a.a.createElement("input",{className:e,type:"text",name:"formFirstName",placeholder:this.props.form.firstNamePlaceholder,value:this.state.formFirstName,onChange:this.handleValueChange})}renderLastNameField(){var e=Ee.a.build("comparison-form__field",{invalid:"name"===this.state.errorField});return a.a.createElement("input",{className:e,type:"text",name:"formLastName",placeholder:this.props.form.lastNamePlaceholder,value:this.state.formLastName,onChange:this.handleValueChange})}renderDoYouSellField(){var e=Ee.a.build("comparison-form__field",{invalid:"likely_sell"===this.state.errorField});return a.a.createElement("div",{className:"".concat("comparison-form__dd-field"," ").concat(e)},a.a.createElement(qa.a,{dropdownId:"comparison-form-dropdown",options:this.props.form.doYouSellOptions,selected:this.state.formDoYouSell,name:"formDoYouSell",onSelect:this.handleDoYouSellValueChange.bind(this)}))}renderPhoneField(){var e=Ee.a.build("comparison-form__field",{invalid:this.handlePhoneFieldInvalid()});return a.a.createElement(yn.a,{className:e,mask:"999-999-9999",name:"formPhone",placeholder:this.props.form.phonePlaceholder,value:this.state.formPhone,onChange:this.handleValueChange})}renderEmailField(){var e=Ee.a.build("comparison-form__field",{invalid:"from"===this.state.errorField});return a.a.createElement("input",{className:e,placeholder:this.props.form.emailPlaceholder,value:this.state.formEmail,name:"formEmail",type:"email",maxLength:"80",onChange:this.handleValueChange})}renderEmailConsent(){var e=this.state.emailConsentChecked;return a.a.createElement("div",{onClick:this.handleEmailConsentClick.bind(this,e),className:"comparison-form__check-field"},a.a.createElement(vt,{checked:e}),a.a.createElement("p",{className:"infosession-form__email-consent-text"},this.props.form.emailConsentLabel))}renderSubmitButton(){return this.state.isSubmitting?a.a.createElement("button",{className:"comparison-form__button comparison-form__button--submitting"},a.a.createElement("div",{className:"comparison-form__button-content"},a.a.createElement(we.a,null))):a.a.createElement("button",{onClick:this.handleButtonClick.bind(this),className:"comparison-form__button"},this.props.submitButtonLabel)}renderContent(){return a.a.createElement("div",{className:"comparison-form__container"},a.a.createElement("div",{className:"comparison-form__container-form"},a.a.createElement("h2",{className:"comparison-form__intro-title",dangerouslySetInnerHTML:{__html:this.props.titleIntro}}),a.a.createElement("p",{className:"comparison-form__intro-text",dangerouslySetInnerHTML:{__html:this.props.textIntro}}),this.renderFormContent()),a.a.createElement("div",{className:"comparison-form__container-image"},a.a.createElement("img",{src:"/build/img/jpg/landingpages/landing-comparison/laptop-and-mobile-".concat(window.DP.lang,".jpg"),alt:""})))}renderDisclaimer(){return a.a.createElement("div",{className:"comparison-form__disclaimer",dangerouslySetInnerHTML:{__html:this.props.form.disclaimer}})}renderFormContent(){return a.a.createElement("div",{className:"comparison-form__content"},this.state.displayedMessage?this.renderMessage():null,a.a.createElement("div",{className:"comparison-form__field-group"},this.renderFirstNameField(),this.renderLastNameField(),this.renderEmailField(),this.renderPhoneField(),this.renderDoYouSellField(),this.renderDisclaimer(),this.renderEmailConsent()),this.renderSubmitButton())}renderPopin(){return this.state.hidePopin?null:a.a.createElement("div",{className:"comparison-form-popin"},a.a.createElement("div",{className:"comparison-form-popin--inner"},this.renderPopinText(),a.a.createElement("div",{className:"comparison-form-popin__close",onClick:this.handlePopinCloseAction.bind(this)},a.a.createElement(Pe.a,{className:"comparison-form-popin__close-icon",src:"/build/img/svg/icn-close.svg",cacheGetRequests:!0}))))}renderPopinText(){var e="";return this.state.showPopinSuccess&&(e=this.props.popinSuccessText),a.a.createElement("div",{className:"comparison-form-popin__text",dangerouslySetInnerHTML:{__html:e}})}render(){var e=Ee.a.build("comparison-form",{success:this.state.hasSucceed});return a.a.createElement("div",{className:e,ref:"refForm"},this.renderContent(),this.renderPopin())}handlePopinCloseAction(){this.setState({hidePopin:!0})}handlePhoneFieldInvalid(){return"phone_required"===this.state.errorField||"phone"===this.state.errorField}}rh.propTypes={campaign:ve.PropTypes.string.isRequired,titleIntro:ve.PropTypes.string.isRequired,textIntro:ve.PropTypes.string.isRequired,form:ve.PropTypes.shape({emailPlaceholder:ve.PropTypes.string.isRequired,emailConsentLabel:ve.PropTypes.string.isRequired,firstNamePlaceholder:ve.PropTypes.string.isRequired,lastNamePlaceholder:ve.PropTypes.string.isRequired,phonePlaceholder:ve.PropTypes.string.isRequired,leadSource:ve.PropTypes.string.isRequired,doYouSellOptions:ve.PropTypes.arrayOf(ve.PropTypes.shape({label:ve.PropTypes.string.isRequired,value:ve.PropTypes.string.isRequired})).isRequired,disclaimer:ve.PropTypes.string.isRequired,error:ve.PropTypes.shape({generic:ve.PropTypes.string.isRequired,likelySell:ve.PropTypes.string.isRequired}),success:ve.PropTypes.string.isRequired}),submitButtonLabel:ve.PropTypes.string.isRequired,disclaimer:ve.PropTypes.string.isRequired,popinSuccessText:ve.PropTypes.string.isRequired};var nh=rh,oh=s(209),lh=s(104),ch=()=>{var e=function(e,s){var i=e?p()(this):s,a=i.hasClass("".concat("jq-dropdown-children","-open"));if(e){if(p()(e.target).hasClass("".concat("jq-dropdown-children","-ignore")))return;e.preventDefault(),e.stopPropagation()}else if(i!==s.target&&p()(s.target).hasClass("".concat("jq-dropdown-children","-ignore")))return;t(),a||i.hasClass("".concat("jq-dropdown-children","-disabled"))||(i.addClass("".concat("jq-dropdown-children","-open")),p()(document).find(".".concat("jq-dropdown-children","-open")).each((function(){var e=p()(this).next(".jq-dropdown-children");e.data("".concat("jq-dropdown-children","-trigger"),i).show(),e.find(".select-dropdown__input").focus(),e.trigger("show",{jqDropdownChildren:e,trigger:i})})))},t=function(e){var t=e?p()(e.target).parents().addBack():null;if(t&&t.is(".".concat("jq-dropdown-children"))){if(!t.is(".".concat("jq-dropdown-children","-menu")))return;if(!t.is("A"))return}p()(document).find(".".concat("jq-dropdown-children",":visible")).each((function(){var e=p()(this);e.hide().removeData("".concat("jq-dropdown-children","-trigger")).trigger("hide",{jqDropdownChildren:e})})),p()(document).find(".".concat("jq-dropdown-children","-open")).removeClass("".concat("jq-dropdown-children","-open")),p()(".mobile-header").is(":visible")||(p()(document).find(".".concat("jq-dropdown",":visible")).not("#characteristics-dropdown").each((function(){var e=p()(this);e.hide().removeData("".concat("jq-dropdown","-trigger")).trigger("hide",{jqDropdownChildren:e})})),p()(document).find(".".concat("jq-dropdown","-open:not([data-jq-dropdown='#characteristics-dropdown'])")).removeClass("".concat("jq-dropdown","-open")))};return p.a.fn.jqDropdownChildren=function(s,i){switch(s){case"show":return e(null,p()(this)),p()(this);case"hide":return t(),p()(this);case"attach":return p()(this).attr("data-".concat("jq-dropdown-children"),i);case"detach":return t(),p()(this).removeAttr("data-".concat("jq-dropdown-children"));case"disable":return p()(this).addClass("".concat("jq-dropdown-children","-disabled"));case"enable":return t(),p()(this).removeClass("".concat("jq-dropdown-children","-disabled"))}},p()(document).on("click.jq-dropdown-children","[data-".concat("jq-dropdown-children","]"),e),p()(document).on("click.jq-dropdown-children",t),p.a.fn.jqDropdownChildren};class ph{constructor(e){this.$element=p()(e),this.componentDidMount()}componentDidMount(){}}var dh=[".carousel-modal","slick-slider",".slick-list",".slick-track",".slick-slide"],hh={arrows:!0,focusOnSelect:!0,nextArrow:".carousel-modal__navigation--right",prevArrow:".carousel-modal__navigation--left",speed:200};var uh=class extends ph{componentDidMount(){this.$carousel=this.$element.find(".carousel-modal__carousel"),this.$triggers=p()(".carousel-modal-trigger[data-carousel-id=".concat(this.$element.data("carousel-id"),"]")),this.$currentSlideIndex=this.$element.find(".carousel-modal__counter-current"),this.$totalSlides=this.$element.find(".carousel-modal__counter-total"),this.$closeButton=this.$element.find(".carousel-modal__close-icon"),this.$carousel.slick(hh),this.$element.on("click.CarouselModal",this.handleModalClick.bind(this)),this.$triggers.on("click.CarouselModal",this.handleTriggerClick.bind(this)),this.$carousel.on("afterChange.CarouselModal",this.handleSlideChange.bind(this)),this.$closeButton.on("click.CarouselModal",this.handleCloseButtonClick.bind(this))}handleTriggerClick(e){this.$carousel.slick("slickGoTo",p()(e.currentTarget).data("carousel-slide-id")),this.showModal()}handleModalClick(e){!0===p()(e.target).is(dh.join())&&this.hideModal()}handleSlideChange(){var e=this.$element.find(".slick-active"),t=this.$element.find(".slick-slide:not(.slick-cloned)"),s=e.find(".slick-slide-content").data("category"),i=e.find(".slick-slide-content").data("action");this.$currentSlideIndex.html(e.index()),this.$totalSlides.html(t.length),_e.a.pushToDataLayer("gtm-event",s,i,"undefined")}handleCloseButtonClick(){this.hideModal()}showModal(){setTimeout(()=>this.$element.addClass("carousel-modal--visible"),0)}hideModal(){this.$element.removeClass("carousel-modal--visible")}},mh="page-packages-from--hidden",gh=0;var _h=class extends ph{componentDidMount(){window.$window.on("scroll.CallMeFormAnchor",this.updateNav.bind(this)),window.$window.on("resize.CallMeFormAnchor",this.updateNav.bind(this)),this.$element.removeClass("page-packages-from--loading"),this.isViewed=!1,this.updateNav()}updateNav(){if(!this.shouldDisplayStickyVersion())return null;gh<this.$element.offset().top&&(gh=this.$element.offset().top),this.$element.hasClass("page-packages-from--always-anchored")?(this.anchorForm(),this.$element.removeClass(mh)):(this.toggleBarVisibility(),this.toggleBarAnchor())}toggleBarVisibility(){window.$window.scrollTop()<150?(this.$element.addClass(mh),this.$element.removeClass("page-packages-from--visible")):(this.isViewed||(_e.a.pushDynamicEvent("pricing-call-me-back-seller-banner",window.DP.context.pageType),this.isViewed=!0),this.$element.removeClass(mh),this.$element.addClass("page-packages-from--visible"))}toggleBarAnchor(){this.shouldAnchor()?this.anchorForm():this.$element.removeClass("page-packages-from--anchored")}anchorForm(){this.$element.addClass("page-packages-from--anchored")}shouldAnchor(){return window.$window.outerHeight()+120>this.getAnchorThresholdBasedOnWindowWidth()?(this.$element.removeClass(mh),this.$element.addClass("page-packages-from--visible"),!0):window.$window.scrollTop()+window.$window.outerHeight()>this.getAnchorThresholdBasedOnWindowWidth()}shouldDisplayStickyVersion(){return window.$window.outerWidth()>768}getAnchorThresholdBasedOnWindowWidth(){var e=28,t=window.$window.outerWidth();return t<936||t<1021?e=20:t<1025&&(e=40),gh-e}};var bh=class extends ph{componentDidMount(){this.$element.on("click.ContactFormTrigger",this.handleClick.bind(this))}handleClick(){window.DP.store.dispatch({type:"SHOW_CONTACT_FORM"}),window.DP.store.dispatch({type:"ADD_GTM_CATEGORY_CONTACT_FORM",gtmCategory:this.$element.data("form-gtm-category")}),window.DP.store.dispatch({type:"ADD_GTM_ACTION_CONTACT_FORM",gtmAction:this.$element.data("form-gtm-action")}),window.DP.store.dispatch({type:"ADD_GTM_SUBMIT_CALL_NAME",gtmSubmitCallName:this.$element.data("form-gtm-submit-call-name")})}};var vh=class extends ph{componentDidMount(){this.$element.on("click.SellerContactFormTrigger",this.handleClick.bind(this)),this.$element.data("open-on-load")&&this.handleClick()}handleClick(){window.DP.auth.check?window.DP.store.dispatch({type:"SHOW_SELLER_CONTACT_FORM"}):$n("do=contact-owner-list&code=".concat(this.$element.data("listing-code"),"&url-back=").concat(encodeURIComponent(window.location.href)))}};var yh=class extends ph{componentDidMount(){this.$element.on("click.ListingTroubleReachingFormTrigger",this.handleClick.bind(this)),this.$element.data("open-on-load")&&this.handleClick()}handleClick(){window.DP.store.dispatch(Gn("trouble"))}};var Th=class extends ph{componentDidMount(){this.$element.on("click.ListingRentalWarningTrigger",this.handleClick.bind(this)),this.$element.data("open-on-load")&&this.handleClick()}handleClick(){window.DP.store.dispatch(Gn("warning"))}};var fh=class extends ph{componentDidMount(){this.$element.on("click.ListingContactFormTrigger",this.handleClick.bind(this)),this.$element.data("open-on-load")&&this.handleClick()}handleClick(){window.DP.store.dispatch({type:"SHOW_LISTING_CONTACT_FORM"})}};var Ph=class extends ph{componentDidMount(){this.$body=p()("body"),this.$mobileNav=p()(".mobile-header"),this.$loginPopover=p()(".my-account-popover"),this.$informationBar=p()(".".concat("information-bar")),window.$window.on("scroll.FixedHeader",this.updateNav.bind(this)),window.$window.on("resize.FixedHeader",this.updateNav.bind(this)),this.updateNav()}removeBodyInlinePaddingTop(){this.$body.css("padding-top","")}shouldShowFixedHeader(){var e=window.$window.scrollTop(),t=50;return this.$informationBar.length&&(t+=this.$informationBar.outerHeight()),e>t}toggleFixedHeader(){this.shouldShowFixedHeader()?this.showFixedHeader():this.hideFixedHeader()}showFixedHeader(){this.$body.css("padding-top","115px"),this.$loginPopover.addClass("my-account-popover--fixed-header"),this.$element.addClass("header--fixed")}hideFixedHeader(){this.removeBodyInlinePaddingTop(),this.$loginPopover.removeClass("my-account-popover--fixed-header"),this.$element.removeClass("header--fixed")}updateNav(){this.$element.is(":visible")?this.toggleFixedHeader():this.$mobileNav.is(":visible")&&this.removeBodyInlinePaddingTop()}};var Eh=class extends ph{componentDidMount(){this.$menu=this.$element.parents(".".concat("footer__column--menu")),this.$subMenu=this.$element.parents(".".concat("footer__menu-link")),this.$element.on("click.FooterMenuTitle",this.handleClick.bind(this))}handleClick(){this.$subMenu.length||this.$menu.toggleClass("footer__column--menu-active")}};var wh=class extends ph{componentDidMount(){this.$body=p()("body"),this.$networkTrigger=this.$element.find(".mobile-header__item--network .mobile-header__trigger"),this.$networkMenu=p()(".mobile-menu--network"),this.$mainLink=this.$element.find(".mobile-header__item--main"),this.$mainMenu=p()(".mobile-menu--main"),this.$contactLink=this.$element.find(".mobile-header__item--contact"),this.$contactMenu=p()(".mobile-menu--contact"),this.$searchLink=this.$element.find(".mobile-header__item--search"),this.$searchMenu=p()(".mobile-menu--search"),this.$provinceSelectorLink=p()(".province-selector-mobile-trigger"),this.$provinceSelector=p()(".province-selector"),this.$myAccountLoggedButton=p()(".mobile-my-account-logged-trigger"),this.$myAccountLogged=p()(".mobile-my-account-logged"),this.$links=this.$element.find(".".concat("mobile-header__item")),this.$menus=p()(".".concat("mobile-menu")),this.$anchorLink=p()(".".concat("js-collapse-menu")),this.$networkTrigger.on("click.MobileHeader",this.handleTriggerClick.bind(this,this.$networkTrigger,this.$networkMenu)),this.$mainLink.on("click.MobileHeader",this.handleLinkClick.bind(this,this.$mainLink,this.$mainMenu)),this.$anchorLink.on("click.MobileHeader",this.collapseMenus.bind(this)),this.$contactLink.on("click.MobileHeader",this.handleLinkClick.bind(this,this.$contactLink,this.$contactMenu)),this.$searchLink.on("click.MobileHeader",this.handleSearchLinkClick.bind(this,this.$searchLink,this.$searchMenu)),this.$provinceSelectorLink.on("click.MobileHeader",this.handleProvinceSelectorLinkClick.bind(this)),this.$myAccountLoggedButton.on("click.MobileHeader",this.handleMyAccountLoggedButtonClick.bind(this)),this.$body.hasClass("search-map")||this.handleScrollPage()}handleScrollPage(){var e=0;window.addEventListener("scroll",()=>{var t=window.scrollY>0?window.scrollY:0;!(p()(".".concat("mobile-menu")).hasClass("mobile-menu--active")||t<=e)||p()(window).scrollTop()+200>p()(document).height()-p()(window).height()?this.$body.removeClass("header-sticky").find(".".concat("mobile-header")).removeClass("mobile-header--sticky"):this.$body.addClass("header-sticky").find(".".concat("mobile-header")).addClass("mobile-header--sticky"),e=t})}handleSearchLinkClick(e,t){p()(".".concat("search-bar__options-button--additional-criteria")).click(),this.handleLinkClick(e,t)}handleLinkClick(e,t){var s=e.hasClass("mobile-header__item--active"),i=p()("#chat-widget-container");this.collapseMenus(),s?(i.show(),_e.a.pushDynamicEvent("header-close-menu-mobile",window.DP.context.pageType)):(t.addClass("mobile-menu--active"),e.addClass("mobile-header__item--active"),i.hide(),_e.a.pushDynamicEvent("header-open-menu-mobile",window.DP.context.pageType)),_e.a.pushToDataLayer("gtm-event","Header_Navigation",e.data("gtm-action"),"undefined")}handleTriggerClick(e,t){e=e.parents(".mobile-header__item"),this.handleLinkClick(e,t)}handleProvinceSelectorLinkClick(){this.$provinceSelector.toggleClass("province-selector--active"),this.$menus.toggleClass("mobile-menu--hidden-left"),this.$element.toggleClass("mobile-header--hidden-left")}handleMyAccountLoggedButtonClick(){this.$myAccountLogged.toggleClass("mobile-my-account-logged--active"),this.$menus.toggleClass("mobile-menu--hidden-left"),this.$element.toggleClass("mobile-header--hidden-left")}collapseMenus(){this.$menus.removeClass("mobile-menu--active"),this.$links.removeClass("mobile-header__item--active")}},Ch="listing-complete-list-characteristics__content--visible";var Sh=class extends ph{componentDidMount(){this.$element.find(".".concat("listing-complete-list-characteristics__title")).on("click",this.handleClick.bind(this))}handleClick(){var e=this.$element.find(".".concat("listing-complete-list-characteristics__title__icon")),t=this.$element.find(".".concat("listing-complete-list-characteristics__content"));t.is(".".concat(Ch))?(t.removeClass(Ch),e.removeClass("listing-complete-list-characteristics__title__icon--arrow-up")):(t.addClass(Ch),e.addClass("listing-complete-list-characteristics__title__icon--arrow-up"))}};var Rh=class extends ph{componentDidMount(){this.$element.on("click",this.handleClick.bind(this))}handleClick(){window.DP.store.dispatch(on(this.$element.data("tab-name"),!0))}},Nh="select-dropdown",kh="".concat(Nh,"__option"),Lh="".concat(kh,"--selected"),Oh="".concat(Nh,"__label"),qh="".concat(Oh,"__text"),xh="".concat(Nh,"__arrow"),Mh="".concat(Nh,"__options"),Dh=(e,t,s)=>'<div class="'.concat(Nh,'">\n        <span class="').concat(Oh,'" data-jq-dropdown="#').concat(e,'">\n            <span class="').concat(qh,'">').concat(t.label,'</span>\n            <div class="').concat(xh,'">').concat('<svg viewBox="0 0 27 15" xmlns="http://www.w3.org/2000/svg"><path d="M1.395 4.14c-.512-.47-.77-1.086-.77-1.702 0-.616.258-1.23.77-1.7 1.023-.94 2.687-.94 3.712 0L13.75 8.66 22.395.737c1.024-.94 2.687-.94 3.712 0 1.026.94 1.026 2.463 0 3.403l-10.5 9.625c-1.024.94-2.686.94-3.71 0L1.395 4.14z" fill-rule="evenodd"></path></svg>','</div>\n        </span>\n\n        <div id="').concat(e,'" class="').concat(Mh,' jq-dropdown">\n            ').concat(((e,t)=>t.map(t=>{var s=Ee.a.build(kh,{selected:e.value===t.value});return'<div class="'.concat(s,'" data-value="').concat(t.value,'">').concat(t.label,"</div>")}).join(""))(t,s),"\n        </div>\n    </div>");var Ah=class extends ph{componentDidMount(){this.options=this.fetchOptions(),this.selectedOption=this.options.find(e=>e.selected)||this.options[0],this.uniqueId=this.$element.data("select-id"),this.$newElement=p()(Dh(this.uniqueId,this.selectedOption,this.options)),this.$element.after(this.$newElement),this.$element.hide(),this.$newElementLabel=this.$newElement.find(".".concat(qh)),this.$newElementOptions=this.$newElement.find(".".concat(kh)),this.$newElementOptions.on("click",this.handleOptionClick.bind(this)),this.$element.on("update",this.handleUpdate.bind(this))}handleUpdate(e,t){var s=this.$newElementOptions.toArray().filter(e=>e.dataset.value===t);this.updateWithOption(p()(s))}handleOptionClick(e){var t=p()(e.target);this.updateWithOption(t),window.Dropdown("hide")}fetchOptions(){return Array.from(this.$element.find("option")).map(e=>({value:e.value,label:e.innerHTML.trim(),selected:e.selected}))}updateWithOption(e){this.$newElementLabel.html(e.html()),this.$newElementOptions.removeClass(Lh),e.addClass(Lh),this.$element.val("".concat(e.data("value"))).change()}};var Ih=class extends ph{componentDidMount(){this.$informationBar=p()(".".concat("information-bar")),window.$window.on("scroll.FixedHeader",this.updateListingHeader.bind(this)),window.$window.on("resize.FixedHeader",this.updateListingHeader.bind(this)),this.updateListingHeader()}updateListingHeader(){var e=window.$window.scrollTop(),t=150;this.$informationBar.length&&(t+=this.$informationBar.outerHeight()),e>t?this.$element.addClass("listing-fixed-header--active"):(this.$element.removeClass("listing-fixed-header--active"),p()(".favourite-notes-panel__popover--sticky").length&&window.DP.store.dispatch({type:"HIDE_FAVOURITE_NOTES_PANEL_POPOVER"}))}};var Bh=class extends ph{componentDidMount(){this.$element.find(".".concat("listing-complete-list-open-house__title")).on("click",this.handleClick.bind(this))}handleClick(){var e=this.$element.find(".".concat("listing-complete-list-open-house__arrow")),t=this.$element.find(".".concat("listing-list-open-house__hours"));t.is(".".concat("listing-list-open-house__hours--visible"))?(t.removeClass("listing-list-open-house__hours--visible"),e.removeClass("listing-complete-list-open-house__arrow--arrow-up")):(t.addClass("listing-list-open-house__hours--visible"),e.addClass("listing-complete-list-open-house__arrow--arrow-up"))}},Fh="listing-owners-comments__actions-more-button--visible",jh="listing-owners-comments__actions-less-button--visible";var Vh=class extends ph{componentDidMount(){var e=this.$element.find(".".concat("js-listing-owners-comments-description__translate-actions-show-original")),t=this.$element.find(".".concat("js-listing-owners-comments-description__translate-actions-show-translation"));this.$moreButton=this.$element.find(".".concat("listing-owners-comments__actions-more-button")),this.$lessButton=this.$element.find(".".concat("listing-owners-comments__actions-less-button")),this.$showOriginalDescriptionDiv=this.$element.find(".".concat("js-listing-owners-comments-description-show-original")),this.$showTranslatedDescriptionDiv=this.$element.find(".".concat("js-listing-owners-comments-description-show-translation")),this.$description=this.$element.find(".".concat("listing-owners-comments__description")),this.setDescriptions(),this.$moreButton.on("click.ListingOwnersComments",this.handleMoreButtonClick.bind(this)),this.$lessButton.on("click.ListingOwnersComments",this.handleLessButtonClick.bind(this)),e.on("click",this.handleShowOriginalDescriptionButtonClick.bind(this)),t.on("click",this.handleShowTranslatedDescriptionButtonClick.bind(this)),this.isDescriptionExceedingMaxLength()?(this.$description.html(this.getTrimmedDescription()),this.$moreButton.addClass(Fh),this.$lessButton.removeClass(jh)):(this.$description.html(this.activeDescription),this.$moreButton.removeClass(Fh),this.$lessButton.removeClass(jh)),this.$description.attr("lang",this.activeLangugage)}handleMoreButtonClick(){this.$description.html(this.activeDescription),this.$moreButton.removeClass(Fh),this.$lessButton.addClass(jh)}handleLessButtonClick(){this.$description.html(this.getTrimmedDescription()),this.$moreButton.addClass(Fh),this.$lessButton.removeClass(jh)}handleShowOriginalDescriptionButtonClick(){this.setOriginalDescription(),this.isButtonMoreVisible()?this.$description.html(this.getTrimmedDescription()):this.$description.html(this.activeDescription),l.a.setBucket(""),l.a.set("show_origin_lang_translation",1),this.$description.attr("lang",this.activeLangugage)}handleShowTranslatedDescriptionButtonClick(){this.setTranslatedDescription(),this.isButtonMoreVisible()?this.$description.html(this.getTrimmedDescription()):this.$description.html(this.activeDescription),l.a.setBucket(""),l.a.set("show_origin_lang_translation",0),this.$description.attr("lang",this.activeLangugage)}descriptionIsVisible(e){return e&&!e.hasClass("is-hidden")}setDescriptions(){var e=this.$element.find(".".concat("js-listing-owners-comments-description-translation")),t=this.$element.find(".".concat("js-listing-owners-comments-description-original"));e&&t&&(this.fullTranslatedDescription=e.html(),this.fullOriginalDescription=t.html(),this.translatedLanguage=e.attr("lang"),this.originalLanguage=t.attr("lang")),l.a.setBucket(""),l.a.get("show_origin_lang_translation")||this.descriptionIsVisible(t)?this.setOriginalDescription():this.descriptionIsVisible(e)?this.setTranslatedDescription():this.activeDescription=this.$description.html()}setOriginalDescription(){this.activeDescription=this.fullOriginalDescription,this.activeLangugage=this.originalLanguage,this.$showOriginalDescriptionDiv.addClass("is-hidden"),this.$showTranslatedDescriptionDiv.removeClass("is-hidden")}setTranslatedDescription(){this.activeDescription=this.fullTranslatedDescription,this.activeLangugage=this.translatedLanguage,this.$showOriginalDescriptionDiv.removeClass("is-hidden"),this.$showTranslatedDescriptionDiv.addClass("is-hidden")}getTrimmedDescription(){var{html:e}=Xs(this.activeDescription,1e3);return e}isDescriptionExceedingMaxLength(){if(!this.activeDescription)return!1;var{more:e}=Xs(this.activeDescription,1e3);return e}isButtonMoreVisible(){return this.$moreButton.hasClass(Fh)}};var Uh=class extends ph{componentDidMount(){this.$element.find(".".concat("listing-contact-more__modal-trigger")).on("click",this.handleContactOpenClick.bind(this)),this.$element.find(".".concat("listing-contact-more__modal-close")).on("click",this.handleContactCloseClick.bind(this))}handleContactOpenClick(){this.$element.find(".".concat("listing-contact-more__modal-content")).addClass("listing-contact-more__modal-content--visible")}handleContactCloseClick(){this.$element.find(".".concat("listing-contact-more__modal-content")).removeClass("listing-contact-more__modal-content--visible")}},Hh=window.DP.breakpoints.regular,$h=window.DP.context.pageType;var Gh=class extends ph{componentDidMount(){this.$viewport=p()("body, html"),this.$bar=this.$element.find(".know-more__bar"),this.$header=this.$element.find(".know-more__header"),this.$link=this.$element.find(".know-more__item-link"),this.$gtmClass=this.$element.attr("data-gtm-class"),this.$surveyItem=this.$element.find(".js-sticky-cta-link-survey"),this.$knowMoreBuy=this.$viewport.find(".know-more").not(".js-know-more-buy-survey"),this.$knowMoreBuySurvey=this.$viewport.find(".js-know-more-buy-survey"),Object(be.b)()&&this.$link.map((e,t)=>this.displayMobileUrl(t)),Object(be.b)()&&p()(".js-sticky-cta-link-packages").parent().addClass("know-more__item--hidden"),this.$header.on("click.KnowMoreAnchor",this.scrollToSection.bind(this)),window.$window.on("scroll.KnowMoreAnchor",this.updateNav.bind(this)),window.$window.on("resize.KnowMoreAnchor",this.updateNav.bind(this)),this.$surveyItem&&this.$element.hasClass("js-know-more-buy-survey")&&(this.$triggerSurveyOnce=!1,"fr"===window.DP.lang&&window.DP.configSwitch.HighwaySurveyBuyPage?(this.initBuyPageSurveyElements(),this.$surveyItem.on("click.KnowMoreAnchorSurvey",this.handleBuyPageSurveyClick.bind(this)),window.$window.on("scroll.KnowMoreAnchorSurvey",this.handleBuyPageSurveyScroll.bind(this))):this.$knowMoreBuySurvey.hide()),this.$alreadyDisplayed=!1,this.updateNav()}displayMobileUrl(e){e.dataset.mobileurl.length&&(e.attributes.href.nodeValue=e.dataset.mobileurl)}updateNav(){this.$element.hasClass("know-more--always-anchored")?(this.anchorKnowMore(),this.$element.removeClass("know-more--hidden")):(this.toggleBarVisibility(),this.toggleBarAnchor()),this.styleLiveChatBar()}styleLiveChatBar(){var e="110px";this.$liveChatBar=document.getElementById("chat-widget-container");var t=window.innerWidth;void 0!==this.$liveChatBar&&null!==this.$liveChatBar&&(this.$element.hasClass("know-more--hidden")||this.$element.hasClass("know-more--anchored")?this.$liveChatBar.style.setProperty("bottom",0,"important"):(t>1041?e="110px":t>1020&&t<1042?e="126px":t<1021&&(e="40px"),this.$liveChatBar.style.setProperty("bottom",e,"important")))}toggleBarVisibility(){var e=this.$element.attr("data-know-more-breakpoint")?this.$element.attr("data-know-more-breakpoint"):120;window.$window.scrollTop()<e?this.$element.addClass("know-more--hidden"):(this.$element.removeClass("know-more--hidden"),!this.$alreadyDisplayed&&this.$gtmClass&&(_e.a.pushToDataLayer("gtm-event",$h,"View_Highway",""),this.$alreadyDisplayed=!0))}toggleBarAnchor(){this.shouldAnchorKnowMore()?this.anchorKnowMore():(this.$element.removeClass("know-more--anchored"),this.$element.height(this.shouldDisplayContent()?this.$element.outerHeight():this.$header.outerHeight()))}anchorKnowMore(){this.$element.addClass("know-more--anchored"),this.$element.height(this.$bar.outerHeight())}shouldAnchorKnowMore(){var e=window.$window.scrollTop()+window.$window.outerHeight(),t=this.$element.offset().top;return e>(t+=this.shouldDisplayContent()?this.$element.outerHeight():this.$header.outerHeight())}shouldDisplayContent(){return window.$window.outerWidth()>Hh}scrollToSection(){this.$viewport.animate({scrollTop:this.$element.offset().top},500)}initBuyPageSurveyElements(){0!==this.$surveyItem.length&&(l.a.setBucket("highway_"),l.a.set("survey-click-count",l.a.get("survey-click-count")||0),l.a.set("survey-view-count",l.a.get("survey-view-count")||0),l.a.get("survey-click-count")>0||l.a.get("survey-view-count")>=2?(this.$knowMoreBuySurvey.hide(),this.$knowMoreBuy.show()):this.$knowMoreBuy.hide())}handleBuyPageSurveyClick(){l.a.set("survey-click-count",l.a.get("survey-click-count")+1)}handleBuyPageSurveyScroll(){this.$triggerSurveyOnce&&window.$window.off("scroll.KnowMoreAnchorSurvey");var e=this.$element.attr("data-know-more-breakpoint")?this.$element.attr("data-know-more-breakpoint"):120,t=l.a.get("survey-view-count");this.$element.hasClass("js-know-more-buy-survey")&&window.$window.scrollTop()>e&&!this.$triggerSurveyOnce&&t<2&&(this.$triggerSurveyOnce=!0,l.a.set("survey-view-count",t+1))}};var zh=class extends ph{componentDidMount(){this.$element.on("click",this.handleClick.bind(this))}handleClick(){_e.a.pushToDataLayer("gtm-event","Header_Navigation","Click_Login_MyAccount","undefined")}};var Wh=class extends ph{componentDidMount(){this.$element.on("click",this.handleClick.bind(this)),window.$document.on("click.MyAccountLoggedinButton",this.handleOutsideClick.bind(this)),window.$document.on("touchend.MyAccountLoggedinButton",this.handleOutsideClick.bind(this))}handleClick(){this.toggleLoggedin()}handleOutsideClick(e){p()(e.target).parents(".".concat("header__my-account")).length||this.hideLoggedinPopover()}toggleLoggedin(){p()(".".concat("my-account-popover")).toggleClass("my-account-popover--active"),p()(".".concat("header__my-account")).toggleClass("header__my-account--active")}hideLoggedinPopover(){p()(".".concat("my-account-popover")).removeClass("my-account-popover--active"),p()(".".concat("header__my-account")).removeClass("header__my-account--active")}};var Kh=class extends ph{componentDidMount(){this.CONTAINER_HASHTAG_LIST=[".js-savings-calculator",".js-auto-promo-viewer",".js-testimonial-viewer",".js-listing-main-characteristics:visible",".js-how_does_it_work",".js-will_my_listing_be_seen",".js-how_much_could_i_save",".js-will_i_sell",".js-buy_why",".js-buy_documents",".js-buy_how",".js-buy_tools",".js-home-la-capitale",".js-listing-la-capitale",".js-buy_cashback",".js-compare-agent",".js-compare-proprio-direct",".js-compare-protect",".js-pb-fixed-fee",".js-pb-sell-everything",".js-pb-sell-how"],this.CONTAINER_VIEW_LIST=[".js-mortgage-data__form__section-description:visible",".js-mortgage-data__form__section-costs:visible",".js-mortgage-data__form-description:visible",".js-mortgage-data__form-costs:visible",".js-mortgage-data__new-form-description:visible",".js-mortgage-data__new-form-costs:visible",".js-cogeco-listing-content-view:visible",".js-cogeco-epico-listing-content-view:visible",".js-bell-listing-content-view:visible",".js-bell-ftth-listing-content-view:visible",".js-bell-fttn-listing-content-view:visible",".js-price-history-description:visible",".js-sticky-banner-ddf-idx",".js-know-more"],window.$window.on("scroll",this.handleScroll.bind(this)),this.sentDataOnce=[]}handleScroll(){this.CONTAINER_HASHTAG_LIST.map(e=>this.addHashtagToUrl(e)),this.CONTAINER_VIEW_LIST.map(e=>this.addGtmPageView(e))}addHashtagToUrl(e){this.onScrollDisplayOnce(e)&&history.replaceState(null,null,p()(e).data("label"))}addGtmPageView(e){var t=p()(e).data("category"),s=p()(e).data("action"),i="undefined"!==p()(e).data("label")?p()(e).data("label"):"undefined";this.onScrollDisplayOnce(e)&&_e.a.pushToDataLayer("gtm-event",t,s,i)}onScrollDisplayOnce(e){if(!this.sentDataOnce.includes(e))return Ho.a.hasScrolledIntoView(p()(e))?(this.sentDataOnce.push(e),!0):void 0}};var Yh=class extends ph{componentDidMount(){this.videoGtmAction=this.$element.data("gtm-event-action"),this.videoGtmCategory=this.$element.data("gtm-event-category"),this.videoGtmAction&&this.$element.on("click",this.handleGtmDatalayerPush.bind(this))}handleDataCategory(){return this.videoGtmCategory?this.videoGtmCategory:"Seller_Navigation"}handleGtmDatalayerPush(){_e.a.pushToDataLayer("gtm-event",this.handleDataCategory(),this.videoGtmAction,"undefined")}};var Xh=class extends ph{componentDidMount(){this.$element.on("click.FooterMenuList",this.handleClick.bind(this))}handleClick(){this.$element.toggleClass("footer__menu-item--active")}},Zh=(e,t)=>{var s=(e=>Se()(window.DP.urls.proxyFeaturedBuilderStats,e))(e),i={type:t};return p.a.ajax({method:"POST",url:s,data:i,beforeSend:e=>{e.setRequestHeader("X-CSRF-TOKEN",p()('meta[name="csrf-token"]').attr("content"))}})};var Jh=class extends ph{componentDidMount(){this.$element.find(".".concat("featured-builder__photo")).on("click",this.handleListingClick.bind(this,"click_listing")),this.$element.find(".".concat("featured-builder__logo")).on("click",this.handleListingClick.bind(this,"click_external")),this.$element.find(".".concat("featured-builder__properties-link")).on("click",this.handleListingClick.bind(this,"click_properties")),this.$element.find(".".concat("featured-builder__footer-link")).on("click",this.handleListingClick.bind(this,"click_external"))}handleListingClick(e){Zh(this.$element.data("featured-builder-id"),e)}},Qh=null;var eu=class extends ph{componentDidMount(){this.$body=p()("body"),this.$menus=p()(".".concat("mobile-menu")),this.$links=this.$body.find(".".concat("mobile-header__item")),this.$itemsList=p()(".".concat("sub-menu-navigation")),this.$element.find(".sub-menu-navigation__header-link").on("click",this.handleHeaderClick.bind(this)),Oe()?(this.$element.on("click.SubMenuNavigationTrigger",this.handleClick.bind(this)),this.$element.find(".sub-menu-navigation__link").on("click",this.handLinksClick.bind(this))):(this.$element.on("click.SubMenuNavigationTrigger touchstart.SubMenuNavigationTrigger",this.handleClick.bind(this)),this.$element.on("mouseover.SubMenuNavigationTrigger",this.handleMouseOver.bind(this)),window.$document.on("mouseout.SubMenuNavigationTrigger",this.handleMouseOut.bind(this)),window.$document.on("touchstart.SubMenuNavigationTrigger",this.handleMouseOut.bind(this)))}handleClick(){this.showMenuSelectorOnClick()}handleHeaderClick(e){var t=p()(e.target).parents(".".concat("header-primary-nav__item")).index(),s=t!==Qh;"ontouchstart"in document.documentElement&&s&&(Qh=t,e.preventDefault())}handLinksClick(){this.$menus.removeClass("mobile-menu--active"),this.$links.removeClass("mobile-header__item--active"),this.$itemsList.removeClass("sub-menu-navigation--active")}handleMouseOver(){this.showMenuSelectorOnHover()}handleMouseOut(e){p()(e.target).parents(".".concat("sub-menu-navigation")).length||(this.hideMenuSelector(),Qh=null)}hideMenuSelector(){this.$element.removeClass("sub-menu-navigation--active")}showMenuSelectorOnClick(){this.hideAllSubMenus(),this.$element.find(".sub-menu-navigation__item--unavailable").length?this.$element.addClass("sub-menu-navigation--active"):this.$element.toggleClass("sub-menu-navigation--active")}showMenuSelectorOnHover(){this.hideAllSubMenus(),this.$element.addClass("sub-menu-navigation--active")}hideAllSubMenus(){Oe()||this.$itemsList.removeClass("sub-menu-navigation--active")}};var tu=class extends ph{componentDidMount(){this.$element.on("click",this.handleClick.bind(this))}handleClick(e){e.preventDefault();var t=p()(e.currentTarget),s=t.data("id"),i=t.data("type"),a=t.attr("href"),r="_blank"===t.prop("target");oa(s,i),r?window.open(a):window.location=a}},su=(e,t)=>{var s=(e=>Se()(window.DP.urls.proxyFeaturedListingsViews,e))(e),i={type:t};return p.a.ajax({method:"POST",url:s,data:i,beforeSend:e=>{e.setRequestHeader("X-CSRF-TOKEN",p()('meta[name="csrf-token"]').attr("content"))}})},iu=[];var au=class extends ph{componentDidMount(){this.$featuredListingsList=this.$element.find(".".concat("search-results-listings-list__item--featured-landlord")),this.$featuredListingsList.each((e,t)=>{if("none"!==window.getComputedStyle(t,null).display){t.addEventListener("click",this.handleClick.bind(this));var s=t.getAttribute("id");s=s.slice(8),iu.push(s)}}),su(iu,"search_result_list")}handleClick(e){var t=p()(e.currentTarget).data("featured-builder-id");Zh(t,"click_listing")}};var ru=class extends ph{componentDidMount(){this.$phoneButton=this.$element.find(".".concat("listing-contact__item-phone-button")),this.$phoneButtonLabel=this.$element.find(".".concat("listing-contact__label--phone-label")),this.$phoneContent=this.$element.find(".".concat("listing-contact__item-phone")),this.$phoneContainer=this.$element.find(".".concat("listing-contact__item-group")),this.$noSolicitationsContent=this.$element.find(".".concat("listing-contact__no-solicitations")),this.$phoneButton.on("click.ListingContactPhoneTrigger",this.handleClick.bind(this))}handleClick(){this.$phoneButton.addClass("".concat("listing-contact__item-phone-button--hidden")),this.$noSolicitationsContent.addClass("".concat("listing-contact__no-solicitations")),this.$phoneButtonLabel.hide(),this.$phoneContent.removeClass("".concat("listing-contact__item-phone--hidden")),this.$phoneContainer.removeClass("".concat("listing-contact__item-group--hidden")),this.$noSolicitationsContent.removeClass("".concat("listing-contact__no-solicitations--hidden")),this.$phoneButton.data("listing-preview")||oa(this.$phoneButton.data("listing-code"),"click_on_phone")}};var nu=class extends ph{componentDidMount(){new SmoothScroll('a[href*="#"]',{speed:500,offset:50})}};var ou=class extends ph{componentDidMount(){"ontouchstart"in document.documentElement||(document.documentElement.className+="no-touch")}},lu=window.DP.context.pageType;var cu=class extends ph{componentDidMount(){this.$blogFeatured=this.$element.find(".".concat("blog-featured")),this.$blogCard=this.$element.find(".".concat("blog-content__cards"," li")),this.$blogArticle=this.$element.find(".".concat("blog-article__text")),this.$blogArticle.find("a").css("color",this.$blogArticle.css("color")),this.$blogSearchFormInput=this.$element.find(".".concat("blog-search"," input[type=text]")),this.featuredTruncate(),this.cardTruncate(),this.$blogArticle.find("a[id]:not([href])").each((function(){var e=p()(this).clone().removeAttr("style");p()(".blog-province-dropdown").length||e.addClass("blog-article__archor-sticky-header"),p()(this).parent().before(e),p()(this).remove()})),this.$element.find(".".concat("blog-action__link")).length&&new SmoothScroll(".".concat("blog-action__link"),{speed:500,offset:50}),this.$element.find(".".concat("blog-category__link")).on("click",this.handleCategorySidebarGtmClick.bind(this)),this.$blogSearchFormInput.on("keyup",this.handleSearchFormState.bind(this))}handleCategorySidebarGtmClick(e){var t=this.labelGenerator(p()(e.currentTarget).data("category"));_e.a.pushToDataLayer("gtm-event",lu,"Click_Category",t)}labelGenerator(e){return e.split("-").map(e=>e.charAt(0).toUpperCase()+e.substring(1)).join("")}featuredTruncate(){for(var e=this.$blogFeatured.find(".".concat("blog-featured__description")),t=this.$blogFeatured.find(".".concat("blog-featured__body")).height()-this.$blogFeatured.find(".".concat("blog-featured__title")).height(),s=e.text().split(" ");e.prop("scrollHeight")>t&&s.length>0;)s.pop(),e.text("".concat(s.join(" ")," ..."))}cardTruncate(){this.$blogCard.each((function(){for(var e=p()(this).find(".".concat("blog-card__description")),t=p()(this).find(".".concat("blog-card__body")).height()-p()(this).find(".".concat("blog-card__title")).height(),s=e.text().split(" ");e.prop("scrollHeight")>t&&s.length>0;)s.pop(),e.text("".concat(s.join(" ")," ..."))}))}handleSearchFormState(){var e=p()(event.currentTarget),t=p()(event.currentTarget).parent().find("label"),s=t.find("input[type=submit]");e.val().length>=3?(s.prop("disabled",!1),t.removeClass("is-disabled")):(s.prop("disabled",!0),t.addClass("is-disabled"))}};var pu=class extends ph{componentDidMount(){this.createCarousel.bind(this)()}createCarousel(){p()("".concat(".sell-carousel-container")).slick({arrows:!1,centerMode:!0,centerPadding:"0px",dots:!0,focusOnSelect:!0,infinite:!0,slidesToShow:3,responsive:[{breakpoint:768,settings:{centerMode:!0,centerPadding:"0px",slidesToShow:3}},{breakpoint:640,settings:{centerMode:!0,centerPadding:"10px",slidesToShow:3}},{breakpoint:600,centerMode:!0,settings:{centerPadding:"60px",infinite:!1,slidesToShow:1}}]}),p()("".concat(".sell-carousel-container")).on("afterChange",(e,t,s)=>{_e.a.pushDynamicEvent("sell-carousel-circle-".concat(s),window.DP.context.pageType)})}};var du=class extends ph{componentDidMount(){this.createCarousel.bind(this)()}createCarousel(){p()("".concat(".sell-testimonials__carousel")).slick({centerMode:!1,centerPadding:"10px",dots:!1,focusOnSelect:!0,infinite:!0,slidesToShow:3,responsive:[{breakpoint:738,settings:{slidesToShow:2}},{breakpoint:420,settings:{arrows:!1,centerMode:!0,centerPadding:"50px",slidesToScroll:1,slidesToShow:1,infinite:!1}}],prevArrow:".sell-testimonials__carousel-button--prev",nextArrow:".sell-testimonials__carousel-button--next"})}};window.jQuery=p.a,window.$=p.a,function(e){var t=e,s="undefined"!=typeof window&&window,i={frameLoaded:0,frameTry:0,frameTime:0,frameDetect:null,frameSrc:null,frameCallBack:null,frameThis:null,frameNavigator:window.navigator.userAgent,frameDelay:0,frameDataSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC"};t.fn.backDetect=function(e,s){i.frameThis=this,i.frameCallBack=e,null!==s&&(i.frameDelay=s),i.frameNavigator.indexOf("MSIE ")>-1||i.frameNavigator.indexOf("Trident")>-1?setTimeout((function(){t('<iframe src="'+i.frameDataSrc+'?loading" style="display:none;" id="backDetectFrame" onload="jQuery.fn.frameInit();""></iframe>').appendTo(i.frameThis)}),i.frameDelay):setTimeout((function(){t("<iframe src='about:blank?loading' style='display:none;' id='backDetectFrame' onload='jQuery.fn.frameInit();'></iframe>").appendTo(i.frameThis)}),i.frameDelay)},t.fn.frameInit=function(){i.frameDetect=document.getElementById("backDetectFrame"),i.frameLoaded>1&&2===i.frameLoaded&&(i.frameCallBack.call(this),s.history.go(-1)),i.frameLoaded+=1,1===i.frameLoaded&&(i.frameTime=setTimeout((function(){e.fn.setupFrames()}),500))},t.fn.setupFrames=function(){clearTimeout(i.frameTime),i.frameSrc=i.frameDetect.src,1===i.frameLoaded&&-1===i.frameSrc.indexOf("historyLoaded")&&(i.frameNavigator.indexOf("MSIE ")>-1||i.frameNavigator.indexOf("Trident")>-1?i.frameDetect.src=i.frameDataSrc+"?historyLoaded":i.frameDetect.src="about:blank?historyLoaded")}}(jQuery);var hu=class extends ph{componentDidMount(){var e=this;this.$html=p()("html"),this.$exitButton=this.$element.find(".js-callme-exit-button"),this.$popupContent=this.$element.find(".callme-exit-popup"),this.$popupContent.hide(),this.$urlLink="",this.$backButtonPressed=!1,this.$exitButton.on("click",this.hidePopup.bind(this)),this.$html.backDetect((function(){wl.a.get("exit_popup_seen_once")||(e.$element.$backButtonPressed=!0,history.pushState("backbutton-pressed","",null),e.triggerPopup())})),p()("a").not(".js-callme-exit-button, .js-noPopup, .province-selector__language-switch").bind("click",(function(t){if(!wl.a.get("exit_popup_seen_once"))return t.preventDefault(),t.stopImmediatePropagation(),e.handleLinkClicks(t,this),!1})),p()(".js-exit-popup").bind("click",(function(t){!document.querySelector(".callme-exit-popup").contains(t.target)&&e.hidePopup()}))}handleLinkClicks(e,t){e.preventDefault(),this.$urlLink=p()(t).attr("href"),this.triggerPopup()}triggerPopup(){this.$element.addClass("modal"),this.$popupContent.show(),(null===wl.a.get("exit_popup_seen_once")||isNaN(wl.a.get("exit_popup_seen_once"))||void 0===wl.a.get("exit_popup_seen_once"))&&wl.a.set("exit_popup_seen_once",!0),_e.a.pushDynamicEvent("pricing-call-me-back-seller-popup",window.DP.context.pageType)}hidePopup(){this.$element.removeClass("modal"),this.$popupContent.hide(),this.$element.$backButtonPressed?history.back():window.location.href=this.$urlLink}},uu=window.DP.context.pageType;var mu=class extends ph{componentDidMount(){window.$window.on("scroll.EmailAlertsFormAnchor",this.updateNav.bind(this)),window.$window.on("resize.EmailAlertsFormAnchor",this.updateNav.bind(this)),this.$alreadyDisplayed=!1,this.updateNav()}updateNav(){this.$element.hasClass("alert-email-sticky--always-anchored")?(this.$element.addClass("alert-email-sticky--anchored"),this.$element.removeClass("alert-email-sticky--hidden")):this.$element.find(".email-alerts-form--modal").length<=0&&(this.toggleBarVisibility(),this.$element.toggleClass("alert-email-sticky--anchored",this.shouldAnchorBar()))}toggleBarVisibility(){window.$window.scrollTop()<520?this.$element.addClass("alert-email-sticky--hidden"):(this.$element.removeClass("alert-email-sticky--hidden"),this.$alreadyDisplayed||(_e.a.pushToDataLayer("gtm-event",uu,"View_Highway",""),this.$alreadyDisplayed=!0))}shouldAnchorBar(){return window.$window.scrollTop()+window.$window.outerHeight()>this.$element.offset().top}};var gu=class extends ph{componentDidMount(){this.$element.find(".".concat("search-results-listings-list__item__help")).on("click",this.handleClick.bind(this)),this.$element.find(".".concat("search-results-listings-list__item-description__characteristics__item")).on("click",this.handleClick.bind(this))}handleClick(e){e.preventDefault()}};s(561);d.a.init(window.DP.lang),l.a.setBucket("duproprio-"),Object(be.a)(),window.Dropdown=Object(lh.a)(),window.DropdownChildren=ch(),window.DP.store=ue(window.DP.preloadedState),window.ComponentManager=new class{constructor(){this.registeredElementComponents=[],this.registeredCollectionComponents=[],window.$window=p()(window),window.$document=p()(document)}initialize(){return this.instanciateElementComponents(),this.instanciateCollectionComponents(),this}registerElementComponent(e,t){return this.registeredElementComponents.push({componentClass:e,componentSelector:t}),this}registerCollectionComponent(e,t){return this.registeredCollectionComponents.push({componentClass:e,componentSelector:t}),this}instanciateElementComponents(){return this.registeredElementComponents.forEach(({componentClass:e,componentSelector:t})=>{p()(t).toArray().forEach(t=>new e(t))}),this}instanciateCollectionComponents(){return this.registeredCollectionComponents.forEach(({componentClass:e,componentSelector:t})=>{new e(p()(t))}),this}},window.ComponentManager.registerElementComponent(uh,".carousel-modal").registerElementComponent(_h,".page-packages-from").registerElementComponent(bh,".contact-form-trigger").registerElementComponent(Ph,".header").registerElementComponent(Eh,".footer__menu-title").registerElementComponent(Sh,".listing-complete-list-characteristics").registerElementComponent(Rh,".listing-tab-trigger-button").registerElementComponent(Bh,".listing-list-open-house").registerElementComponent(Vh,".listing-owners-comments").registerElementComponent(Ih,".listing-fixed-header").registerElementComponent(Uh,".listing-contact-more").registerElementComponent(wh,".mobile-header").registerElementComponent(Ah,".component-select-dropdown").registerElementComponent(vh,".seller-contact-form-trigger").registerElementComponent(yh,".listing-trouble-reaching-form-trigger").registerElementComponent(Th,".listing-rental-warning-trigger").registerElementComponent(Gh,".know-more").registerElementComponent(Xh,".footer__menu-item").registerCollectionComponent(ys.a,".mortgage-data__form").registerCollectionComponent(zh,"a.header__my-account-button").registerCollectionComponent(Wh,".header__my-account-button--loggedin").registerCollectionComponent(Kh,"body").registerElementComponent(Yh,".wistia_embed").registerElementComponent(Jh,".featured-builder").registerElementComponent(fh,".listing-contact-form-trigger").registerElementComponent(eu,".sub-menu-navigation-trigger").registerElementComponent(tu,".dp-stats-tracking").registerElementComponent(ru,".listing-contact-phone-trigger").registerElementComponent(au,".search-results-listings-list--featured").registerElementComponent(nu,".js-anchor").registerElementComponent(ou,"html").registerElementComponent(cu,".blog").registerElementComponent(pu,".sell-services").registerElementComponent(du,".sell-testimonials").registerElementComponent(hu,".js-exit-popup").registerElementComponent(mu,".alert-email-sticky").registerElementComponent(gu,".search-results-listings-list__item-bottom-container").initialize(),window.React=a.a,window.ReactDOM=n.a,window.ReactComponents={Message:fe,SearchBar:Oi,SearchPagination:Ai,TestimonialsPagination:Vi,PhotoViewer:ga,MobileSearch:va,AutoPromoViewer:Na,TestimonialViewer:Oa,SortOrderDropdown:Ma,TestimonialsRegionDropdown:Aa,FeaturedProperties:Va,SimilarProperties:Ga,SavingsCalculator:Za,ListingMap:Jr,SearchMap:an,ListingStreetViewButton:nn,ListingTabs:pn,ContactForm:bn,ContactUsForm:fn,PureModal:On,CallMeSell:Hn,CallMeForm:Pn.a,SellerContactForm:Kn,ListingContact:wo,ListingContactForm:Jn,MortgageCalculator:il,CallbackForm:ll,ListingTroubleReachingForm:hl,SearchMapListingCount:vl,EmailAlertsForm:Ol,FavouriteToggleButton:Mr,FavouriteNotesPanel:Ml,FavouriteNotesModal:Il,SearchResultsParams:Tl,SearchResultsParamsCount:jl,ListingDistanceTag:Ul,BuilderListingsPagination:Gl,FeaturedCompany:sc,InfoSessionsTicker:nc,InfoSessionsWidgetImg:cc,InfoSessionsCaroussel:hc,ReferralForm:gc,LiveChat:bc,Packages:Bc,LandingPage3DShowcaseViewer:jc,LandingPageWistiaVirtualTour:Uc,SurveyPopup:$c,ContactUsTabs:Wc,BlogCategoryDropdown:Xc,PricingCarrousel:$d,PricingDisclaimer:Wd,PricingFooter:th,WarningMessageBar:ah,ComparisonForm:nh,Login:oh.a},window.addEventListener("message",ge,!1),_e.a.registerElements()}},[[481,0,1]]]);
//# sourceMappingURL=app.3f09c4.js.map